module lake_model_input_test_mod

use fruit
use lake_model_mod
use lake_model_input

implicit none

contains

subroutine testLakeInputTests1
   real(dp),dimension(:,:), pointer :: cell_areas_on_surface_model_grid
   integer,dimension(:,:), pointer :: expected_corresponding_surface_cell_lat_index
   integer,dimension(:,:), pointer :: expected_corresponding_surface_cell_lon_index
   integer,dimension(:,:), pointer :: expected_number_fine_grid_cells
   integer,dimension(:,:), pointer :: expected_surface_cell_to_fine_cell_map_numbers
   real(dp), dimension(:), pointer :: expected_lake_parameters_as_array
   logical, dimension(:,:), pointer :: expected_binary_lake_mask
   logical, dimension(:,:), pointer :: expected_lake_centers
   type(lakemodelparameters), pointer :: lake_model_parameters
   real(dp), dimension(:), pointer :: lake_parameters_as_array
   integer :: i
   integer :: nlat_lake,nlon_lake
   integer :: nlat_hd,nlon_hd
   integer :: nlat_surface,nlon_surface
   character(len = 500) :: lake_para_filepath
      !Without binary mask
      lake_para_filepath = "lake_model_para.nc"
      call set_lake_parameters_filename(lake_para_filepath)
      nlat_lake = 20
      nlon_lake = 20
      nlat_hd = 4
      nlon_hd = 4
      nlat_surface = 3
      nlon_surface = 3
      allocate(cell_areas_on_surface_model_grid(nlat_surface,nlon_surface))
      cell_areas_on_surface_model_grid = transpose(reshape((/  2.5, 3.0, 2.5,  &
         3.0, 4.0, 3.0, &
         2.5, 3.0, 2.5 /), &
         (/nlon_surface,nlat_surface/)))
      allocate(expected_lake_parameters_as_array(2275))
      expected_lake_parameters_as_array = &
        (/ 12.0, 236.0, 1.0, 8.0, 0.0, 15.0, 2.0, 45.0, 15.0, 2.0, 1.0, 0.0, 6.0, 16.0, 3.0, 1.0, &
           0.0, 6.0, 15.0, 3.0, 1.0, 0.0, 6.0, 16.0, 4.0, 1.0, 0.0, 6.0, 16.0, 2.0, 1.0, 0.0, 6.0, &
           17.0, 4.0, 1.0, 0.0, 6.0, 15.0, 5.0, 1.0, 0.0, 6.0, 16.0, 5.0, 1.0, 0.0, 6.0, 18.0, 3.0, &
           1.0, 0.0, 6.0, 16.0, 6.0, 1.0, 0.0, 6.0, 17.0, 6.0, 1.0, 0.0, 6.0, 15.0, 6.0, 1.0, 0.0, &
           6.0, 18.0, 2.0, 1.0, 0.0, 6.0, 15.0, 7.0, 1.0, 0.0, 6.0, 18.0, 6.0, 1.0, 0.0, 6.0, 18.0, &
           7.0, 1.0, 0.0, 6.0, 15.0, 4.0, 1.0, 0.0, 6.0, 18.0, 8.0, 1.0, 0.0, 6.0, 17.0, 8.0, 1.0, &
           0.0, 6.0, 18.0, 9.0, 1.0, 0.0, 6.0, 17.0, 9.0, 1.0, 0.0, 6.0, 16.0, 9.0, 1.0, 0.0, 6.0, &
           18.0, 10.0, 1.0, 0.0, 6.0, 17.0, 10.0, 1.0, 0.0, 6.0, 16.0, 10.0, 1.0, 0.0, 6.0, 15.0, &
           9.0, 1.0, 0.0, 6.0, 18.0, 11.0, 1.0, 0.0, 6.0, 15.0, 10.0, 1.0, 0.0, 6.0, 17.0, 2.0, &
           1.0, 0.0, 6.0, 18.0, 4.0, 1.0, 0.0, 6.0, 18.0, 5.0, 1.0, 0.0, 6.0, 15.0, 8.0, 1.0, &
           0.0, 6.0, 17.0, 12.0, 1.0, 0.0, 6.0, 16.0, 8.0, 1.0, 0.0, 6.0, 18.0, 13.0, 1.0, 0.0, &
           6.0, 16.0, 12.0, 1.0, 0.0, 6.0, 16.0, 13.0, 1.0, 0.0, 6.0, 17.0, 3.0, 1.0, 0.0, 6.0, &
           17.0, 5.0, 1.0, 0.0, 6.0, 16.0, 7.0, 1.0, 0.0, 6.0, 17.0, 7.0, 1.0, 0.0, 6.0, 17.0, &
           11.0, 1.0, 0.0, 6.0, 18.0, 12.0, 1.0, 0.0, 6.0, 16.0, 11.0, 1.0, 0.0, 6.0, 17.0, &
           13.0, 1.0, 45.0, 7.0, 1.0, 4.0, 3.0, 1.0, 0.0, 116.0, 2.0, 9.0, 0.0, 8.0, 17.0, &
           21.0, 8.0, 17.0, 1.0, 0.0, 3.0, 9.0, 18.0, 1.0, 0.0, 3.0, 7.0, 18.0, 1.0, 0.0, 3.0, &
           10.0, 17.0, 1.0, 0.0, 3.0, 7.0, 17.0, 1.0, 0.0, 3.0, 8.0, 19.0, 1.0, 0.0, 3.0, 11.0, &
           18.0, 1.0, 0.0, 3.0, 7.0, 19.0, 1.0, 0.0, 3.0, 8.0, 18.0, 1.0, 0.0, 3.0, 10.0, 19.0, &
           1.0, 0.0, 3.0, 9.0, 17.0, 1.0, 0.0, 3.0, 12.0, 18.0, 1.0, 0.0, 3.0, 12.0, 17.0, 1.0, &
           0.0, 3.0, 13.0, 17.0, 1.0, 0.0, 3.0, 12.0, 19.0, 1.0, 0.0, 3.0, 11.0, 19.0, 1.0, 0.0, &
           3.0, 13.0, 19.0, 1.0, 0.0, 3.0, 13.0, 18.0, 1.0, 0.0, 3.0, 10.0, 18.0, 1.0, 0.0, 3.0, &
           9.0, 19.0, 1.0, 0.0, 3.0, 11.0, 17.0, 1.0, 63.0, 6.0, 1.0, 5.0, -1.0, -1.0, 1.0, 101.0, &
           3.0, 10.0, 0.0, 8.0, 12.0, 18.0, 8.0, 12.0, 1.0, 0.0, 4.0, 9.0, 13.0, 1.0, 0.0, 4.0, &
           8.0, 13.0, 1.0, 0.0, 4.0, 10.0, 12.0, 1.0, 0.0, 4.0, 9.0, 12.0, 1.0, 0.0, 4.0, 11.0, &
           13.0, 1.0, 0.0, 4.0, 11.0, 12.0, 1.0, 0.0, 4.0, 12.0, 14.0, 1.0, 0.0, 4.0, 11.0, 14.0, &
           1.0, 0.0, 4.0, 12.0, 12.0, 1.0, 0.0, 4.0, 13.0, 13.0, 1.0, 0.0, 4.0, 8.0, 14.0, 1.0, &
           0.0, 4.0, 10.0, 14.0, 1.0, 0.0, 4.0, 9.0, 14.0, 1.0, 0.0, 4.0, 13.0, 14.0, 1.0, 0.0, &
           4.0, 13.0, 12.0, 1.0, 0.0, 4.0, 10.0, 13.0, 1.0, 0.0, 4.0, 12.0, 13.0, 1.0, 18.0, 5.0, &
           1.0, 6.0, 2.0, 3.0, 0.0, 66.0, 4.0, 8.0, 0.0, 3.0, 2.0, 11.0, 3.0, 2.0, 1.0, 0.0, 1.0, &
           4.0, 2.0, 1.0, 0.0, 1.0, 5.0, 2.0, 1.0, 0.0, 1.0, 6.0, 2.0, 1.0, 0.0, 1.0, 7.0, 2.0, &
           1.0, 0.0, 1.0, 8.0, 2.0, 1.0, 0.0, 1.0, 9.0, 2.0, 1.0, 0.0, 1.0, 10.0, 2.0, 1.0, 0.0, &
           1.0, 11.0, 2.0, 1.0, 0.0, 1.0, 12.0, 2.0, 1.0, 0.0, 1.0, 13.0, 2.0, 1.0, 66.0, 7.0, &
           1.0, 1.0, -1.0, -1.0, 1.0, 71.0, 5.0, 9.0, 0.0, 2.0, 17.0, 12.0, 2.0, 17.0, 1.0, 0.0, &
           2.0, 3.0, 18.0, 1.0, 0.0, 2.0, 2.0, 18.0, 1.0, 0.0, 2.0, 4.0, 17.0, 1.0, 0.0, 2.0, &
           3.0, 17.0, 1.0, 0.0, 2.0, 5.0, 18.0, 1.0, 0.0, 2.0, 5.0, 17.0, 1.0, 0.0, 2.0, 5.0, &
           19.0, 1.0, 0.0, 2.0, 2.0, 19.0, 1.0, 0.0, 2.0, 4.0, 19.0, 1.0, 0.0, 2.0, 3.0, 19.0, &
           1.0, 0.0, 2.0, 4.0, 18.0, 1.0, 48.0, 6.0, 1.0, 2.0, -1.0, -1.0, 1.0, 141.0, 6.0, &
           10.0, 0.0, 2.0, 8.0, 26.0, 2.0, 8.0, 1.0, 0.0, 1.0, 3.0, 9.0, 1.0, 0.0, 1.0, 2.0, &
           9.0, 1.0, 0.0, 1.0, 4.0, 8.0, 1.0, 0.0, 1.0, 3.0, 8.0, 1.0, 0.0, 1.0, 4.0, 10.0, &
           1.0, 0.0, 1.0, 3.0, 10.0, 1.0, 0.0, 1.0, 4.0, 11.0, 1.0, 0.0, 1.0, 4.0, 9.0, 1.0, &
           0.0, 1.0, 3.0, 11.0, 1.0, 0.0, 1.0, 2.0, 11.0, 1.0, 0.0, 1.0, 4.0, 12.0, 1.0, 0.0, &
           1.0, 3.0, 12.0, 1.0, 0.0, 1.0, 2.0, 12.0, 1.0, 0.0, 1.0, 4.0, 13.0, 1.0, 0.0, 1.0, &
           3.0, 13.0, 1.0, 0.0, 1.0, 2.0, 13.0, 1.0, 0.0, 1.0, 5.0, 14.0, 1.0, 0.0, 1.0, 4.0, &
           14.0, 1.0, 0.0, 1.0, 6.0, 14.0, 1.0, 0.0, 1.0, 6.0, 13.0, 1.0, 0.0, 1.0, 3.0, 14.0, &
           1.0, 0.0, 1.0, 6.0, 12.0, 1.0, 0.0, 1.0, 2.0, 14.0, 1.0, 0.0, 1.0, 5.0, 12.0, 1.0, &
           0.0, 1.0, 5.0, 13.0, 1.0, 104.0, 5.0, 1.0, 3.0, -1.0, -1.0, 1.0, 56.0, 7.0, 11.0, &
           0.0, 2.0, 4.0, 9.0, 2.0, 4.0, 1.0, 0.0, 3.0, 3.0, 5.0, 1.0, 0.0, 3.0, 2.0, 5.0, 1.0, &
           0.0, 3.0, 4.0, 6.0, 1.0, 0.0, 3.0, 4.0, 5.0, 1.0, 0.0, 3.0, 3.0, 4.0, 1.0, 0.0, 3.0, &
           3.0, 6.0, 1.0, 0.0, 3.0, 4.0, 4.0, 1.0, 0.0, 3.0, 2.0, 6.0, 1.0, 27.0, 6.0, 1.0, &
           10.0, 1.0, 2.0, 0.0, 298.0, 8.0, -1.0, 2.0, 1.0, 4.0, 15.0, 2.0, 57.0, 15.0, 2.0, &
           1.0, 0.0, 7.0, 16.0, 3.0, 1.0, 0.0, 7.0, 15.0, 3.0, 1.0, 0.0, 7.0, 14.0, 2.0, 2.0, &
           0.0, 7.0, 16.0, 4.0, 1.0, 0.0, 7.0, 16.0, 2.0, 1.0, 0.0, 7.0, 17.0, 3.0, 1.0, 0.0, &
           7.0, 16.0, 5.0, 1.0, 0.0, 7.0, 15.0, 5.0, 1.0, 0.0, 7.0, 18.0, 3.0, 1.0, 0.0, 7.0, &
           18.0, 2.0, 1.0, 0.0, 7.0, 17.0, 6.0, 1.0, 0.0, 7.0, 15.0, 6.0, 1.0, 0.0, 7.0, 18.0, &
           4.0, 1.0, 0.0, 7.0, 18.0, 5.0, 1.0, 0.0, 7.0, 15.0, 4.0, 1.0, 0.0, 7.0, 17.0, 2.0, &
           1.0, 0.0, 7.0, 17.0, 5.0, 1.0, 0.0, 7.0, 15.0, 7.0, 1.0, 0.0, 7.0, 18.0, 6.0, 1.0, &
           0.0, 7.0, 13.0, 2.0, 1.0, 0.0, 7.0, 16.0, 7.0, 1.0, 0.0, 7.0, 12.0, 2.0, 1.0, 0.0, &
           7.0, 17.0, 8.0, 1.0, 0.0, 7.0, 11.0, 2.0, 1.0, 0.0, 7.0, 18.0, 9.0, 1.0, 0.0, 7.0, &
           17.0, 9.0, 1.0, 0.0, 7.0, 18.0, 8.0, 1.0, 0.0, 7.0, 10.0, 2.0, 1.0, 0.0, 7.0, 16.0, &
           9.0, 1.0, 0.0, 7.0, 15.0, 8.0, 1.0, 0.0, 7.0, 17.0, 7.0, 1.0, 0.0, 7.0, 16.0, 8.0, &
           1.0, 0.0, 7.0, 17.0, 4.0, 1.0, 0.0, 7.0, 18.0, 7.0, 1.0, 0.0, 7.0, 15.0, 9.0, 1.0, &
           0.0, 7.0, 16.0, 10.0, 1.0, 0.0, 7.0, 9.0, 2.0, 1.0, 0.0, 7.0, 15.0, 10.0, 1.0, 0.0, &
           7.0, 16.0, 6.0, 1.0, 0.0, 7.0, 17.0, 10.0, 1.0, 0.0, 7.0, 8.0, 2.0, 1.0, 0.0, 7.0, &
           17.0, 11.0, 1.0, 0.0, 7.0, 16.0, 11.0, 1.0, 0.0, 7.0, 18.0, 11.0, 1.0, 0.0, 7.0, &
           17.0, 12.0, 1.0, 0.0, 7.0, 16.0, 12.0, 1.0, 0.0, 7.0, 7.0, 2.0, 1.0, 0.0, 7.0, 18.0, &
           13.0, 1.0, 0.0, 7.0, 16.0, 13.0, 1.0, 0.0, 7.0, 17.0, 13.0, 1.0, 0.0, 7.0, 6.0, 2.0, &
           1.0, 0.0, 7.0, 18.0, 12.0, 1.0, 0.0, 7.0, 5.0, 2.0, 1.0, 0.0, 7.0, 18.0, 10.0, 1.0, &
           0.0, 7.0, 4.0, 2.0, 1.0, 0.0, 7.0, 3.0, 2.0, 1.0, 56.0, 8.0, 1.0, -1.0, 4.0, 4.0, &
           0.0, 183.0, 9.0, 12.0, 2.0, 2.0, 5.0, 8.0, 17.0, 34.0, 8.0, 17.0, 1.0, 0.0, 6.0, 9.0, &
           18.0, 1.0, 0.0, 6.0, 7.0, 18.0, 1.0, 0.0, 6.0, 10.0, 17.0, 1.0, 0.0, 6.0, 7.0, 17.0, &
           1.0, 0.0, 6.0, 8.0, 19.0, 1.0, 0.0, 6.0, 6.0, 18.0, 1.0, 0.0, 6.0, 11.0, 18.0, 1.0, &
           0.0, 6.0, 7.0, 19.0, 1.0, 0.0, 6.0, 5.0, 17.0, 1.0, 0.0, 6.0, 12.0, 18.0, 1.0, 0.0, &
           6.0, 12.0, 17.0, 1.0, 0.0, 6.0, 4.0, 18.0, 1.0, 0.0, 6.0, 13.0, 19.0, 1.0, 0.0, 6.0, &
           13.0, 17.0, 1.0, 0.0, 6.0, 13.0, 18.0, 1.0, 0.0, 6.0, 4.0, 19.0, 1.0, 0.0, 6.0, 4.0, &
           17.0, 1.0, 0.0, 6.0, 8.0, 18.0, 1.0, 0.0, 6.0, 10.0, 19.0, 1.0, 0.0, 6.0, 9.0, 17.0, &
           1.0, 0.0, 6.0, 11.0, 19.0, 1.0, 0.0, 6.0, 12.0, 19.0, 1.0, 0.0, 6.0, 5.0, 19.0, 1.0, &
           0.0, 6.0, 5.0, 18.0, 1.0, 0.0, 6.0, 10.0, 18.0, 1.0, 0.0, 6.0, 9.0, 19.0, 1.0, 0.0, &
           6.0, 11.0, 17.0, 1.0, 0.0, 6.0, 3.0, 17.0, 1.0, 0.0, 6.0, 3.0, 19.0, 1.0, 0.0, 6.0, &
           3.0, 18.0, 1.0, 0.0, 6.0, 2.0, 18.0, 1.0, 0.0, 6.0, 2.0, 17.0, 1.0, 0.0, 6.0, 2.0, &
           19.0, 1.0, 34.0, 7.0, 1.0, 11.0, 1.0, 3.0, 0.0, 238.0, 10.0, 11.0, 2.0, 3.0, 6.0, &
           8.0, 12.0, 45.0, 8.0, 12.0, 1.0, 0.0, 5.0, 9.0, 13.0, 1.0, 0.0, 5.0, 7.0, 13.0, &
           1.0, 0.0, 5.0, 10.0, 12.0, 1.0, 0.0, 5.0, 8.0, 13.0, 1.0, 0.0, 5.0, 8.0, 14.0, 1.0, &
           0.0, 5.0, 6.0, 13.0, 1.0, 0.0, 5.0, 11.0, 13.0, 1.0, 0.0, 5.0, 6.0, 12.0, 1.0, 0.0, &
           5.0, 6.0, 14.0, 1.0, 0.0, 5.0, 5.0, 12.0, 1.0, 0.0, 5.0, 12.0, 12.0, 1.0, 0.0, 5.0, &
           4.0, 13.0, 1.0, 0.0, 5.0, 4.0, 11.0, 1.0, 0.0, 5.0, 13.0, 13.0, 1.0, 0.0, 5.0, 13.0, &
           12.0, 1.0, 0.0, 5.0, 4.0, 14.0, 1.0, 0.0, 5.0, 3.0, 10.0, 1.0, 0.0, 5.0, 4.0, 12.0, &
           1.0, 0.0, 5.0, 10.0, 13.0, 1.0, 0.0, 5.0, 10.0, 14.0, 1.0, 0.0, 5.0, 9.0, 14.0, 1.0, &
           0.0, 5.0, 12.0, 13.0, 1.0, 0.0, 5.0, 2.0, 9.0, 1.0, 0.0, 5.0, 3.0, 9.0, 1.0, 0.0, &
           5.0, 11.0, 14.0, 1.0, 0.0, 5.0, 5.0, 13.0, 1.0, 0.0, 5.0, 12.0, 14.0, 1.0, 0.0, 5.0, &
           4.0, 8.0, 1.0, 0.0, 5.0, 3.0, 8.0, 1.0, 0.0, 5.0, 2.0, 8.0, 1.0, 0.0, 5.0, 4.0, 9.0, &
           1.0, 0.0, 5.0, 9.0, 12.0, 1.0, 0.0, 5.0, 5.0, 14.0, 1.0, 0.0, 5.0, 2.0, 11.0, 1.0, &
           0.0, 5.0, 4.0, 10.0, 1.0, 0.0, 5.0, 13.0, 14.0, 1.0, 0.0, 5.0, 2.0, 12.0, 1.0, 0.0, &
           5.0, 11.0, 12.0, 1.0, 0.0, 5.0, 3.0, 12.0, 1.0, 0.0, 5.0, 2.0, 13.0, 1.0, 0.0, 5.0, &
           3.0, 11.0, 1.0, 0.0, 5.0, 3.0, 14.0, 1.0, 0.0, 5.0, 2.0, 14.0, 1.0, 0.0, 5.0, 3.0, &
           13.0, 1.0, 45.0, 6.0, 1.0, 7.0, 1.0, 2.0, 0.0, 288.0, 11.0, 12.0, 2.0, 10.0, 7.0, &
           8.0, 12.0, 55.0, 8.0, 12.0, 1.0, 0.0, 6.0, 9.0, 13.0, 1.0, 0.0, 6.0, 7.0, 13.0, &
           1.0, 0.0, 6.0, 10.0, 12.0, 1.0, 0.0, 6.0, 8.0, 13.0, 1.0, 0.0, 6.0, 8.0, 14.0, &
           1.0, 0.0, 6.0, 6.0, 13.0, 1.0, 0.0, 6.0, 11.0, 13.0, 1.0, 0.0, 6.0, 6.0, 12.0, &
           1.0, 0.0, 6.0, 6.0, 14.0, 1.0, 0.0, 6.0, 5.0, 12.0, 1.0, 0.0, 6.0, 12.0, 12.0, &
           1.0, 0.0, 6.0, 4.0, 13.0, 1.0, 0.0, 6.0, 4.0, 11.0, 1.0, 0.0, 6.0, 13.0, 13.0, &
           1.0, 0.0, 6.0, 13.0, 12.0, 1.0, 0.0, 6.0, 4.0, 14.0, 1.0, 0.0, 6.0, 3.0, 10.0, &
           1.0, 0.0, 6.0, 4.0, 12.0, 1.0, 0.0, 6.0, 10.0, 13.0, 1.0, 0.0, 6.0, 10.0, 14.0, &
           1.0, 0.0, 6.0, 9.0, 14.0, 1.0, 0.0, 6.0, 12.0, 13.0, 1.0, 0.0, 6.0, 2.0, 9.0, 1.0, &
           0.0, 6.0, 3.0, 9.0, 1.0, 0.0, 6.0, 11.0, 14.0, 1.0, 0.0, 6.0, 5.0, 13.0, 1.0, 0.0, &
           6.0, 12.0, 14.0, 1.0, 0.0, 6.0, 4.0, 8.0, 1.0, 0.0, 6.0, 3.0, 8.0, 1.0, 0.0, 6.0, &
           2.0, 8.0, 1.0, 0.0, 6.0, 4.0, 9.0, 1.0, 0.0, 6.0, 3.0, 7.0, 1.0, 0.0, 6.0, 9.0, &
           12.0, 1.0, 0.0, 6.0, 2.0, 6.0, 1.0, 0.0, 6.0, 5.0, 14.0, 1.0, 0.0, 6.0, 3.0, 5.0, &
           1.0, 0.0, 6.0, 2.0, 5.0, 1.0, 0.0, 6.0, 4.0, 5.0, 1.0, 0.0, 6.0, 4.0, 4.0, 1.0, &
           0.0, 6.0, 2.0, 4.0, 1.0, 0.0, 6.0, 3.0, 4.0, 1.0, 0.0, 6.0, 4.0, 6.0, 1.0, 0.0, &
           6.0, 3.0, 6.0, 1.0, 0.0, 6.0, 2.0, 11.0, 1.0, 0.0, 6.0, 4.0, 10.0, 1.0, 0.0, &
           6.0, 2.0, 12.0, 1.0, 0.0, 6.0, 13.0, 14.0, 1.0, 0.0, 6.0, 2.0, 13.0, 1.0, 0.0, &
           6.0, 11.0, 12.0, 1.0, 0.0, 6.0, 2.0, 14.0, 1.0, 0.0, 6.0, 3.0, 12.0, 1.0, 0.0, &
           6.0, 3.0, 11.0, 1.0, 0.0, 6.0, 3.0, 14.0, 1.0, 0.0, 6.0, 3.0, 13.0, 1.0, 55.0, &
           7.0, 1.0, 9.0, 1.0, 4.0, 0.0, 468.0, 12.0, -1.0, 2.0, 9.0, 11.0, 8.0, 17.0, &
           91.0, 8.0, 17.0, 1.0, 0.0, 7.0, 9.0, 18.0, 1.0, 0.0, 7.0, 7.0, 18.0, 1.0, 0.0, &
           7.0, 10.0, 17.0, 1.0, 0.0, 7.0, 7.0, 17.0, 1.0, 0.0, 7.0, 8.0, 19.0, 1.0, 0.0, &
           7.0, 6.0, 18.0, 1.0, 0.0, 7.0, 11.0, 18.0, 1.0, 0.0, 7.0, 7.0, 19.0, 1.0, 0.0, &
           7.0, 5.0, 17.0, 1.0, 0.0, 7.0, 12.0, 18.0, 1.0, 0.0, 7.0, 12.0, 17.0, 1.0, 0.0, &
           7.0, 4.0, 18.0, 1.0, 0.0, 7.0, 13.0, 19.0, 1.0, 0.0, 7.0, 13.0, 17.0, 1.0, 0.0, &
           7.0, 13.0, 18.0, 1.0, 0.0, 7.0, 4.0, 19.0, 1.0, 0.0, 7.0, 4.0, 17.0, 1.0, 0.0, &
           7.0, 8.0, 18.0, 1.0, 0.0, 7.0, 10.0, 19.0, 1.0, 0.0, 7.0, 9.0, 17.0, 1.0, 0.0, &
           7.0, 11.0, 19.0, 1.0, 0.0, 7.0, 12.0, 19.0, 1.0, 0.0, 7.0, 5.0, 19.0, 1.0, 0.0, &
           7.0, 5.0, 18.0, 1.0, 0.0, 7.0, 3.0, 16.0, 1.0, 0.0, 7.0, 10.0, 18.0, 1.0, 0.0, &
           7.0, 9.0, 19.0, 1.0, 0.0, 7.0, 11.0, 17.0, 1.0, 0.0, 7.0, 3.0, 15.0, 1.0, 0.0, &
           7.0, 3.0, 17.0, 1.0, 0.0, 7.0, 2.0, 17.0, 1.0, 0.0, 7.0, 3.0, 19.0, 1.0, 0.0, &
           7.0, 4.0, 14.0, 1.0, 0.0, 7.0, 2.0, 14.0, 1.0, 0.0, 7.0, 2.0, 19.0, 1.0, 0.0, &
           7.0, 5.0, 14.0, 1.0, 0.0, 7.0, 4.0, 13.0, 1.0, 0.0, 7.0, 6.0, 14.0, 1.0, 0.0, &
           7.0, 6.0, 13.0, 1.0, 0.0, 7.0, 5.0, 12.0, 1.0, 0.0, 7.0, 4.0, 12.0, 1.0, 0.0, &
           7.0, 6.0, 12.0, 1.0, 0.0, 7.0, 4.0, 11.0, 1.0, 0.0, 7.0, 3.0, 11.0, 1.0, 0.0, &
           7.0, 3.0, 12.0, 1.0, 0.0, 7.0, 4.0, 10.0, 1.0, 0.0, 7.0, 3.0, 10.0, 1.0, 0.0, &
           7.0, 2.0, 12.0, 1.0, 0.0, 7.0, 2.0, 11.0, 1.0, 0.0, 7.0, 4.0, 9.0, 1.0, 0.0, &
           7.0, 3.0, 9.0, 1.0, 0.0, 7.0, 2.0, 9.0, 1.0, 0.0, 7.0, 7.0, 13.0, 1.0, 0.0, &
           7.0, 2.0, 8.0, 1.0, 0.0, 7.0, 3.0, 13.0, 1.0, 0.0, 7.0, 2.0, 13.0, 1.0, 0.0, &
           7.0, 5.0, 13.0, 1.0, 0.0, 7.0, 2.0, 18.0, 1.0, 0.0, 7.0, 3.0, 14.0, 1.0, 0.0, &
           7.0, 3.0, 18.0, 1.0, 0.0, 7.0, 8.0, 13.0, 1.0, 0.0, 7.0, 8.0, 12.0, 1.0, 0.0, &
           7.0, 3.0, 7.0, 1.0, 0.0, 7.0, 8.0, 14.0, 1.0, 0.0, 7.0, 4.0, 8.0, 1.0, 0.0, 7.0, &
           3.0, 8.0, 1.0, 0.0, 7.0, 9.0, 13.0, 1.0, 0.0, 7.0, 4.0, 6.0, 1.0, 0.0, 7.0, 3.0, &
           6.0, 1.0, 0.0, 7.0, 2.0, 6.0, 1.0, 0.0, 7.0, 10.0, 13.0, 1.0, 0.0, 7.0, 10.0, 12.0, &
           1.0, 0.0, 7.0, 3.0, 5.0, 1.0, 0.0, 7.0, 2.0, 5.0, 1.0, 0.0, 7.0, 4.0, 5.0, 1.0, 0.0, &
           7.0, 4.0, 4.0, 1.0, 0.0, 7.0, 3.0, 4.0, 1.0, 0.0, 7.0, 2.0, 4.0, 1.0, 0.0, 7.0, 11.0, &
           14.0, 1.0, 0.0, 7.0, 11.0, 13.0, 1.0, 0.0, 7.0, 11.0, 12.0, 1.0, 0.0, 7.0, 12.0, &
           14.0, 1.0, 0.0, 7.0, 12.0, 13.0, 1.0, 0.0, 7.0, 12.0, 12.0, 1.0, 0.0, 7.0, 13.0, &
           14.0, 1.0, 0.0, 7.0, 13.0, 13.0, 1.0, 0.0, 7.0, 13.0, 12.0, 1.0, 0.0, 7.0, 9.0, 12.0, &
           1.0, 0.0, 7.0, 10.0, 14.0, 1.0, 0.0, 7.0, 9.0, 14.0, 1.0, 91.0, 8.0, 1.0, -1.0, 4.0, &
           4.0, 0.0 /)
      allocate(expected_corresponding_surface_cell_lat_index(nlat_lake,nlon_lake))
      expected_corresponding_surface_cell_lat_index = transpose(reshape((/   &
            1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, &
         1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, &
         1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, &
         1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, &
         1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, &
         1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, &
         2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, &
         2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, &
         2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, &
         2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, &
         2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, &
         2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, &
         2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, &
         2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, &
         3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, &
         3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, &
         3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, &
         3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, &
         3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, &
         3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3 /), &
         (/nlon_lake,nlat_lake/)))
      allocate(expected_corresponding_surface_cell_lon_index(nlat_lake,nlon_lake))
      expected_corresponding_surface_cell_lon_index = transpose(reshape((/   &
          1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, &
         1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, &
         1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, &
         1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, &
         1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, &
         1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, &
         1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, &
         1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, &
         1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, &
         1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, &
         1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, &
         1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, &
         1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, &
         1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, &
         1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, &
         1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, &
         1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, &
         1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, &
         1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, &
         1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3 /), &
         (/nlon_lake,nlat_lake/)))
      allocate(expected_lake_centers(nlat_lake,nlon_lake))
      expected_lake_centers(:,:) = .false.
      allocate(expected_number_fine_grid_cells(nlat_surface,nlon_surface))
      expected_number_fine_grid_cells = transpose(reshape((/   &
          36, 48, 36, &
         48, 64, 48, &
         36, 48, 36  /), &
         (/nlon_surface,nlat_surface/)))
      allocate(expected_binary_lake_mask(nlat_surface,nlon_surface))
      expected_binary_lake_mask(:,:) = .false.
      allocate(expected_surface_cell_to_fine_cell_map_numbers(nlat_surface,nlon_surface))
      expected_surface_cell_to_fine_cell_map_numbers = transpose(reshape((/   &
          1, 2, 3, &
         4, 5, 6, &
         7, 8, 0  /), &
         (/nlon_surface,nlat_surface/)))
      call load_lake_parameters(cell_areas_on_surface_model_grid, &
                                .false., &
                                lake_model_parameters, &
                                lake_parameters_as_array, &
                                nlat_hd,nlon_hd, &
                                nlat_surface,nlon_surface)
      call assert_equals(lake_parameters_as_array,expected_lake_parameters_as_array, &
                         size(expected_lake_parameters_as_array))
      call assert_equals(lake_model_parameters%corresponding_surface_cell_lat_index, &
                         expected_corresponding_surface_cell_lat_index,nlat_lake,nlon_lake)
      call assert_equals(lake_model_parameters%corresponding_surface_cell_lon_index, &
                         expected_corresponding_surface_cell_lon_index,nlat_lake,nlon_lake)
      call assert_equals(lake_model_parameters%number_of_lakes,12)
      call assert_false(associated(lake_model_parameters%basins))
      call assert_false(associated(lake_model_parameters%basin_numbers))
      call assert_false(associated(lake_model_parameters%cells_with_lakes_lat))
      call assert_false(associated(lake_model_parameters%cells_with_lakes_lon))
      call assert_equals(lake_model_parameters%cell_areas_on_surface_model_grid, &
                         cell_areas_on_surface_model_grid,nlat_surface,nlon_surface)
      call assert_equals(lake_model_parameters%lake_centers, &
                         expected_lake_centers,nlat_lake,nlon_lake)
      call assert_equals(lake_model_parameters%number_fine_grid_cells, &
                         expected_number_fine_grid_cells,nlat_surface,nlon_surface)
      call assert_equals(lake_model_parameters%surface_cell_to_fine_cell_map_numbers, &
                         expected_surface_cell_to_fine_cell_map_numbers, &
                         nlat_surface,nlon_surface)
      call assert_equals(lake_model_parameters%binary_lake_mask, &
                         expected_binary_lake_mask,nlat_surface,nlon_surface)
      deallocate(lake_model_parameters%lake_centers)
      deallocate(lake_model_parameters%number_fine_grid_cells)
      do i = 1,size(lake_model_parameters%surface_cell_to_fine_cell_maps)
         call clean_coords_list(lake_model_parameters%surface_cell_to_fine_cell_maps(i))
      end do
      deallocate(lake_model_parameters%surface_cell_to_fine_cell_maps)
      deallocate(lake_model_parameters%surface_cell_to_fine_cell_map_numbers)
      deallocate(lake_model_parameters%corresponding_surface_cell_lat_index)
      deallocate(lake_model_parameters%corresponding_surface_cell_lon_index)
      deallocate(lake_model_parameters%binary_lake_mask)
      deallocate(cell_areas_on_surface_model_grid)
      deallocate(expected_corresponding_surface_cell_lat_index)
      deallocate(expected_corresponding_surface_cell_lon_index)
      deallocate(expected_number_fine_grid_cells)
      deallocate(expected_surface_cell_to_fine_cell_map_numbers)
      deallocate(expected_lake_parameters_as_array)
      deallocate(expected_binary_lake_mask)
      deallocate(expected_lake_centers)
      deallocate(lake_model_parameters)
      deallocate(lake_parameters_as_array)
end subroutine testLakeInputTests1

 subroutine testLakeInputTests2

   real(dp),dimension(:,:), pointer :: cell_areas_on_surface_model_grid
   integer,dimension(:,:), pointer :: expected_corresponding_surface_cell_lat_index
   integer,dimension(:,:), pointer :: expected_corresponding_surface_cell_lon_index
   integer,dimension(:,:), pointer :: expected_number_fine_grid_cells
   integer,dimension(:,:), pointer :: expected_surface_cell_to_fine_cell_map_numbers
   real(dp), dimension(:), pointer :: expected_lake_parameters_as_array
   logical, dimension(:,:), pointer :: expected_binary_lake_mask
   logical, dimension(:,:), pointer :: expected_lake_centers
   type(lakemodelparameters), pointer :: lake_model_parameters
   real(dp), dimension(:), pointer :: lake_parameters_as_array
   integer :: i
   integer :: nlat_lake,nlon_lake
   integer :: nlat_hd,nlon_hd
   integer :: nlat_surface,nlon_surface
   character(len = 500) :: lake_para_filepath
      !Without binary mask
      lake_para_filepath = &
         "lake_model_para_with_mask.nc"
      call set_lake_parameters_filename(lake_para_filepath)
      nlat_lake = 20
      nlon_lake = 20
      nlat_hd = 4
      nlon_hd = 4
      nlat_surface = 3
      nlon_surface = 3
      allocate(cell_areas_on_surface_model_grid(nlat_surface,nlon_surface))
      cell_areas_on_surface_model_grid = transpose(reshape((/  2.5, 3.0, 2.5,  &
         3.0, 4.0, 3.0, &
         2.5, 3.0, 2.5 /), &
         (/nlon_surface,nlat_surface/)))
      allocate(expected_lake_parameters_as_array(2275))
      expected_lake_parameters_as_array = &
        (/ 12.0, 236.0, 1.0, 8.0, 0.0, 15.0, 2.0, 45.0, 15.0, 2.0, 1.0, 0.0, 6.0, 16.0, 3.0, 1.0, &
           0.0, 6.0, 15.0, 3.0, 1.0, 0.0, 6.0, 16.0, 4.0, 1.0, 0.0, 6.0, 16.0, 2.0, 1.0, 0.0, 6.0, &
           17.0, 4.0, 1.0, 0.0, 6.0, 15.0, 5.0, 1.0, 0.0, 6.0, 16.0, 5.0, 1.0, 0.0, 6.0, 18.0, 3.0, &
           1.0, 0.0, 6.0, 16.0, 6.0, 1.0, 0.0, 6.0, 17.0, 6.0, 1.0, 0.0, 6.0, 15.0, 6.0, 1.0, 0.0, &
           6.0, 18.0, 2.0, 1.0, 0.0, 6.0, 15.0, 7.0, 1.0, 0.0, 6.0, 18.0, 6.0, 1.0, 0.0, 6.0, 18.0, &
           7.0, 1.0, 0.0, 6.0, 15.0, 4.0, 1.0, 0.0, 6.0, 18.0, 8.0, 1.0, 0.0, 6.0, 17.0, 8.0, 1.0, &
           0.0, 6.0, 18.0, 9.0, 1.0, 0.0, 6.0, 17.0, 9.0, 1.0, 0.0, 6.0, 16.0, 9.0, 1.0, 0.0, 6.0, &
           18.0, 10.0, 1.0, 0.0, 6.0, 17.0, 10.0, 1.0, 0.0, 6.0, 16.0, 10.0, 1.0, 0.0, 6.0, 15.0, &
           9.0, 1.0, 0.0, 6.0, 18.0, 11.0, 1.0, 0.0, 6.0, 15.0, 10.0, 1.0, 0.0, 6.0, 17.0, 2.0, &
           1.0, 0.0, 6.0, 18.0, 4.0, 1.0, 0.0, 6.0, 18.0, 5.0, 1.0, 0.0, 6.0, 15.0, 8.0, 1.0, &
           0.0, 6.0, 17.0, 12.0, 1.0, 0.0, 6.0, 16.0, 8.0, 1.0, 0.0, 6.0, 18.0, 13.0, 1.0, 0.0, &
           6.0, 16.0, 12.0, 1.0, 0.0, 6.0, 16.0, 13.0, 1.0, 0.0, 6.0, 17.0, 3.0, 1.0, 0.0, 6.0, &
           17.0, 5.0, 1.0, 0.0, 6.0, 16.0, 7.0, 1.0, 0.0, 6.0, 17.0, 7.0, 1.0, 0.0, 6.0, 17.0, &
           11.0, 1.0, 0.0, 6.0, 18.0, 12.0, 1.0, 0.0, 6.0, 16.0, 11.0, 1.0, 0.0, 6.0, 17.0, &
           13.0, 1.0, 45.0, 7.0, 1.0, 4.0, 3.0, 1.0, 0.0, 116.0, 2.0, 9.0, 0.0, 8.0, 17.0, &
           21.0, 8.0, 17.0, 1.0, 0.0, 3.0, 9.0, 18.0, 1.0, 0.0, 3.0, 7.0, 18.0, 1.0, 0.0, 3.0, &
           10.0, 17.0, 1.0, 0.0, 3.0, 7.0, 17.0, 1.0, 0.0, 3.0, 8.0, 19.0, 1.0, 0.0, 3.0, 11.0, &
           18.0, 1.0, 0.0, 3.0, 7.0, 19.0, 1.0, 0.0, 3.0, 8.0, 18.0, 1.0, 0.0, 3.0, 10.0, 19.0, &
           1.0, 0.0, 3.0, 9.0, 17.0, 1.0, 0.0, 3.0, 12.0, 18.0, 1.0, 0.0, 3.0, 12.0, 17.0, 1.0, &
           0.0, 3.0, 13.0, 17.0, 1.0, 0.0, 3.0, 12.0, 19.0, 1.0, 0.0, 3.0, 11.0, 19.0, 1.0, 0.0, &
           3.0, 13.0, 19.0, 1.0, 0.0, 3.0, 13.0, 18.0, 1.0, 0.0, 3.0, 10.0, 18.0, 1.0, 0.0, 3.0, &
           9.0, 19.0, 1.0, 0.0, 3.0, 11.0, 17.0, 1.0, 63.0, 6.0, 1.0, 5.0, -1.0, -1.0, 1.0, 101.0, &
           3.0, 10.0, 0.0, 8.0, 12.0, 18.0, 8.0, 12.0, 1.0, 0.0, 4.0, 9.0, 13.0, 1.0, 0.0, 4.0, &
           8.0, 13.0, 1.0, 0.0, 4.0, 10.0, 12.0, 1.0, 0.0, 4.0, 9.0, 12.0, 1.0, 0.0, 4.0, 11.0, &
           13.0, 1.0, 0.0, 4.0, 11.0, 12.0, 1.0, 0.0, 4.0, 12.0, 14.0, 1.0, 0.0, 4.0, 11.0, 14.0, &
           1.0, 0.0, 4.0, 12.0, 12.0, 1.0, 0.0, 4.0, 13.0, 13.0, 1.0, 0.0, 4.0, 8.0, 14.0, 1.0, &
           0.0, 4.0, 10.0, 14.0, 1.0, 0.0, 4.0, 9.0, 14.0, 1.0, 0.0, 4.0, 13.0, 14.0, 1.0, 0.0, &
           4.0, 13.0, 12.0, 1.0, 0.0, 4.0, 10.0, 13.0, 1.0, 0.0, 4.0, 12.0, 13.0, 1.0, 18.0, 5.0, &
           1.0, 6.0, 2.0, 3.0, 0.0, 66.0, 4.0, 8.0, 0.0, 3.0, 2.0, 11.0, 3.0, 2.0, 1.0, 0.0, 1.0, &
           4.0, 2.0, 1.0, 0.0, 1.0, 5.0, 2.0, 1.0, 0.0, 1.0, 6.0, 2.0, 1.0, 0.0, 1.0, 7.0, 2.0, &
           1.0, 0.0, 1.0, 8.0, 2.0, 1.0, 0.0, 1.0, 9.0, 2.0, 1.0, 0.0, 1.0, 10.0, 2.0, 1.0, 0.0, &
           1.0, 11.0, 2.0, 1.0, 0.0, 1.0, 12.0, 2.0, 1.0, 0.0, 1.0, 13.0, 2.0, 1.0, 66.0, 7.0, &
           1.0, 1.0, -1.0, -1.0, 1.0, 71.0, 5.0, 9.0, 0.0, 2.0, 17.0, 12.0, 2.0, 17.0, 1.0, 0.0, &
           2.0, 3.0, 18.0, 1.0, 0.0, 2.0, 2.0, 18.0, 1.0, 0.0, 2.0, 4.0, 17.0, 1.0, 0.0, 2.0, &
           3.0, 17.0, 1.0, 0.0, 2.0, 5.0, 18.0, 1.0, 0.0, 2.0, 5.0, 17.0, 1.0, 0.0, 2.0, 5.0, &
           19.0, 1.0, 0.0, 2.0, 2.0, 19.0, 1.0, 0.0, 2.0, 4.0, 19.0, 1.0, 0.0, 2.0, 3.0, 19.0, &
           1.0, 0.0, 2.0, 4.0, 18.0, 1.0, 48.0, 6.0, 1.0, 2.0, -1.0, -1.0, 1.0, 141.0, 6.0, &
           10.0, 0.0, 2.0, 8.0, 26.0, 2.0, 8.0, 1.0, 0.0, 1.0, 3.0, 9.0, 1.0, 0.0, 1.0, 2.0, &
           9.0, 1.0, 0.0, 1.0, 4.0, 8.0, 1.0, 0.0, 1.0, 3.0, 8.0, 1.0, 0.0, 1.0, 4.0, 10.0, &
           1.0, 0.0, 1.0, 3.0, 10.0, 1.0, 0.0, 1.0, 4.0, 11.0, 1.0, 0.0, 1.0, 4.0, 9.0, 1.0, &
           0.0, 1.0, 3.0, 11.0, 1.0, 0.0, 1.0, 2.0, 11.0, 1.0, 0.0, 1.0, 4.0, 12.0, 1.0, 0.0, &
           1.0, 3.0, 12.0, 1.0, 0.0, 1.0, 2.0, 12.0, 1.0, 0.0, 1.0, 4.0, 13.0, 1.0, 0.0, 1.0, &
           3.0, 13.0, 1.0, 0.0, 1.0, 2.0, 13.0, 1.0, 0.0, 1.0, 5.0, 14.0, 1.0, 0.0, 1.0, 4.0, &
           14.0, 1.0, 0.0, 1.0, 6.0, 14.0, 1.0, 0.0, 1.0, 6.0, 13.0, 1.0, 0.0, 1.0, 3.0, 14.0, &
           1.0, 0.0, 1.0, 6.0, 12.0, 1.0, 0.0, 1.0, 2.0, 14.0, 1.0, 0.0, 1.0, 5.0, 12.0, 1.0, &
           0.0, 1.0, 5.0, 13.0, 1.0, 104.0, 5.0, 1.0, 3.0, -1.0, -1.0, 1.0, 56.0, 7.0, 11.0, &
           0.0, 2.0, 4.0, 9.0, 2.0, 4.0, 1.0, 0.0, 3.0, 3.0, 5.0, 1.0, 0.0, 3.0, 2.0, 5.0, 1.0, &
           0.0, 3.0, 4.0, 6.0, 1.0, 0.0, 3.0, 4.0, 5.0, 1.0, 0.0, 3.0, 3.0, 4.0, 1.0, 0.0, 3.0, &
           3.0, 6.0, 1.0, 0.0, 3.0, 4.0, 4.0, 1.0, 0.0, 3.0, 2.0, 6.0, 1.0, 27.0, 6.0, 1.0, &
           10.0, 1.0, 2.0, 0.0, 298.0, 8.0, -1.0, 2.0, 1.0, 4.0, 15.0, 2.0, 57.0, 15.0, 2.0, &
           1.0, 0.0, 7.0, 16.0, 3.0, 1.0, 0.0, 7.0, 15.0, 3.0, 1.0, 0.0, 7.0, 14.0, 2.0, 2.0, &
           0.0, 7.0, 16.0, 4.0, 1.0, 0.0, 7.0, 16.0, 2.0, 1.0, 0.0, 7.0, 17.0, 3.0, 1.0, 0.0, &
           7.0, 16.0, 5.0, 1.0, 0.0, 7.0, 15.0, 5.0, 1.0, 0.0, 7.0, 18.0, 3.0, 1.0, 0.0, 7.0, &
           18.0, 2.0, 1.0, 0.0, 7.0, 17.0, 6.0, 1.0, 0.0, 7.0, 15.0, 6.0, 1.0, 0.0, 7.0, 18.0, &
           4.0, 1.0, 0.0, 7.0, 18.0, 5.0, 1.0, 0.0, 7.0, 15.0, 4.0, 1.0, 0.0, 7.0, 17.0, 2.0, &
           1.0, 0.0, 7.0, 17.0, 5.0, 1.0, 0.0, 7.0, 15.0, 7.0, 1.0, 0.0, 7.0, 18.0, 6.0, 1.0, &
           0.0, 7.0, 13.0, 2.0, 1.0, 0.0, 7.0, 16.0, 7.0, 1.0, 0.0, 7.0, 12.0, 2.0, 1.0, 0.0, &
           7.0, 17.0, 8.0, 1.0, 0.0, 7.0, 11.0, 2.0, 1.0, 0.0, 7.0, 18.0, 9.0, 1.0, 0.0, 7.0, &
           17.0, 9.0, 1.0, 0.0, 7.0, 18.0, 8.0, 1.0, 0.0, 7.0, 10.0, 2.0, 1.0, 0.0, 7.0, 16.0, &
           9.0, 1.0, 0.0, 7.0, 15.0, 8.0, 1.0, 0.0, 7.0, 17.0, 7.0, 1.0, 0.0, 7.0, 16.0, 8.0, &
           1.0, 0.0, 7.0, 17.0, 4.0, 1.0, 0.0, 7.0, 18.0, 7.0, 1.0, 0.0, 7.0, 15.0, 9.0, 1.0, &
           0.0, 7.0, 16.0, 10.0, 1.0, 0.0, 7.0, 9.0, 2.0, 1.0, 0.0, 7.0, 15.0, 10.0, 1.0, 0.0, &
           7.0, 16.0, 6.0, 1.0, 0.0, 7.0, 17.0, 10.0, 1.0, 0.0, 7.0, 8.0, 2.0, 1.0, 0.0, 7.0, &
           17.0, 11.0, 1.0, 0.0, 7.0, 16.0, 11.0, 1.0, 0.0, 7.0, 18.0, 11.0, 1.0, 0.0, 7.0, &
           17.0, 12.0, 1.0, 0.0, 7.0, 16.0, 12.0, 1.0, 0.0, 7.0, 7.0, 2.0, 1.0, 0.0, 7.0, 18.0, &
           13.0, 1.0, 0.0, 7.0, 16.0, 13.0, 1.0, 0.0, 7.0, 17.0, 13.0, 1.0, 0.0, 7.0, 6.0, 2.0, &
           1.0, 0.0, 7.0, 18.0, 12.0, 1.0, 0.0, 7.0, 5.0, 2.0, 1.0, 0.0, 7.0, 18.0, 10.0, 1.0, &
           0.0, 7.0, 4.0, 2.0, 1.0, 0.0, 7.0, 3.0, 2.0, 1.0, 56.0, 8.0, 1.0, -1.0, 4.0, 4.0, &
           0.0, 183.0, 9.0, 12.0, 2.0, 2.0, 5.0, 8.0, 17.0, 34.0, 8.0, 17.0, 1.0, 0.0, 6.0, 9.0, &
           18.0, 1.0, 0.0, 6.0, 7.0, 18.0, 1.0, 0.0, 6.0, 10.0, 17.0, 1.0, 0.0, 6.0, 7.0, 17.0, &
           1.0, 0.0, 6.0, 8.0, 19.0, 1.0, 0.0, 6.0, 6.0, 18.0, 1.0, 0.0, 6.0, 11.0, 18.0, 1.0, &
           0.0, 6.0, 7.0, 19.0, 1.0, 0.0, 6.0, 5.0, 17.0, 1.0, 0.0, 6.0, 12.0, 18.0, 1.0, 0.0, &
           6.0, 12.0, 17.0, 1.0, 0.0, 6.0, 4.0, 18.0, 1.0, 0.0, 6.0, 13.0, 19.0, 1.0, 0.0, 6.0, &
           13.0, 17.0, 1.0, 0.0, 6.0, 13.0, 18.0, 1.0, 0.0, 6.0, 4.0, 19.0, 1.0, 0.0, 6.0, 4.0, &
           17.0, 1.0, 0.0, 6.0, 8.0, 18.0, 1.0, 0.0, 6.0, 10.0, 19.0, 1.0, 0.0, 6.0, 9.0, 17.0, &
           1.0, 0.0, 6.0, 11.0, 19.0, 1.0, 0.0, 6.0, 12.0, 19.0, 1.0, 0.0, 6.0, 5.0, 19.0, 1.0, &
           0.0, 6.0, 5.0, 18.0, 1.0, 0.0, 6.0, 10.0, 18.0, 1.0, 0.0, 6.0, 9.0, 19.0, 1.0, 0.0, &
           6.0, 11.0, 17.0, 1.0, 0.0, 6.0, 3.0, 17.0, 1.0, 0.0, 6.0, 3.0, 19.0, 1.0, 0.0, 6.0, &
           3.0, 18.0, 1.0, 0.0, 6.0, 2.0, 18.0, 1.0, 0.0, 6.0, 2.0, 17.0, 1.0, 0.0, 6.0, 2.0, &
           19.0, 1.0, 34.0, 7.0, 1.0, 11.0, 1.0, 3.0, 0.0, 238.0, 10.0, 11.0, 2.0, 3.0, 6.0, &
           8.0, 12.0, 45.0, 8.0, 12.0, 1.0, 0.0, 5.0, 9.0, 13.0, 1.0, 0.0, 5.0, 7.0, 13.0, &
           1.0, 0.0, 5.0, 10.0, 12.0, 1.0, 0.0, 5.0, 8.0, 13.0, 1.0, 0.0, 5.0, 8.0, 14.0, 1.0, &
           0.0, 5.0, 6.0, 13.0, 1.0, 0.0, 5.0, 11.0, 13.0, 1.0, 0.0, 5.0, 6.0, 12.0, 1.0, 0.0, &
           5.0, 6.0, 14.0, 1.0, 0.0, 5.0, 5.0, 12.0, 1.0, 0.0, 5.0, 12.0, 12.0, 1.0, 0.0, 5.0, &
           4.0, 13.0, 1.0, 0.0, 5.0, 4.0, 11.0, 1.0, 0.0, 5.0, 13.0, 13.0, 1.0, 0.0, 5.0, 13.0, &
           12.0, 1.0, 0.0, 5.0, 4.0, 14.0, 1.0, 0.0, 5.0, 3.0, 10.0, 1.0, 0.0, 5.0, 4.0, 12.0, &
           1.0, 0.0, 5.0, 10.0, 13.0, 1.0, 0.0, 5.0, 10.0, 14.0, 1.0, 0.0, 5.0, 9.0, 14.0, 1.0, &
           0.0, 5.0, 12.0, 13.0, 1.0, 0.0, 5.0, 2.0, 9.0, 1.0, 0.0, 5.0, 3.0, 9.0, 1.0, 0.0, &
           5.0, 11.0, 14.0, 1.0, 0.0, 5.0, 5.0, 13.0, 1.0, 0.0, 5.0, 12.0, 14.0, 1.0, 0.0, 5.0, &
           4.0, 8.0, 1.0, 0.0, 5.0, 3.0, 8.0, 1.0, 0.0, 5.0, 2.0, 8.0, 1.0, 0.0, 5.0, 4.0, 9.0, &
           1.0, 0.0, 5.0, 9.0, 12.0, 1.0, 0.0, 5.0, 5.0, 14.0, 1.0, 0.0, 5.0, 2.0, 11.0, 1.0, &
           0.0, 5.0, 4.0, 10.0, 1.0, 0.0, 5.0, 13.0, 14.0, 1.0, 0.0, 5.0, 2.0, 12.0, 1.0, 0.0, &
           5.0, 11.0, 12.0, 1.0, 0.0, 5.0, 3.0, 12.0, 1.0, 0.0, 5.0, 2.0, 13.0, 1.0, 0.0, 5.0, &
           3.0, 11.0, 1.0, 0.0, 5.0, 3.0, 14.0, 1.0, 0.0, 5.0, 2.0, 14.0, 1.0, 0.0, 5.0, 3.0, &
           13.0, 1.0, 45.0, 6.0, 1.0, 7.0, 1.0, 2.0, 0.0, 288.0, 11.0, 12.0, 2.0, 10.0, 7.0, &
           8.0, 12.0, 55.0, 8.0, 12.0, 1.0, 0.0, 6.0, 9.0, 13.0, 1.0, 0.0, 6.0, 7.0, 13.0, &
           1.0, 0.0, 6.0, 10.0, 12.0, 1.0, 0.0, 6.0, 8.0, 13.0, 1.0, 0.0, 6.0, 8.0, 14.0, &
           1.0, 0.0, 6.0, 6.0, 13.0, 1.0, 0.0, 6.0, 11.0, 13.0, 1.0, 0.0, 6.0, 6.0, 12.0, &
           1.0, 0.0, 6.0, 6.0, 14.0, 1.0, 0.0, 6.0, 5.0, 12.0, 1.0, 0.0, 6.0, 12.0, 12.0, &
           1.0, 0.0, 6.0, 4.0, 13.0, 1.0, 0.0, 6.0, 4.0, 11.0, 1.0, 0.0, 6.0, 13.0, 13.0, &
           1.0, 0.0, 6.0, 13.0, 12.0, 1.0, 0.0, 6.0, 4.0, 14.0, 1.0, 0.0, 6.0, 3.0, 10.0, &
           1.0, 0.0, 6.0, 4.0, 12.0, 1.0, 0.0, 6.0, 10.0, 13.0, 1.0, 0.0, 6.0, 10.0, 14.0, &
           1.0, 0.0, 6.0, 9.0, 14.0, 1.0, 0.0, 6.0, 12.0, 13.0, 1.0, 0.0, 6.0, 2.0, 9.0, 1.0, &
           0.0, 6.0, 3.0, 9.0, 1.0, 0.0, 6.0, 11.0, 14.0, 1.0, 0.0, 6.0, 5.0, 13.0, 1.0, 0.0, &
           6.0, 12.0, 14.0, 1.0, 0.0, 6.0, 4.0, 8.0, 1.0, 0.0, 6.0, 3.0, 8.0, 1.0, 0.0, 6.0, &
           2.0, 8.0, 1.0, 0.0, 6.0, 4.0, 9.0, 1.0, 0.0, 6.0, 3.0, 7.0, 1.0, 0.0, 6.0, 9.0, &
           12.0, 1.0, 0.0, 6.0, 2.0, 6.0, 1.0, 0.0, 6.0, 5.0, 14.0, 1.0, 0.0, 6.0, 3.0, 5.0, &
           1.0, 0.0, 6.0, 2.0, 5.0, 1.0, 0.0, 6.0, 4.0, 5.0, 1.0, 0.0, 6.0, 4.0, 4.0, 1.0, &
           0.0, 6.0, 2.0, 4.0, 1.0, 0.0, 6.0, 3.0, 4.0, 1.0, 0.0, 6.0, 4.0, 6.0, 1.0, 0.0, &
           6.0, 3.0, 6.0, 1.0, 0.0, 6.0, 2.0, 11.0, 1.0, 0.0, 6.0, 4.0, 10.0, 1.0, 0.0, &
           6.0, 2.0, 12.0, 1.0, 0.0, 6.0, 13.0, 14.0, 1.0, 0.0, 6.0, 2.0, 13.0, 1.0, 0.0, &
           6.0, 11.0, 12.0, 1.0, 0.0, 6.0, 2.0, 14.0, 1.0, 0.0, 6.0, 3.0, 12.0, 1.0, 0.0, &
           6.0, 3.0, 11.0, 1.0, 0.0, 6.0, 3.0, 14.0, 1.0, 0.0, 6.0, 3.0, 13.0, 1.0, 55.0, &
           7.0, 1.0, 9.0, 1.0, 4.0, 0.0, 468.0, 12.0, -1.0, 2.0, 9.0, 11.0, 8.0, 17.0, &
           91.0, 8.0, 17.0, 1.0, 0.0, 7.0, 9.0, 18.0, 1.0, 0.0, 7.0, 7.0, 18.0, 1.0, 0.0, &
           7.0, 10.0, 17.0, 1.0, 0.0, 7.0, 7.0, 17.0, 1.0, 0.0, 7.0, 8.0, 19.0, 1.0, 0.0, &
           7.0, 6.0, 18.0, 1.0, 0.0, 7.0, 11.0, 18.0, 1.0, 0.0, 7.0, 7.0, 19.0, 1.0, 0.0, &
           7.0, 5.0, 17.0, 1.0, 0.0, 7.0, 12.0, 18.0, 1.0, 0.0, 7.0, 12.0, 17.0, 1.0, 0.0, &
           7.0, 4.0, 18.0, 1.0, 0.0, 7.0, 13.0, 19.0, 1.0, 0.0, 7.0, 13.0, 17.0, 1.0, 0.0, &
           7.0, 13.0, 18.0, 1.0, 0.0, 7.0, 4.0, 19.0, 1.0, 0.0, 7.0, 4.0, 17.0, 1.0, 0.0, &
           7.0, 8.0, 18.0, 1.0, 0.0, 7.0, 10.0, 19.0, 1.0, 0.0, 7.0, 9.0, 17.0, 1.0, 0.0, &
           7.0, 11.0, 19.0, 1.0, 0.0, 7.0, 12.0, 19.0, 1.0, 0.0, 7.0, 5.0, 19.0, 1.0, 0.0, &
           7.0, 5.0, 18.0, 1.0, 0.0, 7.0, 3.0, 16.0, 1.0, 0.0, 7.0, 10.0, 18.0, 1.0, 0.0, &
           7.0, 9.0, 19.0, 1.0, 0.0, 7.0, 11.0, 17.0, 1.0, 0.0, 7.0, 3.0, 15.0, 1.0, 0.0, &
           7.0, 3.0, 17.0, 1.0, 0.0, 7.0, 2.0, 17.0, 1.0, 0.0, 7.0, 3.0, 19.0, 1.0, 0.0, &
           7.0, 4.0, 14.0, 1.0, 0.0, 7.0, 2.0, 14.0, 1.0, 0.0, 7.0, 2.0, 19.0, 1.0, 0.0, &
           7.0, 5.0, 14.0, 1.0, 0.0, 7.0, 4.0, 13.0, 1.0, 0.0, 7.0, 6.0, 14.0, 1.0, 0.0, &
           7.0, 6.0, 13.0, 1.0, 0.0, 7.0, 5.0, 12.0, 1.0, 0.0, 7.0, 4.0, 12.0, 1.0, 0.0, &
           7.0, 6.0, 12.0, 1.0, 0.0, 7.0, 4.0, 11.0, 1.0, 0.0, 7.0, 3.0, 11.0, 1.0, 0.0, &
           7.0, 3.0, 12.0, 1.0, 0.0, 7.0, 4.0, 10.0, 1.0, 0.0, 7.0, 3.0, 10.0, 1.0, 0.0, &
           7.0, 2.0, 12.0, 1.0, 0.0, 7.0, 2.0, 11.0, 1.0, 0.0, 7.0, 4.0, 9.0, 1.0, 0.0, &
           7.0, 3.0, 9.0, 1.0, 0.0, 7.0, 2.0, 9.0, 1.0, 0.0, 7.0, 7.0, 13.0, 1.0, 0.0, &
           7.0, 2.0, 8.0, 1.0, 0.0, 7.0, 3.0, 13.0, 1.0, 0.0, 7.0, 2.0, 13.0, 1.0, 0.0, &
           7.0, 5.0, 13.0, 1.0, 0.0, 7.0, 2.0, 18.0, 1.0, 0.0, 7.0, 3.0, 14.0, 1.0, 0.0, &
           7.0, 3.0, 18.0, 1.0, 0.0, 7.0, 8.0, 13.0, 1.0, 0.0, 7.0, 8.0, 12.0, 1.0, 0.0, &
           7.0, 3.0, 7.0, 1.0, 0.0, 7.0, 8.0, 14.0, 1.0, 0.0, 7.0, 4.0, 8.0, 1.0, 0.0, 7.0, &
           3.0, 8.0, 1.0, 0.0, 7.0, 9.0, 13.0, 1.0, 0.0, 7.0, 4.0, 6.0, 1.0, 0.0, 7.0, 3.0, &
           6.0, 1.0, 0.0, 7.0, 2.0, 6.0, 1.0, 0.0, 7.0, 10.0, 13.0, 1.0, 0.0, 7.0, 10.0, 12.0, &
           1.0, 0.0, 7.0, 3.0, 5.0, 1.0, 0.0, 7.0, 2.0, 5.0, 1.0, 0.0, 7.0, 4.0, 5.0, 1.0, 0.0, &
           7.0, 4.0, 4.0, 1.0, 0.0, 7.0, 3.0, 4.0, 1.0, 0.0, 7.0, 2.0, 4.0, 1.0, 0.0, 7.0, 11.0, &
           14.0, 1.0, 0.0, 7.0, 11.0, 13.0, 1.0, 0.0, 7.0, 11.0, 12.0, 1.0, 0.0, 7.0, 12.0, &
           14.0, 1.0, 0.0, 7.0, 12.0, 13.0, 1.0, 0.0, 7.0, 12.0, 12.0, 1.0, 0.0, 7.0, 13.0, &
           14.0, 1.0, 0.0, 7.0, 13.0, 13.0, 1.0, 0.0, 7.0, 13.0, 12.0, 1.0, 0.0, 7.0, 9.0, 12.0, &
           1.0, 0.0, 7.0, 10.0, 14.0, 1.0, 0.0, 7.0, 9.0, 14.0, 1.0, 91.0, 8.0, 1.0, -1.0, 4.0, &
           4.0, 0.0 /)
      allocate(expected_corresponding_surface_cell_lat_index(nlat_lake,nlon_lake))
      expected_corresponding_surface_cell_lat_index = transpose(reshape((/   &
            1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, &
         1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, &
         1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, &
         1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, &
         1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, &
         1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, &
         2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, &
         2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, &
         2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, &
         2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, &
         2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, &
         2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, &
         2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, &
         2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, &
         3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, &
         3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, &
         3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, &
         3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, &
         3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, &
         3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3 /), &
         (/nlon_lake,nlat_lake/)))
      allocate(expected_corresponding_surface_cell_lon_index(nlat_lake,nlon_lake))
      expected_corresponding_surface_cell_lon_index = transpose(reshape((/   &
          1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, &
         1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, &
         1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, &
         1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, &
         1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, &
         1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, &
         1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, &
         1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, &
         1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, &
         1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, &
         1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, &
         1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, &
         1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, &
         1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, &
         1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, &
         1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, &
         1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, &
         1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, &
         1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, &
         1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3 /), &
         (/nlon_lake,nlat_lake/)))
      allocate(expected_lake_centers(nlat_lake,nlon_lake))
      expected_lake_centers(:,:) = .false.
      allocate(expected_number_fine_grid_cells(nlat_surface,nlon_surface))
      expected_number_fine_grid_cells = transpose(reshape((/   &
          36, 48, 36, &
         48, 64, 48, &
         36, 48, 36  /), &
         (/nlon_surface,nlat_surface/)))
      allocate(expected_binary_lake_mask(nlat_surface,nlon_surface))
      expected_binary_lake_mask = transpose(reshape((/   &
         .true.,.false.,.true., &
         .false.,.true.,.false., &
         .false.,.false.,.true. /), &
         (/nlon_surface,nlat_surface/)))
      allocate(expected_surface_cell_to_fine_cell_map_numbers(nlat_surface,nlon_surface))
      expected_surface_cell_to_fine_cell_map_numbers = transpose(reshape((/   &
          1, 2, 3, &
         4, 5, 6, &
         7, 8, 0  /), &
         (/nlon_surface,nlat_surface/)))
      call load_lake_parameters(cell_areas_on_surface_model_grid, &
                                .true., &
                                lake_model_parameters, &
                                lake_parameters_as_array, &
                                nlat_hd,nlon_hd, &
                                nlat_surface,nlon_surface)
      call assert_equals(lake_parameters_as_array,expected_lake_parameters_as_array, &
                         size(expected_lake_parameters_as_array))
      call assert_equals(lake_model_parameters%corresponding_surface_cell_lat_index, &
                         expected_corresponding_surface_cell_lat_index,nlat_lake,nlon_lake)
      call assert_equals(lake_model_parameters%corresponding_surface_cell_lon_index, &
                         expected_corresponding_surface_cell_lon_index,nlat_lake,nlon_lake)
      call assert_equals(lake_model_parameters%number_of_lakes,12)
      call assert_false(associated(lake_model_parameters%basins))
      call assert_false(associated(lake_model_parameters%basin_numbers))
      call assert_false(associated(lake_model_parameters%cells_with_lakes_lat))
      call assert_false(associated(lake_model_parameters%cells_with_lakes_lon))
      call assert_equals(lake_model_parameters%cell_areas_on_surface_model_grid, &
                         cell_areas_on_surface_model_grid,nlat_surface,nlon_surface)
      call assert_equals(lake_model_parameters%lake_centers, &
                         expected_lake_centers,nlat_lake,nlon_lake)
      call assert_equals(lake_model_parameters%number_fine_grid_cells, &
                         expected_number_fine_grid_cells,nlat_surface,nlon_surface)
      call assert_equals(lake_model_parameters%surface_cell_to_fine_cell_map_numbers, &
                         expected_surface_cell_to_fine_cell_map_numbers, &
                         nlat_surface,nlon_surface)
      call assert_equals(lake_model_parameters%binary_lake_mask, &
                         expected_binary_lake_mask,nlat_surface,nlon_surface)
      deallocate(lake_model_parameters%lake_centers)
      deallocate(lake_model_parameters%number_fine_grid_cells)
      do i = 1,size(lake_model_parameters%surface_cell_to_fine_cell_maps)
         call clean_coords_list(lake_model_parameters%surface_cell_to_fine_cell_maps(i))
      end do
      deallocate(lake_model_parameters%surface_cell_to_fine_cell_maps)
      deallocate(lake_model_parameters%surface_cell_to_fine_cell_map_numbers)
      deallocate(lake_model_parameters%corresponding_surface_cell_lat_index)
      deallocate(lake_model_parameters%corresponding_surface_cell_lon_index)
      deallocate(lake_model_parameters%binary_lake_mask)
      deallocate(cell_areas_on_surface_model_grid)
      deallocate(expected_corresponding_surface_cell_lat_index)
      deallocate(expected_corresponding_surface_cell_lon_index)
      deallocate(expected_number_fine_grid_cells)
      deallocate(expected_surface_cell_to_fine_cell_map_numbers)
      deallocate(expected_lake_parameters_as_array)
      deallocate(expected_binary_lake_mask)
      deallocate(expected_lake_centers)
      deallocate(lake_model_parameters)
      deallocate(lake_parameters_as_array)
 end subroutine testLakeInputTests2

end module lake_model_input_test_mod
