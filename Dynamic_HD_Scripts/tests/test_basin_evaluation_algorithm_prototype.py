'''
Unit tests for the compute_catchments module

Created on Oct 31, 2024

@author: thomasriddick
'''

import unittest
import numpy as np
from Dynamic_HD_Scripts.utilities.basin_evaluation_algorithm_prototype \
import LatLonEvaluateBasin,DisjointSetForest


class DisjointSetTests(unittest.TestCase):

  def testDisjointSet(self):
    dsets = DisjointSetForest()
    dsets.add_set(1)
    dsets.add_set(2)
    dsets.add_set(5)
    dsets.add_set(6)
    dsets.add_set(9)
    dsets.add_set(10)
    dsets.add_set(13)
    dsets.add_set(14)
    dsets.add_set(17)
    dsets.add_set(18)
    dsets.add_set(19)
    dsets.add_set(20)
    dsets.make_new_link(2,5)
    dsets.make_new_link(5,9)
    dsets.make_new_link(5,10)
    dsets.make_new_link(13,1)
    dsets.make_new_link(1,14)
    dsets.make_new_link(14,17)
    dsets.make_new_link(14,18)
    dsets.make_new_link(13,19)
    dsets.make_new_link(20,18)
    self.assertTrue(dsets.check_subset_has_elements(10,[2, 5, 9, 10]));
    self.assertTrue(dsets.check_subset_has_elements(6,[6]));
    self.assertTrue(dsets.check_subset_has_elements(18,[20, 13, 1, 14, 17, 18, 19]));
    self.assertTrue(dsets.make_new_link(2,18));
    self.assertTrue(dsets.check_subset_has_elements(6,[6]));
    self.assertTrue(dsets.check_subset_has_elements(2,[2, 5, 9, 10, 20, 13, 1, 14, 17, 18, 19]));
    self.assertFalse(dsets.make_new_link(17,10));

class BasinEvaluationTests(unittest.TestCase):

  def testBasinEvaluationSingleLake(self):
    coarse_catchment_nums_in = np.array([[1, 1, 1],
                                         [1, 1, 1],
                                         [1, 1, 1]])
    prior_coarse_rdirs_in = np.array([[6, 6,  2],
                                      [6, -2, 2],
                                      [6,  6, 0]])
    corrected_orography_in = np.array([
      [10., 10., 10., 10., 10., 10.],
      [10., 10.,  8.,  8.,  5., 10.],
      [10.,  7.,  5.,  5.,  6., 10.],
      [10.,  7.,  5.,  5.,  6., 10.],
      [10., 10., 10., 10., 10., 10.],
      [10., 10., 10., 10., 10.,  0.]])

    raw_orography_in = np.array([
      [10., 10., 10., 10., 10., 10.],
      [10., 10.,  8.,  8.,  5., 10.],
      [10.,  7.,  5.,  5.,  6., 10.],
      [10.,  7.,  5.,  5.,  6., 10.],
      [10., 10., 10., 10., 10., 10.],
      [10., 10., 10., 10.,  0.,  0.]])

    minima_in = np.array([
      [False, False, False, False, False, False],
      [False, False, False, False, False, False],
      [False, False, False, False, False, False],
      [False, False, True,  False, False, False],
      [False, False, False, False, False, False],
      [False, False, False, False, False, False]])
    prior_fine_rdirs_in = np.array([
      [2, 2, 2, 2, 2, 2],
      [2, 2, 2, 2, 2, 2],
      [2, 6, 2, 1, 4, 2],
      [2, 6, 5, 4, 4, 2],
      [2, 2, 2, 2, 2, 2],
      [6, 6, 6, 6, 6, 0]])
    prior_fine_catchments_in = np.array([
      [1, 2, 2, 2, 2, 1],
      [1, 2, 2, 2, 2, 1],
      [1, 2, 2, 2, 2, 1],
      [1, 2, 2, 2, 2, 1],
      [1, 1, 1, 1, 1, 1],
      [1, 1, 1, 1, 1, 1]])
    cell_areas_in = np.full((6,6),1.0)
    landsea_in = np.full((6,6),0,dtype=np.int32)
    landsea_in[5,5] = 1
    output,alg = \
      LatLonEvaluateBasin.evaluate_basins(landsea_in,
                                          minima_in,
                                          raw_orography_in,
                                          corrected_orography_in,
                                          cell_areas_in,
                                          prior_fine_rdirs_in,
                                          prior_fine_catchments_in,
                                          coarse_catchment_nums_in,
                                          return_algorithm_object=True)
    expected_lake_mask = np.array([
      [False, False, False, False, False, False],
      [False, False,  True,  True,  True, False],
      [False,  True,  True,  True,  True, False],
      [False,  True,  True,  True,  True, False],
      [False, False, False, False, False, False],
      [False, False, False, False, False, False]])
    expected_lakes_as_array = \
      [1.0, 66.0, 1.0, -1.0, 0.0, 4.0, 3.0, 11.0, 4.0, 3.0, 1.0, 0.0, 5.0, 4.0, 4.0,
       1.0, 0.0, 5.0, 3.0, 4.0, 1.0, 0.0, 5.0, 3.0, 3.0, 1.0, 0.0, 5.0, 2.0, 5.0,
       1.0, 5.0, 6.0, 4.0, 5.0, 1.0, 5.0, 6.0, 3.0, 5.0, 1.0, 12.0, 7.0, 3.0, 2.0,
       1.0, 12.0, 7.0, 4.0, 2.0, 1.0, 21.0, 8.0, 2.0, 3.0, 1.0, 21.0, 8.0, 2.0, 4.0,
       1.0, 43.0, 10.0, 1.0, -1.0, 3.0, 3.0, 0.0]
    self.assertEqual(output["number_of_lakes"],1)
    self.assertEqual(output["lakes_as_array"],expected_lakes_as_array)
    np.testing.assert_array_equal(output["lake_mask"],expected_lake_mask)


  def testBasinEvaluationTwoLakes(self):
    coarse_catchment_nums_in = np.array([[2, 2, 1],
                                         [2, 2, 1],
                                         [2, 2, 1]])
    prior_coarse_rdirs_in = np.array([[2, 2,  2],
                                      [-2, 4, -2],
                                      [6,  6, 0]])
    corrected_orography_in = np.array([
      [10., 10., 10., 10., 10., 10.],
      [10., 10., 10., 10., 10., 10.],
      [10.,  5., 10., 10.,  5., 10.],
      [10.,  5.,  6.,  8.,  5., 10.],
      [10., 10., 10., 10., 10., 10.],
      [10., 10., 10., 10., 10.,  0.]])

    raw_orography_in = np.array([
      [10., 10., 10., 10., 10., 10.],
      [10., 10., 10., 10., 10., 10.],
      [10.,  5., 10., 10.,  5., 10.],
      [10.,  5.,  6.,  8.,  5., 10.],
      [10., 10., 10., 10., 10., 10.],
      [10., 10., 10., 10., 10.,  0.]])

    minima_in = np.array([
      [False, False, False, False, False, False],
      [False, False, False, False, False, False],
      [False, False, False, False, False, False],
      [False,  True, False, False,  True, False],
      [False, False, False, False, False, False],
      [False, False, False, False, False, False]])
    prior_fine_rdirs_in = np.array([
      [2, 2, 2, 2, 2, 2],
      [2, 2, 2, 2, 2, 2],
      [2, 6, 2, 3, 2, 2],
      [2, 5, 4, 6, 5, 2],
      [2, 2, 2, 2, 2, 2],
      [6, 6, 6, 6, 6, 0]])
    prior_fine_catchments_in = np.array([
      [1, 3, 3, 2, 2, 1],
      [1, 3, 3, 2, 2, 1],
      [1, 3, 3, 2, 2, 1],
      [1, 3, 3, 2, 2, 1],
      [1, 3, 3, 2, 2, 1],
      [1, 1, 1, 1, 1, 1]])
    cell_areas_in = np.full((6,6),1.0)
    landsea_in = np.full((6,6),0,dtype=np.int32)
    landsea_in[5,5] = 1
    output,alg = \
      LatLonEvaluateBasin.evaluate_basins(landsea_in,
                                          minima_in,
                                          raw_orography_in,
                                          corrected_orography_in,
                                          cell_areas_in,
                                          prior_fine_rdirs_in,
                                          prior_fine_catchments_in,
                                          coarse_catchment_nums_in,
                                          return_algorithm_object=True)
    expected_lake_mask = np.array([
       [False, False, False, False, False, False],
       [False, False, False, False, False, False],
       [False,  True, False, False,  True, False],
       [False,  True,  True,  True,  True, False],
       [False, False, False, False, False, False],
       [False, False, False, False, False, False]])
    expected_lakes_as_array = \
    [3.0, 21.0, 1.0, 3.0, 0.0, 4.0, 5.0, 2.0, 4.0, 5.0, 1.0, 0.0, 5.0, 3.0, 5.0,
     1.0, 6.0, 8.0, 1.0, 2.0, 2.0, 2.0, 0.0, 26.0, 2.0, 3.0, 0.0, 4.0, 2.0, 3.0,
     4.0, 2.0, 1.0, 0.0, 5.0, 3.0, 2.0, 1.0, 2.0, 6.0, 4.0, 3.0, 1.0, 8.0, 8.0,
     1.0, 1.0, -1.0, -1.0, 1.0, 43.0, 3.0, -1.0, 2.0, 1.0, 2.0, 4.0, 5.0, 6.0, 4.0,
     5.0, 1.0, 0.0, 8.0, 3.0, 5.0, 1.0, 0.0, 8.0, 4.0, 4.0, 1.0, 0.0, 8.0, 4.0,
     3.0, 1.0, 0.0, 8.0, 4.0, 2.0, 1.0, 0.0, 8.0, 3.0, 2.0, 1.0, 12.0, 10.0, 1.0,
     -1.0, 3.0, 3.0, 0.0]
    self.assertEqual(output["number_of_lakes"],3)
    self.assertEqual(output["lakes_as_array"],expected_lakes_as_array)
    np.testing.assert_array_equal(output["lake_mask"],expected_lake_mask)

  def testBasinEvaluationSingleLakeTwo(self):
    coarse_catchment_nums_in = np.array([[2, 1, 1],
                                         [2, 2, 1],
                                         [2, 2, 1]])
    prior_coarse_rdirs_in = np.array([[-2,6,2],
                                      [8,7,2 ],
                                      [8,7,0 ]])
    corrected_orography_in = np.array([
      [10.0,10.0,10.0, 3.0,10.0,10.0,10.0,10.0,10.0],
      [10.0,10.0,10.0, 3.0,10.0,10.0,10.0,10.0,10.0],
      [10.0,10.0, 2.0, 3.0,10.0,10.0,10.0,10.0,10.0],
      [10.0,10.0, 2.0, 2.0,10.0,10.0,10.0,10.0,10.0],
      [10.0,10.0, 2.0, 2.0,10.0,10.0,10.0,10.0,10.0],
      [10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0],
      [10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0],
      [10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0],
      [10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0, 0.0]])

    raw_orography_in = np.array([
      [10.0,10.0,10.0, 3.0,10.0,10.0,10.0,10.0,10.0],
      [10.0,10.0,10.0, 3.0,10.0,10.0,10.0,10.0,10.0],
      [10.0,10.0, 1.0, 3.0,10.0,10.0,10.0,10.0,10.0],
      [10.0,10.0, 2.0, 2.0,10.0,10.0,10.0,10.0,10.0],
      [10.0,10.0, 2.0, 2.0,10.0,10.0,10.0,10.0,10.0],
      [10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0],
      [10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0],
      [10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0],
      [10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0, 0.0]])

    minima_in = np.array([
      [False,False,False,False,False,False,False,False,False],
      [False,False,False,False,False,False,False,False,False],
      [False,False, True,False,False,False,False,False,False],
      [False,False,False,False,False,False,False,False,False],
      [False,False,False,False,False,False,False,False,False],
      [False,False,False,False,False,False,False,False,False],
      [False,False,False,False,False,False,False,False,False],
      [False,False,False,False,False,False,False,False,False],
      [False,False,False,False,False,False,False,False,False]])
    prior_fine_rdirs_in = np.array([
      [3, 2, 6, 6, 6, 6, 6, 6, 2],
      [3, 3, 8, 6, 6, 6, 6, 6, 2],
      [4, 4, 5, 4, 4, 4, 2, 2, 2],
      [8, 7, 8, 4, 4, 4, 2, 2, 2],
      [8, 7, 8, 4, 4, 4, 2, 2, 2],
      [8, 7, 8, 4, 4, 4, 2, 2, 2],
      [8, 8, 8, 4, 4, 4, 2, 2, 2],
      [8, 8, 8, 4, 4, 4, 2, 2, 2],
      [8, 8, 8, 4, 4, 4, 2, 6, 0]])
    prior_fine_catchments_in = np.array([
      [1, 1, 2, 2, 2, 2, 2, 2, 2],
      [1, 1, 2, 2, 2, 2, 2, 2, 2],
      [1, 1, 1, 1, 1, 1, 2, 2, 2],
      [1, 1, 1, 1, 1, 1, 2, 2, 2],
      [1, 1, 1, 1, 1, 1, 2, 2, 2],
      [1, 1, 1, 1, 1, 1, 2, 2, 2],
      [1, 1, 1, 1, 1, 1, 2, 2, 2],
      [1, 1, 1, 1, 1, 1, 2, 2, 2],
      [1, 1, 1, 1, 1, 1, 2, 6, 0]])
    cell_areas_in = np.full((9,9),1.0)
    landsea_in = np.full((9,9),0,dtype=np.int32)
    landsea_in[8,8] = 1
    output,alg = \
      LatLonEvaluateBasin.evaluate_basins(landsea_in,
                                          minima_in,
                                          raw_orography_in,
                                          corrected_orography_in,
                                          cell_areas_in,
                                          prior_fine_rdirs_in,
                                          prior_fine_catchments_in,
                                          coarse_catchment_nums_in,
                                          return_algorithm_object=True)
    expected_lake_mask = np.array([
       [False, False, False,  True, False, False, False, False, False],
       [False, False, False,  True, False, False, False, False, False],
       [False, False,  True,  True, False, False, False, False, False],
       [False, False,  True,  True, False, False, False, False, False],
       [False, False,  True,  True, False, False, False, False, False],
       [False, False, False, False, False, False, False, False, False],
       [False, False, False, False, False, False, False, False, False],
       [False, False, False, False, False, False, False, False, False],
       [False, False, False, False, False, False, False, False, False]])
    expected_lakes_as_array = \
      [1.0, 51.0, 1.0, -1.0, 0.0, 3.0, 3.0, 8.0, 3.0, 3.0, 1.0, 1.0, 2.0, 4.0, 4.0,
       1.0, 1.0, 2.0, 4.0, 3.0, 1.0, 1.0, 2.0, 5.0, 3.0, 1.0, 1.0, 2.0, 5.0, 4.0,
       1.0, 6.0, 3.0, 2.0, 4.0, 1.0, 6.0, 3.0, 3.0, 4.0, 1.0, 6.0, 3.0, 1.0, 4.0,
       1.0, 62.0, 10.0, 1.0, -1.0, 3.0, 3.0, 0.0]
    self.assertEqual(output["number_of_lakes"],1)
    self.assertEqual(output["lakes_as_array"],expected_lakes_as_array)
    np.testing.assert_array_equal(output["lake_mask"],expected_lake_mask)

  def testBasinEvaluationSingleLakeThree(self):
    coarse_catchment_nums_in = np.array([[2, 1, 1],
                                         [2, 1, 1],
                                         [2, 1, 1]])
    prior_coarse_rdirs_in = np.array([[-2,6,2],
                                      [ 8,8,2],
                                      [ 8,8,0]])
    corrected_orography_in = np.array([
      [10.0,10.0,10.0, 5.0,8.375,8.0, 8.0, 8.0,8.0],
      [10.0,10.0,10.0, 5.0,10.0,10.0,10.0,10.0,8.0],
      [10.0,10.0, 2.0, 2.0,10.0,10.0,10.0,10.0,8.0],
      [10.0,10.0, 2.0, 2.0,10.0,10.0,10.0,10.0,8.0],
      [10.0,10.0, 2.0, 2.0,10.0,10.0,10.0,10.0,8.0],
      [10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,8.0],
      [10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,8.0],
      [10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,8.0],
      [10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,0.0]])

    raw_orography_in = np.array([
      [10.0,10.0,10.0, 5.0,8.375,8.0, 8.0, 8.0,8.0],
      [10.0,10.0,10.0, 5.0,10.0,10.0,10.0,10.0,8.0],
      [10.0,10.0, 2.0, 2.0,10.0,10.0,10.0,10.0,8.0],
      [10.0,10.0, 2.0, 2.0,10.0,10.0,10.0,10.0,8.0],
      [10.0,10.0, 2.0, 2.0,10.0,10.0,10.0,10.0,8.0],
      [10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,8.0],
      [10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,8.0],
      [10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,8.0],
      [10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,0.0]])

    minima_in = np.array([
      [False,False,False,False,False,False,False,False,False],
      [False,False,False,False,False,False,False,False,False],
      [False,False, True,False,False,False,False,False,False],
      [False,False,False,False,False,False,False,False,False],
      [False,False,False,False,False,False,False,False,False],
      [False,False,False,False,False,False,False,False,False],
      [False,False,False,False,False,False,False,False,False],
      [False,False,False,False,False,False,False,False,False],
      [False,False,False,False,False,False,False,False,False]])
    prior_fine_rdirs_in = np.array([
      [2, 2, 2, 6, 6, 6, 6, 6, 2],
      [6, 3, 2, 6, 6, 6, 6, 6, 2],
      [6, 6, 5, 8, 8, 8, 2, 2, 2],
      [8, 8, 8, 8, 8, 8, 2, 2, 2],
      [8, 8, 8, 8, 8, 8, 2, 2, 2],
      [8, 8, 8, 8, 8, 8, 2, 2, 2],
      [8, 8, 8, 8, 8, 8, 2, 2, 2],
      [8, 8, 8, 8, 8, 8, 2, 2, 2],
      [8, 8, 8, 8, 8, 8, 6, 6, 0]])
    prior_fine_catchments_in = np.array([
      [1, 1, 2, 2, 2, 2, 2, 2, 2],
      [1, 1, 2, 2, 2, 2, 2, 2, 2],
      [1, 1, 1, 1, 2, 2, 2, 2, 2],
      [1, 1, 1, 1, 2, 2, 2, 2, 2],
      [1, 1, 1, 1, 2, 2, 2, 2, 2],
      [1, 1, 1, 1, 2, 2, 2, 2, 2],
      [1, 1, 1, 1, 2, 2, 2, 2, 2],
      [1, 1, 1, 1, 2, 2, 2, 2, 2],
      [1, 1, 1, 1, 2, 2, 2, 2, 0]])
    cell_areas_in = np.full((9,9),86400.0/9.0)
    landsea_in = np.full((9,9),0,dtype=np.int32)
    landsea_in[8,8] = 1
    output,alg = \
      LatLonEvaluateBasin.evaluate_basins(landsea_in,
                                          minima_in,
                                          raw_orography_in,
                                          corrected_orography_in,
                                          cell_areas_in,
                                          prior_fine_rdirs_in,
                                          prior_fine_catchments_in,
                                          coarse_catchment_nums_in,
                                          return_algorithm_object=True)
    expected_lake_mask = np.array([
       [False, False, False,  True, False, False, False, False, False],
       [False, False, False,  True, False, False, False, False, False],
       [False, False,  True,  True, False, False, False, False, False],
       [False, False,  True,  True, False, False, False, False, False],
       [False, False,  True,  True, False, False, False, False, False],
       [False, False, False, False, False, False, False, False, False],
       [False, False, False, False, False, False, False, False, False],
       [False, False, False, False, False, False, False, False, False],
       [False, False, False, False, False, False, False, False, False]])
    expected_lakes_as_array = \
      [1.0, 51.0, 1.0, -1.0, 0.0, 3.0, 3.0, 8.0, 3.0, 3.0, 1.0, 0.0, 2.0, 4.0, 4.0,
       1.0, 0.0, 2.0, 3.0, 4.0, 1.0, 0.0, 2.0, 5.0, 3.0, 1.0, 0.0, 2.0, 4.0, 3.0,
       1.0, 0.0, 2.0, 5.0, 4.0, 1.0, 172800.0, 5.0, 2.0, 4.0, 1.0, 172800.0, 5.0, 1.0, 4.0,
       1.0, 432000.0, 8.375, 1.0, -1.0, 1.0, 2.0, 0.0]
    self.assertEqual(output["number_of_lakes"],1)
    self.assertEqual(output["lakes_as_array"],expected_lakes_as_array)
    np.testing.assert_array_equal(output["lake_mask"],expected_lake_mask)

  def testBasinEvaluationSingleLakeFour(self):
    coarse_catchment_nums_in = np.array([[2,2,2,2],
                                         [2,2,2,2],
                                         [2,2,2,1],
                                         [2,2,2,0]])
    prior_coarse_rdirs_in = np.array([[3,2, 2,1],
                                      [6,6,-2,4],
                                      [6,8, 8,2],
                                      [9,8, 8,0]])
    corrected_orography_in = np.array([
      [3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0],
      [3.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,3.0],
      [3.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,3.0],
      [3.0,2.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,2.0,3.0],
      [3.0,2.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,2.0,3.0],
      [3.0,2.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,2.0,3.0],
      [3.0,2.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,2.0,3.0],
      [3.0,2.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,2.0,3.0],
      [3.0,2.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,2.0,3.0],
      [3.0,2.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,2.0,3.0],
      [3.0,2.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,2.0,3.0],
      [3.0,2.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,2.0,3.0],
      [3.0,2.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,2.0,3.0],
      [3.0,2.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,3.0,3.0,3.0,3.0,2.0,3.0],
      [3.0,2.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,3.0,3.0,3.0,3.0,3.0,3.0],
      [3.0,2.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,3.0,3.0,3.0,3.0,3.0,3.0],
      [3.0,2.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,3.0,3.0,3.0,3.0,3.0,3.0],
      [3.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,3.0,3.0,3.0,3.0,3.0,3.0],
      [3.0,3.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,3.0,2.0,3.0,3.0,3.0,3.0],
      [3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,1.0,1.0,1.0,0.0]])
    raw_orography_in = np.array([
      [3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0],
      [3.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,3.0],
      [3.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,3.0],
      [3.0,2.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,2.0,3.0],
      [3.0,2.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,2.0,3.0],
      [3.0,2.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,2.0,3.0],
      [3.0,2.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,2.0,3.0],
      [3.0,2.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,2.0,3.0],
      [3.0,2.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,2.0,3.0],
      [3.0,2.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,2.0,3.0],
      [3.0,2.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,2.0,3.0],
      [3.0,2.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,2.0,3.0],
      [3.0,2.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,2.0,3.0],
      [3.0,2.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,3.0,3.0,3.0,3.0,2.0,3.0],
      [3.0,2.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,3.0,3.0,3.0,3.0,3.0,3.0],
      [3.0,2.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,3.0,3.0,3.0,3.0,3.0,3.0],
      [3.0,2.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,3.0,3.0,3.0,3.0,3.0,3.0],
      [3.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,3.0,3.0,3.0,3.0,3.0,3.0],
      [3.0,3.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,3.0,2.0,3.0,3.0,3.0,3.0],
      [3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,1.0,1.0,1.0,0.0]])
    minima_in = np.array([
        [False,False,False,False,False,False,False,False,False,False,
               False,False,False,False,False,False,False,False,False,False],
        [False,False,False,False,False,False,False,False,False,False,
               False,False,False,False,False,False,False,False,False,False],
        [False,False,False,False,False,False,False,False,False,False,
               False,False,False,False,False,False,False,False,False,False],
        [False,False,False,False,False,False,False,False,False,False,
               False,False,False,False,False,False,False,False,False,False],
        [False,False,False,False,False,False,False,False,False,False,
               False,False,False,False,False,False,False,False,False,False],
        [False,False,False,False,False,False,False,False,False,False,
               False,False,False,False,False,False,False,False,False,False],
        [False,False,False,False,False,False,False,False,False,False,
               False,False,False,False,False,False,False,False,False,False],
        [False,False,False,False,False,False,False,False,False,False,
               False,False,False,False,False,False,False,False,False,False],
        [False,False,False,False,False,False,False,False,False,False,
               False,False,False,False,False,False,False,False,False,False],
        [False,False,False,False,False,False,False,False,False,False,
               True ,False,False,False,False,False,False,False,False,False],
        [False,False,False,False,False,False,False,False,False,False,
               False,False,False,False,False,False,False,False,False,False],
        [False,False,False,False,False,False,False,False,False,False,
               False,False,False,False,False,False,False,False,False,False],
        [False,False,False,False,False,False,False,False,False,False,
               False,False,False,False,False,False,False,False,False,False],
        [False,False,False,False,False,False,False,False,False,False,
               False,False,False,False,False,False,False,False,False,False],
        [False,False,False,False,False,False,False,False,False,False,
               False,False,False,False,False,False,False,False,False,False],
        [False,False,False,False,False,False,False,False,False,False,
               False,False,False,False,False,False,False,False,False,False],
        [False,False,False,False,False,False,False,False,False,False,
               False,False,False,False,False,False,False,False,False,False],
        [False,False,False,False,False,False,False,False,False,False,
               False,False,False,False,False,False,False,False,False,False],
        [False,False,False,False,False,False,False,False,False,False,
               False,False,False,False,False,False,False,False,False,False],
        [False,False,False,False,False,False,False,False,False,False,
               False,False,False,False,False,False,False,False,False,False]])
    prior_fine_rdirs_in = np.array([
      [7,7,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1],
      [3,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,4],
      [6,6,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3],
      [6,6,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,4],
      [6,6,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,4],
      [6,6,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,4],
      [6,6,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,4],
      [6,6,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,4],
      [6,6,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,4],
      [6,6,6,6,6,6,6,6,6,6,5,4,4,4,4,4,4,4,4,4],
      [6,6,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,4],
      [6,6,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,4],
      [6,6,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,4],
      [6,6,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,4],
      [6,6,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,4],
      [6,6,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,4],
      [6,6,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,4],
      [6,9,8,8,8,8,8,8,8,8,8,8,8,7,3,7,2,2,2,2],
      [8,8,8,8,8,8,8,8,8,8,8,8,8,8,7,3,2,2,2,2],
      [8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,7,6,6,6,0]])
    prior_fine_catchments_in = np.array([
      [2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1],
      [2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2],
      [2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2],
      [2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2],
      [2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2],
      [2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2],
      [2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2],
      [2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2],
      [2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2],
      [2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2],
      [2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2],
      [2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2],
      [2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2],
      [2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2],
      [2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2],
      [2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2],
      [2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2],
      [2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,2,1,1,1,1],
      [2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,1,1,1],
      [2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,1,0]])
    cell_areas_in = np.full((20,20),1.0)
    landsea_in = np.full((20,20),0,dtype=np.int32)
    landsea_in[19,19] = 1
    output,alg = \
      LatLonEvaluateBasin.evaluate_basins(landsea_in,
                                          minima_in,
                                          raw_orography_in,
                                          corrected_orography_in,
                                          cell_areas_in,
                                          prior_fine_rdirs_in,
                                          prior_fine_catchments_in,
                                          coarse_catchment_nums_in,
                                          return_algorithm_object=True)
    expected_lake_mask = np.array([
       [False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False,
        False, False],
       [False,  True,  True,  True,  True,  True,  True,  True,  True,
         True,  True,  True,  True,  True,  True,  True,  True,  True,
         True, False],
       [False,  True,  True,  True,  True,  True,  True,  True,  True,
         True,  True,  True,  True,  True,  True,  True,  True,  True,
         True, False],
       [False,  True,  True,  True,  True,  True,  True,  True,  True,
         True,  True,  True,  True,  True,  True,  True,  True,  True,
         True, False],
       [False,  True,  True,  True,  True,  True,  True,  True,  True,
         True,  True,  True,  True,  True,  True,  True,  True,  True,
         True, False],
       [False,  True,  True,  True,  True,  True,  True,  True,  True,
         True,  True,  True,  True,  True,  True,  True,  True,  True,
         True, False],
       [False,  True,  True,  True,  True,  True,  True,  True,  True,
         True,  True,  True,  True,  True,  True,  True,  True,  True,
         True, False],
       [False,  True,  True,  True,  True,  True,  True,  True,  True,
         True,  True,  True,  True,  True,  True,  True,  True,  True,
         True, False],
       [False,  True,  True,  True,  True,  True,  True,  True,  True,
         True,  True,  True,  True,  True,  True,  True,  True,  True,
         True, False],
       [False,  True,  True,  True,  True,  True,  True,  True,  True,
         True,  True,  True,  True,  True,  True,  True,  True,  True,
         True, False],
       [False,  True,  True,  True,  True,  True,  True,  True,  True,
         True,  True,  True,  True,  True,  True,  True,  True,  True,
         True, False],
       [False,  True,  True,  True,  True,  True,  True,  True,  True,
         True,  True,  True,  True,  True,  True,  True,  True,  True,
         True, False],
       [False,  True,  True,  True,  True,  True,  True,  True,  True,
         True,  True,  True,  True,  True,  True,  True,  True,  True,
         True, False],
       [False,  True,  True,  True,  True,  True,  True,  True,  True,
         True,  True,  True,  True,  True, False, False, False, False,
         True, False],
       [False,  True,  True,  True,  True,  True,  True,  True,  True,
         True,  True,  True,  True,  True, False, False, False, False,
        False, False],
       [False,  True,  True,  True,  True,  True,  True,  True,  True,
         True,  True,  True,  True,  True, False, False, False, False,
        False, False],
       [False,  True,  True,  True,  True,  True,  True,  True,  True,
         True,  True,  True,  True,  True, False, False, False, False,
        False, False],
       [False,  True,  True,  True,  True,  True,  True,  True,  True,
         True,  True,  True,  True,  True, False, False, False, False,
        False, False],
       [False, False,  True,  True,  True,  True,  True,  True,  True,
         True,  True,  True,  True,  True, False, False, False, False,
        False, False],
       [False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False,
        False, False]])
    expected_lakes_as_array = \
      [1.0, 1481.0, 1.0, -1.0, 0.0, 10.0, 11.0, 294.0, 10.0, 11.0, 1.0, 0.0, 1.0, 11.0, 12.0,
       1.0, 0.0, 1.0, 9.0, 12.0, 1.0, 0.0, 1.0, 10.0, 10.0, 1.0, 0.0, 1.0, 12.0, 11.0,
       1.0, 0.0, 1.0, 11.0, 10.0, 1.0, 0.0, 1.0, 8.0, 12.0, 1.0, 0.0, 1.0, 11.0, 9.0,
       1.0, 0.0, 1.0, 9.0, 9.0, 1.0, 0.0, 1.0, 12.0, 10.0, 1.0, 0.0, 1.0, 12.0, 9.0,
       1.0, 0.0, 1.0, 7.0, 11.0, 1.0, 0.0, 1.0, 10.0, 8.0, 1.0, 0.0, 1.0, 8.0, 8.0,
       1.0, 0.0, 1.0, 13.0, 9.0, 1.0, 0.0, 1.0, 13.0, 8.0, 1.0, 0.0, 1.0, 6.0, 10.0,
       1.0, 0.0, 1.0, 10.0, 7.0, 1.0, 0.0, 1.0, 9.0, 7.0, 1.0, 0.0, 1.0, 7.0, 7.0,
       1.0, 0.0, 1.0, 14.0, 8.0, 1.0, 0.0, 1.0, 12.0, 7.0, 1.0, 0.0, 1.0, 5.0, 9.0,
       1.0, 0.0, 1.0, 9.0, 6.0, 1.0, 0.0, 1.0, 8.0, 6.0, 1.0, 0.0, 1.0, 6.0, 6.0,
       1.0, 0.0, 1.0, 15.0, 7.0, 1.0, 0.0, 1.0, 12.0, 6.0, 1.0, 0.0, 1.0, 4.0, 8.0,
       1.0, 0.0, 1.0, 8.0, 5.0, 1.0, 0.0, 1.0, 7.0, 5.0, 1.0, 0.0, 1.0, 5.0, 5.0,
       1.0, 0.0, 1.0, 14.0, 6.0, 1.0, 0.0, 1.0, 12.0, 5.0, 1.0, 0.0, 1.0, 11.0, 5.0,
       1.0, 0.0, 1.0, 13.0, 5.0, 1.0, 0.0, 1.0, 7.0, 4.0, 1.0, 0.0, 1.0, 6.0, 4.0,
       1.0, 0.0, 1.0, 4.0, 4.0, 1.0, 0.0, 1.0, 14.0, 5.0, 1.0, 0.0, 1.0, 11.0, 4.0,
       1.0, 0.0, 1.0, 10.0, 4.0, 1.0, 0.0, 1.0, 14.0, 4.0, 1.0, 0.0, 1.0, 6.0, 3.0,
       1.0, 0.0, 1.0, 5.0, 3.0, 1.0, 0.0, 1.0, 15.0, 4.0, 1.0, 0.0, 1.0, 10.0, 3.0,
       1.0, 0.0, 1.0, 9.0, 3.0, 1.0, 0.0, 1.0, 13.0, 3.0, 1.0, 0.0, 1.0, 11.0, 7.0,
       1.0, 0.0, 1.0, 15.0, 6.0, 1.0, 0.0, 1.0, 16.0, 6.0, 1.0, 0.0, 1.0, 16.0, 3.0,
       1.0, 0.0, 1.0, 8.0, 11.0, 1.0, 0.0, 1.0, 7.0, 10.0, 1.0, 0.0, 1.0, 16.0, 7.0,
       1.0, 0.0, 1.0, 16.0, 8.0, 1.0, 0.0, 1.0, 17.0, 5.0, 1.0, 0.0, 1.0, 6.0, 11.0,
       1.0, 0.0, 1.0, 6.0, 5.0, 1.0, 0.0, 1.0, 5.0, 6.0, 1.0, 0.0, 1.0, 17.0, 8.0,
       1.0, 0.0, 1.0, 16.0, 9.0, 1.0, 0.0, 1.0, 5.0, 12.0, 1.0, 0.0, 1.0, 11.0, 13.0,
       1.0, 0.0, 1.0, 8.0, 13.0, 1.0, 0.0, 1.0, 6.0, 12.0, 1.0, 0.0, 1.0, 5.0, 7.0,
       1.0, 0.0, 1.0, 9.0, 5.0, 1.0, 0.0, 1.0, 15.0, 10.0, 1.0, 0.0, 1.0, 4.0, 11.0,
       1.0, 0.0, 1.0, 10.0, 14.0, 1.0, 0.0, 1.0, 7.0, 14.0, 1.0, 0.0, 1.0, 8.0, 14.0,
       1.0, 0.0, 1.0, 9.0, 14.0, 1.0, 0.0, 1.0, 6.0, 15.0, 1.0, 0.0, 1.0, 6.0, 14.0,
       1.0, 0.0, 1.0, 11.0, 14.0, 1.0, 0.0, 1.0, 6.0, 16.0, 1.0, 0.0, 1.0, 5.0, 16.0,
       1.0, 0.0, 1.0, 5.0, 15.0, 1.0, 0.0, 1.0, 5.0, 14.0, 1.0, 0.0, 1.0, 12.0, 15.0,
       1.0, 0.0, 1.0, 5.0, 17.0, 1.0, 0.0, 1.0, 4.0, 17.0, 1.0, 0.0, 1.0, 4.0, 15.0,
       1.0, 0.0, 1.0, 13.0, 15.0, 1.0, 0.0, 1.0, 13.0, 14.0, 1.0, 0.0, 1.0, 6.0, 18.0,
       1.0, 0.0, 1.0, 5.0, 18.0, 1.0, 0.0, 1.0, 4.0, 18.0, 1.0, 0.0, 1.0, 4.0, 14.0,
       1.0, 0.0, 1.0, 4.0, 16.0, 1.0, 0.0, 1.0, 12.0, 16.0, 1.0, 0.0, 1.0, 11.0, 16.0,
       1.0, 0.0, 1.0, 13.0, 13.0, 1.0, 0.0, 1.0, 7.0, 18.0, 1.0, 0.0, 1.0, 13.0, 16.0,
       1.0, 0.0, 1.0, 7.0, 17.0, 1.0, 0.0, 1.0, 6.0, 17.0, 1.0, 0.0, 1.0, 11.0, 17.0,
       1.0, 0.0, 1.0, 10.0, 16.0, 1.0, 0.0, 1.0, 14.0, 12.0, 1.0, 0.0, 1.0, 8.0, 17.0,
       1.0, 0.0, 1.0, 8.0, 16.0, 1.0, 0.0, 1.0, 8.0, 18.0, 1.0, 0.0, 1.0, 10.0, 18.0,
       1.0, 0.0, 1.0, 9.0, 16.0, 1.0, 0.0, 1.0, 15.0, 12.0, 1.0, 0.0, 1.0, 9.0, 18.0,
       1.0, 0.0, 1.0, 15.0, 13.0, 1.0, 0.0, 1.0, 14.0, 11.0, 1.0, 0.0, 1.0, 9.0, 15.0,
       1.0, 0.0, 1.0, 8.0, 15.0, 1.0, 0.0, 1.0, 7.0, 15.0, 1.0, 0.0, 1.0, 7.0, 16.0,
       1.0, 0.0, 1.0, 16.0, 12.0, 1.0, 0.0, 1.0, 16.0, 13.0, 1.0, 0.0, 1.0, 15.0, 14.0,
       1.0, 0.0, 1.0, 16.0, 14.0, 1.0, 0.0, 1.0, 9.0, 17.0, 1.0, 0.0, 1.0, 11.0, 18.0,
       1.0, 0.0, 1.0, 12.0, 18.0, 1.0, 0.0, 1.0, 17.0, 11.0, 1.0, 0.0, 1.0, 17.0, 14.0,
       1.0, 0.0, 1.0, 11.0, 15.0, 1.0, 0.0, 1.0, 10.0, 15.0, 1.0, 0.0, 1.0, 9.0, 8.0,
       1.0, 0.0, 1.0, 10.0, 5.0, 1.0, 0.0, 1.0, 13.0, 18.0, 1.0, 0.0, 1.0, 5.0, 8.0,
       1.0, 0.0, 1.0, 15.0, 11.0, 1.0, 0.0, 1.0, 16.0, 11.0, 1.0, 0.0, 1.0, 9.0, 13.0,
       1.0, 0.0, 1.0, 8.0, 9.0, 1.0, 0.0, 1.0, 4.0, 9.0, 1.0, 0.0, 1.0, 12.0, 14.0,
       1.0, 0.0, 1.0, 4.0, 12.0, 1.0, 0.0, 1.0, 17.0, 12.0, 1.0, 0.0, 1.0, 17.0, 13.0,
       1.0, 0.0, 1.0, 10.0, 17.0, 1.0, 0.0, 1.0, 12.0, 17.0, 1.0, 0.0, 1.0, 4.0, 10.0,
       1.0, 0.0, 1.0, 4.0, 13.0, 1.0, 0.0, 1.0, 5.0, 13.0, 1.0, 0.0, 1.0, 14.0, 13.0,
       1.0, 0.0, 1.0, 8.0, 10.0, 1.0, 0.0, 1.0, 13.0, 6.0, 1.0, 0.0, 1.0, 6.0, 13.0,
       1.0, 0.0, 1.0, 16.0, 10.0, 1.0, 0.0, 1.0, 15.0, 8.0, 1.0, 0.0, 1.0, 17.0, 10.0,
       1.0, 0.0, 1.0, 9.0, 10.0, 1.0, 0.0, 1.0, 10.0, 13.0, 1.0, 0.0, 1.0, 11.0, 11.0,
       1.0, 0.0, 1.0, 11.0, 8.0, 1.0, 0.0, 1.0, 15.0, 9.0, 1.0, 0.0, 1.0, 17.0, 9.0,
       1.0, 0.0, 1.0, 7.0, 6.0, 1.0, 0.0, 1.0, 17.0, 3.0, 1.0, 0.0, 1.0, 17.0, 4.0,
       1.0, 0.0, 1.0, 12.0, 8.0, 1.0, 0.0, 1.0, 6.0, 7.0, 1.0, 0.0, 1.0, 17.0, 6.0,
       1.0, 0.0, 1.0, 17.0, 7.0, 1.0, 0.0, 1.0, 6.0, 8.0, 1.0, 0.0, 1.0, 10.0, 12.0,
       1.0, 0.0, 1.0, 7.0, 12.0, 1.0, 0.0, 1.0, 10.0, 6.0, 1.0, 0.0, 1.0, 16.0, 4.0,
       1.0, 0.0, 1.0, 16.0, 5.0, 1.0, 0.0, 1.0, 11.0, 6.0, 1.0, 0.0, 1.0, 7.0, 13.0,
       1.0, 0.0, 1.0, 6.0, 9.0, 1.0, 0.0, 1.0, 14.0, 3.0, 1.0, 0.0, 1.0, 15.0, 3.0,
       1.0, 0.0, 1.0, 5.0, 10.0, 1.0, 0.0, 1.0, 11.0, 3.0, 1.0, 0.0, 1.0, 12.0, 3.0,
       1.0, 0.0, 1.0, 12.0, 12.0, 1.0, 0.0, 1.0, 9.0, 11.0, 1.0, 0.0, 1.0, 13.0, 10.0,
       1.0, 0.0, 1.0, 5.0, 11.0, 1.0, 0.0, 1.0, 4.0, 3.0, 1.0, 0.0, 1.0, 13.0, 7.0,
       1.0, 0.0, 1.0, 7.0, 3.0, 1.0, 0.0, 1.0, 13.0, 11.0, 1.0, 0.0, 1.0, 14.0, 7.0,
       1.0, 0.0, 1.0, 8.0, 3.0, 1.0, 0.0, 1.0, 12.0, 4.0, 1.0, 0.0, 1.0, 14.0, 9.0,
       1.0, 0.0, 1.0, 13.0, 4.0, 1.0, 0.0, 1.0, 15.0, 5.0, 1.0, 0.0, 1.0, 12.0, 13.0,
       1.0, 0.0, 1.0, 13.0, 12.0, 1.0, 0.0, 1.0, 14.0, 10.0, 1.0, 0.0, 1.0, 5.0, 4.0,
       1.0, 0.0, 1.0, 4.0, 5.0, 1.0, 0.0, 1.0, 8.0, 7.0, 1.0, 0.0, 1.0, 4.0, 6.0,
       1.0, 0.0, 1.0, 8.0, 4.0, 1.0, 0.0, 1.0, 10.0, 9.0, 1.0, 0.0, 1.0, 7.0, 8.0,
       1.0, 0.0, 1.0, 9.0, 4.0, 1.0, 0.0, 1.0, 4.0, 7.0, 1.0, 0.0, 1.0, 7.0, 9.0,
       1.0, 0.0, 1.0, 13.0, 17.0, 1.0, 0.0, 1.0, 14.0, 14.0, 1.0, 208.0, 2.0, 18.0, 6.0,
       1.0, 208.0, 2.0, 17.0, 2.0, 1.0, 208.0, 2.0, 3.0, 9.0, 1.0, 208.0, 2.0, 19.0, 7.0,
       1.0, 208.0, 2.0, 3.0, 18.0, 1.0, 208.0, 2.0, 3.0, 16.0, 1.0, 208.0, 2.0, 9.0, 19.0,
       1.0, 208.0, 2.0, 3.0, 4.0, 1.0, 208.0, 2.0, 3.0, 7.0, 1.0, 208.0, 2.0, 2.0, 8.0,
       1.0, 208.0, 2.0, 2.0, 17.0, 1.0, 208.0, 2.0, 2.0, 15.0, 1.0, 208.0, 2.0, 3.0, 19.0,
       1.0, 208.0, 2.0, 3.0, 12.0, 1.0, 208.0, 2.0, 2.0, 3.0, 1.0, 208.0, 2.0, 3.0, 6.0,
       1.0, 208.0, 2.0, 4.0, 2.0, 1.0, 208.0, 2.0, 4.0, 19.0, 1.0, 208.0, 2.0, 18.0, 8.0,
       1.0, 208.0, 2.0, 3.0, 2.0, 1.0, 208.0, 2.0, 2.0, 11.0, 1.0, 208.0, 2.0, 2.0, 2.0,
       1.0, 208.0, 2.0, 7.0, 19.0, 1.0, 208.0, 2.0, 11.0, 2.0, 1.0, 208.0, 2.0, 19.0, 9.0,
       1.0, 208.0, 2.0, 19.0, 5.0, 1.0, 208.0, 2.0, 6.0, 19.0, 1.0, 208.0, 2.0, 3.0, 14.0,
       1.0, 208.0, 2.0, 18.0, 14.0, 1.0, 208.0, 2.0, 13.0, 2.0, 1.0, 208.0, 2.0, 18.0, 12.0,
       1.0, 208.0, 2.0, 14.0, 2.0, 1.0, 208.0, 2.0, 19.0, 4.0, 1.0, 208.0, 2.0, 19.0, 13.0,
       1.0, 208.0, 2.0, 19.0, 11.0, 1.0, 208.0, 2.0, 18.0, 13.0, 1.0, 208.0, 2.0, 19.0, 3.0,
       1.0, 208.0, 2.0, 10.0, 19.0, 1.0, 208.0, 2.0, 16.0, 2.0, 1.0, 208.0, 2.0, 19.0, 12.0,
       1.0, 208.0, 2.0, 18.0, 9.0, 1.0, 208.0, 2.0, 19.0, 14.0, 1.0, 208.0, 2.0, 19.0, 10.0,
       1.0, 208.0, 2.0, 3.0, 8.0, 1.0, 208.0, 2.0, 3.0, 15.0, 1.0, 208.0, 2.0, 11.0, 19.0,
       1.0, 208.0, 2.0, 3.0, 13.0, 1.0, 208.0, 2.0, 3.0, 3.0, 1.0, 208.0, 2.0, 18.0, 10.0,
       1.0, 208.0, 2.0, 14.0, 19.0, 1.0, 208.0, 2.0, 3.0, 11.0, 1.0, 208.0, 2.0, 3.0, 10.0,
       1.0, 208.0, 2.0, 19.0, 6.0, 1.0, 208.0, 2.0, 12.0, 19.0, 1.0, 208.0, 2.0, 2.0, 12.0,
       1.0, 208.0, 2.0, 2.0, 13.0, 1.0, 208.0, 2.0, 15.0, 2.0, 1.0, 208.0, 2.0, 13.0, 19.0,
       1.0, 208.0, 2.0, 18.0, 7.0, 1.0, 208.0, 2.0, 8.0, 19.0, 1.0, 208.0, 2.0, 2.0, 14.0,
       1.0, 208.0, 2.0, 7.0, 2.0, 1.0, 208.0, 2.0, 18.0, 2.0, 1.0, 208.0, 2.0, 2.0, 6.0,
       1.0, 208.0, 2.0, 8.0, 2.0, 1.0, 208.0, 2.0, 18.0, 5.0, 1.0, 208.0, 2.0, 5.0, 2.0,
       1.0, 208.0, 2.0, 3.0, 5.0, 1.0, 208.0, 2.0, 2.0, 7.0, 1.0, 208.0, 2.0, 2.0, 4.0,
       1.0, 208.0, 2.0, 18.0, 4.0, 1.0, 208.0, 2.0, 2.0, 5.0, 1.0, 208.0, 2.0, 9.0, 2.0,
       1.0, 208.0, 2.0, 3.0, 17.0, 1.0, 208.0, 2.0, 2.0, 16.0, 1.0, 208.0, 2.0, 2.0, 19.0,
       1.0, 208.0, 2.0, 2.0, 18.0, 1.0, 208.0, 2.0, 5.0, 19.0, 1.0, 208.0, 2.0, 18.0, 11.0,
       1.0, 208.0, 2.0, 6.0, 2.0, 1.0, 208.0, 2.0, 19.0, 8.0, 1.0, 208.0, 2.0, 2.0, 9.0,
       1.0, 208.0, 2.0, 18.0, 3.0, 1.0, 208.0, 2.0, 10.0, 2.0, 1.0, 208.0, 2.0, 2.0, 10.0,
       1.0, 208.0, 2.0, 12.0, 2.0, 1.0, 502.0, 3.0, 1.0, -1.0, 4.0, 4.0, 0.0]
    self.assertEqual(output["number_of_lakes"],1)
    self.assertEqual(output["lakes_as_array"],expected_lakes_as_array)
    np.testing.assert_array_equal(output["lake_mask"],expected_lake_mask)

  def testBasinEvaluationOne(self):
    coarse_catchment_nums_in = np.array([[3,3,7,2],
                                         [3,6,7,2],
                                         [5,4,1,2],
                                         [5,4,1,1]])
    prior_coarse_rdirs_in = np.array([[5.0,5.0,5.0,5.0],
                                      [5.0,5.0,5.0,5.0],
                                      [5.0,5.0,5.0,5.0],
                                      [5.0,0.0,5.0,0.0]])
    corrected_orography_in = np.array([
     [10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0],
     [10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0, 2.0],
     [1.0, 8.0, 3.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0, 6.0, 6.0, 5.0, 6.0,10.0,10.0,10.0, 1.0],
     [10.0, 3.0, 3.0,10.0,10.0, 7.0, 3.0,10.0,10.0,10.0,10.0, 6.0, 3.0, 3.0, 4.0, 5.0,10.0,10.0,10.0,10.0],
     [10.0, 3.0, 3.0,10.0,10.0, 3.0, 3.0, 4.0, 3.0,10.0,10.0,10.0, 2.0, 3.0, 3.0, 4.0, 5.0,10.0,10.0,10.0],
     [10.0, 3.0, 3.0, 6.0, 2.0, 1.0,10.0, 2.0, 3.0, 5.0, 3.0, 2.0, 3.0, 2.0, 3.0, 3.0, 4.0, 5.0,10.0,10.0],
     [4.0, 4.0, 3.0,10.0, 2.0, 1.0, 2.0, 2.0, 3.0,10.0, 3.0, 2.0, 2.0, 3.0, 3.0, 3.0, 4.0, 5.0,10.0,10.0],
     [10.0, 4.0, 4.0,10.0,10.0, 2.0,10.0, 4.0,10.0,10.0,10.0, 3.0, 2.0, 3.0, 2.0, 3.0, 5.0, 9.0,10.0,10.0],
     [10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0, 5.0, 3.0, 3.0, 3.0, 4.0, 5.0,10.0, 8.0,10.0],
     [10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0, 5.0, 5.0,10.0,10.0,10.0,10.0, 7.0,10.0],
     [10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0, 6.0,10.0],
     [10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0, 5.0,10.0],
     [10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0, 4.0,10.0],
     [10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0, 2.0, 2.0, 3.0, 3.0,10.0],
     [10.0,10.0,10.0, 3.0, 3.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0, 2.0, 3.0, 3.0,10.0,10.0],
     [10.0,10.0,10.0, 2.0, 3.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0, 4.0,10.0,10.0,10.0,10.0],
     [10.0,10.0,10.0, 3.0, 3.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0, 3.0,10.0,10.0,10.0,10.0],
     [10.0,10.0,10.0, 2.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0, 2.0,10.0,10.0,10.0,10.0],
     [10.0,10.0,10.0, 2.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0, 1.0,10.0,10.0,10.0,10.0],
     [10.0,10.0,10.0, 1.0, 0.2, 0.1, 0.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0, 0.0,10.0,10.0,10.0,10.0]])

    raw_orography_in = np.array([
     [10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0],
     [10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0, 2.0],
     [1.0, 8.0, 3.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0, 6.0, 6.0, 5.0, 6.0,10.0,10.0,10.0, 1.0],
     [10.0, 3.0, 3.0,10.0,10.0, 8.0, 7.0,10.0,10.0,10.0,10.0, 6.0, 3.0, 3.0, 4.0, 5.0,10.0,10.0,10.0,10.0],
     [10.0, 3.0, 3.0,10.0,10.0, 3.0, 3.0, 4.0, 3.0,10.0,10.0,10.0, 2.0, 3.0, 3.0, 4.0, 5.0,10.0,10.0,10.0],
     [10.0, 3.0, 3.0, 6.0, 2.0, 1.0,10.0, 2.0, 3.0,10.0, 3.0, 2.0, 3.0, 2.0, 3.0, 3.0, 4.0, 5.0,10.0,10.0],
     [4.0, 4.0, 3.0,10.0, 2.0, 1.0, 2.0, 2.0, 3.0,10.0, 3.0, 2.0, 2.0, 3.0, 3.0, 3.0, 4.0, 5.0,10.0,10.0],
     [10.0, 4.0, 4.0,10.0,10.0, 2.0,10.0, 4.0,10.0,10.0,10.0, 3.0, 2.0, 3.0, 2.0, 3.0, 5.0, 9.0,10.0,10.0],
     [10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0, 5.0, 3.0, 3.0, 3.0, 4.0, 5.0,10.0, 8.0,10.0],
     [10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0, 5.0, 5.0,10.0,10.0,10.0,10.0, 7.0,10.0],
     [10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0, 6.0,10.0],
     [10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0, 5.0,10.0],
     [10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0, 4.0,10.0],
     [10.0,10.0,10.0,10.0, 3.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0, 2.0, 2.0, 3.0, 3.0,10.0],
     [10.0,10.0,10.0, 3.0, 3.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0, 2.0, 3.0, 3.0,10.0,10.0],
     [10.0,10.0,10.0, 2.0, 3.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0, 4.0,10.0,10.0,10.0,10.0],
     [10.0,10.0,10.0, 3.0, 3.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0, 3.0,10.0,10.0,10.0,10.0],
     [10.0,10.0,10.0, 2.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0, 2.0,10.0,10.0,10.0,10.0],
     [10.0,10.0,10.0, 2.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0, 1.0,10.0,10.0,10.0,10.0],
     [10.0,10.0,10.0, 1.0, 0.2, 0.1, 0.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0, 0.0,10.0,10.0,10.0,10.0]])

    minima_in = np.array([
    [False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,
      False,False,False,False],
    [False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,
      False,False,False,False],
    [True, False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,
      False,False,False,False],
    [False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,
      False,False,False,False],
    [False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,
      False,False,False,False],
    [False,False,False,False,False,False,False,False,False,False,False,False,False,True, False,False,
      False,False,False,False],
    [False,False,False,False,False,True, False,False,False,False,False,False,False,False,False,False,
      False,False,False,False],
    [False,False,False,False,False,False,False,False,False,False,False,False,False,False,True, False,
      False,False,False,False],
    [False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,
      False,False,False,False],
    [False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,
      False,False,False,False],
    [False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,
      False,False,False,False],
    [False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,
      False,False,False,False],
    [False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,
      False,False,False,False],
    [False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,True,
      False,False,False,False],
    [False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,
      False,False,False,False],
    [False,False,False,True, False,False,False,False,False,False,False,False,False,False,False,False,
      False,False,False,False],
    [False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,
      False,False,False,False],
    [False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,
      False,False,False,False],
    [False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,
      False,False,False,False],
    [False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,
      False,False,False,False]])
    prior_fine_rdirs_in = np.array([
      [1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,3.0,3.0,3.0,3.0,3.0,3.0,2.0,1.0,1.0,3.0,3.0,2.0],
      [2.0,1.0,2.0,1.0,1.0,2.0,1.0,1.0,1.0,3.0,3.0,3.0,2.0,3.0,2.0,1.0,1.0,3.0,3.0,3.0],
      [5.0,4.0,1.0,1.0,3.0,2.0,1.0,1.0,1.0,1.0,3.0,3.0,2.0,1.0,1.0,1.0,1.0,6.0,6.0,6.0],
      [8.0,7.0,4.0,4.0,3.0,2.0,1.0,1.0,2.0,1.0,6.0,3.0,2.0,1.0,1.0,1.0,1.0,1.0,9.0,9.0],
      [9.0,8.0,7.0,3.0,3.0,2.0,1.0,2.0,1.0,1.0,3.0,6.0,3.0,2.0,1.0,1.0,1.0,1.0,1.0,9.0],
      [9.0,8.0,7.0,3.0,3.0,2.0,1.0,1.0,1.0,1.0,3.0,3.0,6.0,5.0,4.0,4.0,1.0,1.0,1.0,3.0],
      [9.0,8.0,7.0,6.0,6.0,5.0,4.0,4.0,4.0,4.0,6.0,6.0,9.0,8.0,7.0,1.0,1.0,4.0,4.0,6.0],
      [9.0,9.0,8.0,9.0,9.0,8.0,7.0,7.0,7.0,7.0,9.0,9.0,8.0,7.0,5.0,4.0,4.0,7.0,7.0,9.0],
      [9.0,9.0,8.0,7.0,9.0,8.0,7.0,8.0,7.0,7.0,9.0,9.0,8.0,7.0,8.0,7.0,7.0,7.0,2.0,1.0],
      [9.0,9.0,8.0,9.0,9.0,8.0,7.0,7.0,7.0,9.0,9.0,9.0,8.0,7.0,7.0,7.0,7.0,7.0,2.0,1.0],
      [1.0,1.0,9.0,9.0,9.0,8.0,7.0,7.0,7.0,9.0,9.0,9.0,8.0,7.0,7.0,7.0,7.0,3.0,2.0,1.0],
      [1.0,3.0,3.0,2.0,1.0,1.0,1.0,1.0,9.0,9.0,9.0,9.0,8.0,3.0,3.0,2.0,1.0,3.0,2.0,1.0],
      [1.0,3.0,3.0,2.0,1.0,1.0,1.0,1.0,1.0,9.0,9.0,9.0,3.0,3.0,3.0,2.0,1.0,1.0,1.0,1.0],
      [4.0,3.0,3.0,2.0,1.0,1.0,1.0,1.0,1.0,9.0,9.0,3.0,6.0,6.0,6.0,5.0,4.0,4.0,4.0,4.0],
      [7.0,3.0,3.0,2.0,1.0,1.0,1.0,1.0,1.0,1.0,3.0,3.0,3.0,9.0,9.0,8.0,7.0,7.0,7.0,7.0],
      [7.0,3.0,6.0,5.0,4.0,1.0,1.0,1.0,1.0,1.0,3.0,3.0,3.0,3.0,9.0,8.0,7.0,7.0,7.0,7.0],
      [3.0,3.0,3.0,2.0,2.0,4.0,4.0,4.0,4.0,4.0,3.0,3.0,3.0,3.0,3.0,2.0,1.0,1.0,7.0,7.0],
      [3.0,3.0,3.0,2.0,2.0,7.0,7.0,7.0,7.0,7.0,3.0,3.0,3.0,3.0,3.0,2.0,1.0,1.0,1.0,7.0],
      [3.0,3.0,3.0,2.0,2.0,2.0,2.0,7.0,7.0,7.0,3.0,3.0,3.0,3.0,3.0,2.0,1.0,1.0,1.0,3.0],
      [6.0,6.0,6.0,6.0,6.0,6.0,0.0,7.0,7.0,7.0,6.0,6.0,6.0,6.0,6.0,0.0,4.0,4.0,4.0,6.0]])
    prior_fine_catchments_in = np.array([
      [11,11,11,11,11,11,13,13,12,12,12,12,12,12,12,12,12,11,11,11],
      [11,11,11,11,11,13,13,13,13,12,12,12,12,12,12,12,12,11,11,11],
      [11,11,11,11,13,13,13,13,13,13,12,12,12,12,12,12,12,11,11,11],
      [11,11,11,11,13,13,13,13,13,13,12,12,12,12,12,12,12,12,11,11],
      [11,11,11,13,13,13,13,13,13,13,12,12,12,12,12,12,12,14,14,11],
      [11,11,11,13,13,13,13,13,13,13,12,12,12,12,12,12,14,14,14,11],
      [11,11,11,13,13,13,13,13,13,13,12,12,12,12,12,14,14,14,14,11],
      [11,11,11,13,13,13,13,13,13,13,12,12,12,12,14,14,14,14,14,11],
      [11,11,11,11,13,13,13,13,13,13,12,12,12,12,14,14,14,14,15,15],
      [11,11,11,13,13,13,13,13,13,12,12,12,12,12,12,14,14,14,15,15],
      [15,15,13,13,13,13,13,13,13,12,12,12,12,12,12,12,14,15,15,15],
      [15,16,16,16,16,16,16,16,12,12,12,12,12,15,15,15,15,15,15,15],
      [15,16,16,16,16,16,16,16, 4,12,12,12,15,15,15,15,15,15,15,15],
      [15,16,16,16,16,16,16, 4, 4,12,12, 9,15,15,15,15,15,15,15,15],
      [15,16,16,16,16,16, 4, 4, 4, 4,10, 9, 9,15,15,15,15,15,15,15],
      [15, 4,16,16,16, 4, 4, 4, 4, 4, 7,10, 9, 9,15,15,15,15,15,15],
      [ 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 7, 7,10, 9, 9, 9, 9, 9,15,15],
      [ 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 7, 7, 7,10, 9, 9, 9, 8, 6,15],
      [ 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 7, 7, 7, 7,10, 9, 8, 6, 6, 2],
      [ 4, 4, 4, 4, 4, 4, 0, 4, 4, 4, 7, 7, 7, 7, 7, 0, 6, 6, 6, 2]])
    landsea_in = np.zeros((20,20),dtype=np.int32)
    landsea_in[:,:] = False
    landsea_in[19,15] = True
    landsea_in[19,6] = True
    cell_areas_in = np.full((20,20),1.0)
    output,alg = \
      LatLonEvaluateBasin.evaluate_basins(landsea_in,
                                          minima_in,
                                          raw_orography_in,
                                          corrected_orography_in,
                                          cell_areas_in,
                                          prior_fine_rdirs_in,
                                          prior_fine_catchments_in,
                                          coarse_catchment_nums_in,
                                          return_algorithm_object=True)
    expected_lake_mask = np.array([
       [False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False,
        False, False],
       [False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False,
        False,  True],
       [ True,  True,  True, False, False, False, False, False, False,
        False, False, False,  True,  True,  True,  True, False, False,
        False,  True],
       [False,  True,  True, False, False,  True,  True, False, False,
        False, False,  True,  True,  True,  True,  True, False, False,
        False, False],
       [False,  True,  True, False, False,  True,  True,  True,  True,
        False, False, False,  True,  True,  True,  True,  True, False,
        False, False],
       [False,  True,  True,  True,  True,  True, False,  True,  True,
         True,  True,  True,  True,  True,  True,  True,  True,  True,
        False, False],
       [ True,  True,  True, False,  True,  True,  True,  True,  True,
        False,  True,  True,  True,  True,  True,  True,  True,  True,
        False, False],
       [False,  True,  True, False, False,  True, False,  True, False,
        False, False,  True,  True,  True,  True,  True,  True, False,
        False, False],
       [False, False, False, False, False, False, False, False, False,
        False, False,  True,  True,  True,  True,  True,  True, False,
        False, False],
       [False, False, False, False, False, False, False, False, False,
        False, False, False,  True,  True, False, False, False, False,
        False, False],
       [False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False,
        False, False],
       [False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False,
        False, False],
       [False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False,
        False, False],
       [False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False,  True,  True,  True,
         True, False],
       [False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False,  True,  True,  True,
        False, False],
       [False, False, False,  True, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False,
        False, False],
       [False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False,
        False, False],
       [False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False,
        False, False],
       [False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False,
        False, False],
       [False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False,
        False, False]])
    expected_lakes_as_array = \
    [9.0, 16.0, 1.0, -1.0, 0.0, 16.0, 4.0, 1.0, 16.0, 4.0, 1.0, 1.0, 3.0, 1.0, -1.0,
     4.0, 2.0, 0.0, 46.0, 2.0, -1.0, 0.0, 14.0, 16.0, 7.0, 14.0, 16.0, 1.0, 0.0, 2.0,
     14.0, 17.0, 1.0, 0.0, 2.0, 15.0, 16.0, 1.0, 3.0, 3.0, 15.0, 17.0, 1.0, 3.0, 3.0,
     15.0, 18.0, 1.0, 3.0, 3.0, 14.0, 18.0, 1.0, 3.0, 3.0, 14.0, 19.0, 1.0, 10.0, 4.0,
     1.0, -1.0, 4.0, 4.0, 0.0, 16.0, 3.0, 7.0, 0.0, 8.0, 15.0, 1.0, 8.0, 15.0, 1.0,
     1.0, 3.0, 1.0, 5.0, -1.0, -1.0, 1.0, 91.0, 4.0, 8.0, 0.0, 7.0, 6.0, 16.0, 7.0,
     6.0, 1.0, 0.0, 1.0, 6.0, 6.0, 1.0, 2.0, 2.0, 7.0, 5.0, 1.0, 2.0, 2.0, 7.0,
     7.0, 1.0, 2.0, 2.0, 8.0, 6.0, 1.0, 2.0, 2.0, 7.0, 8.0, 1.0, 2.0, 2.0, 6.0,
     8.0, 1.0, 2.0, 2.0, 6.0, 5.0, 1.0, 10.0, 3.0, 5.0, 6.0, 1.0, 10.0, 3.0, 5.0,
     7.0, 1.0, 10.0, 3.0, 7.0, 9.0, 1.0, 10.0, 3.0, 6.0, 9.0, 1.0, 10.0, 3.0, 4.0,
     7.0, 2.0, 10.0, 3.0, 5.0, 9.0, 1.0, 23.0, 4.0, 8.0, 8.0, 1.0, 23.0, 4.0, 5.0,
     8.0, 1.0, 38.0, 5.0, 1.0, 7.0, -1.0, -1.0, 1.0, 41.0, 5.0, 7.0, 0.0, 6.0, 14.0,
     6.0, 6.0, 14.0, 1.0, 0.0, 2.0, 7.0, 13.0, 1.0, 0.0, 2.0, 5.0, 13.0, 1.0, 0.0,
     2.0, 6.0, 12.0, 1.0, 0.0, 2.0, 8.0, 13.0, 1.0, 0.0, 2.0, 7.0, 12.0, 1.0, 6.0,
     3.0, 1.0, 3.0, -1.0, -1.0, 1.0, 86.0, 6.0, 9.0, 0.0, 3.0, 1.0, 15.0, 3.0, 1.0,
     1.0, 0.0, 1.0, 3.0, 20.0, 1.0, 2.0, 2.0, 2.0, 20.0, 1.0, 5.0, 3.0, 4.0, 2.0,
     1.0, 5.0, 3.0, 5.0, 3.0, 1.0, 5.0, 3.0, 4.0, 3.0, 1.0, 5.0, 3.0, 3.0, 3.0,
     1.0, 5.0, 3.0, 5.0, 2.0, 1.0, 5.0, 3.0, 6.0, 3.0, 1.0, 5.0, 3.0, 6.0, 2.0,
     1.0, 5.0, 3.0, 7.0, 3.0, 1.0, 16.0, 4.0, 7.0, 2.0, 1.0, 16.0, 4.0, 8.0, 3.0,
     1.0, 16.0, 4.0, 8.0, 2.0, 1.0, 16.0, 4.0, 7.0, 1.0, 1.0, 46.0, 6.0, 1.0, 8.0,
     2.0, 2.0, 0.0, 163.0, 7.0, 8.0, 2.0, 3.0, 5.0, 8.0, 15.0, 30.0, 8.0, 15.0, 1.0,
     0.0, 3.0, 8.0, 16.0, 1.0, 0.0, 3.0, 7.0, 16.0, 1.0, 0.0, 3.0, 8.0, 14.0, 1.0,
     0.0, 3.0, 9.0, 14.0, 1.0, 0.0, 3.0, 9.0, 15.0, 1.0, 0.0, 3.0, 7.0, 13.0, 1.0,
     0.0, 3.0, 6.0, 15.0, 1.0, 0.0, 3.0, 8.0, 13.0, 1.0, 0.0, 3.0, 9.0, 13.0, 1.0,
     0.0, 3.0, 7.0, 15.0, 1.0, 0.0, 3.0, 6.0, 16.0, 1.0, 0.0, 3.0, 5.0, 14.0, 1.0,
     0.0, 3.0, 6.0, 12.0, 1.0, 0.0, 3.0, 4.0, 13.0, 1.0, 0.0, 3.0, 7.0, 11.0, 1.0,
     0.0, 3.0, 6.0, 11.0, 1.0, 0.0, 3.0, 5.0, 15.0, 1.0, 0.0, 3.0, 4.0, 14.0, 1.0,
     0.0, 3.0, 5.0, 13.0, 1.0, 0.0, 3.0, 7.0, 14.0, 1.0, 0.0, 3.0, 8.0, 12.0, 1.0,
     0.0, 3.0, 7.0, 12.0, 1.0, 0.0, 3.0, 6.0, 14.0, 1.0, 0.0, 3.0, 6.0, 13.0, 1.0,
     25.0, 4.0, 6.0, 17.0, 1.0, 25.0, 4.0, 7.0, 17.0, 1.0, 25.0, 4.0, 5.0, 16.0, 1.0,
     25.0, 4.0, 4.0, 15.0, 1.0, 25.0, 4.0, 9.0, 16.0, 1.0, 55.0, 5.0, 1.0, 4.0, -1.0,
     -1.0, 1.0, 298.0, 8.0, 9.0, 2.0, 4.0, 7.0, 7.0, 6.0, 57.0, 7.0, 6.0, 1.0, 0.0,
     5.0, 7.0, 7.0, 1.0, 0.0, 5.0, 7.0, 5.0, 1.0, 0.0, 5.0, 8.0, 6.0, 1.0, 0.0,
     5.0, 6.0, 8.0, 1.0, 0.0, 5.0, 7.0, 8.0, 1.0, 0.0, 5.0, 7.0, 9.0, 1.0, 0.0,
     5.0, 6.0, 9.0, 1.0, 0.0, 5.0, 5.0, 7.0, 1.0, 0.0, 5.0, 6.0, 6.0, 1.0, 0.0,
     5.0, 6.0, 10.0, 2.0, 0.0, 5.0, 4.0, 7.0, 2.0, 0.0, 5.0, 6.0, 11.0, 1.0, 0.0,
     5.0, 5.0, 6.0, 1.0, 0.0, 5.0, 7.0, 12.0, 1.0, 0.0, 5.0, 6.0, 12.0, 1.0, 0.0,
     5.0, 8.0, 13.0, 1.0, 0.0, 5.0, 7.0, 11.0, 1.0, 0.0, 5.0, 8.0, 8.0, 1.0, 0.0,
     5.0, 6.0, 5.0, 1.0, 0.0, 5.0, 5.0, 13.0, 1.0, 0.0, 5.0, 9.0, 13.0, 1.0, 0.0,
     5.0, 9.0, 12.0, 1.0, 0.0, 5.0, 5.0, 14.0, 1.0, 0.0, 5.0, 4.0, 14.0, 1.0, 0.0,
     5.0, 4.0, 15.0, 1.0, 0.0, 5.0, 3.0, 15.0, 1.0, 0.0, 5.0, 5.0, 16.0, 1.0, 0.0,
     5.0, 4.0, 16.0, 1.0, 0.0, 5.0, 6.0, 17.0, 1.0, 0.0, 5.0, 6.0, 16.0, 1.0, 0.0,
     5.0, 5.0, 17.0, 1.0, 0.0, 5.0, 7.0, 18.0, 1.0, 0.0, 5.0, 7.0, 17.0, 1.0, 0.0,
     5.0, 7.0, 16.0, 1.0, 0.0, 5.0, 7.0, 15.0, 1.0, 0.0, 5.0, 6.0, 18.0, 1.0, 0.0,
     5.0, 8.0, 16.0, 1.0, 0.0, 5.0, 8.0, 15.0, 1.0, 0.0, 5.0, 10.0, 13.0, 1.0, 0.0,
     5.0, 4.0, 13.0, 1.0, 0.0, 5.0, 6.0, 15.0, 1.0, 0.0, 5.0, 5.0, 15.0, 1.0, 0.0,
     5.0, 9.0, 15.0, 1.0, 0.0, 5.0, 9.0, 16.0, 1.0, 0.0, 5.0, 10.0, 14.0, 1.0, 0.0,
     5.0, 8.0, 14.0, 1.0, 0.0, 5.0, 7.0, 14.0, 1.0, 0.0, 5.0, 6.0, 14.0, 1.0, 0.0,
     5.0, 5.0, 9.0, 1.0, 0.0, 5.0, 5.0, 8.0, 1.0, 0.0, 5.0, 9.0, 14.0, 1.0, 0.0,
     5.0, 8.0, 12.0, 1.0, 0.0, 5.0, 9.0, 17.0, 1.0, 0.0, 5.0, 7.0, 13.0, 1.0, 0.0,
     5.0, 6.0, 13.0, 1.0, 0.0, 5.0, 8.0, 17.0, 1.0, 55.0, 6.0, 1.0, 6.0, 2.0, 1.0,
     0.0, 418.0, 9.0, -1.0, 2.0, 6.0, 8.0, 3.0, 1.0, 81.0, 3.0, 1.0, 1.0, 0.0, 6.0,
     4.0, 2.0, 1.0, 0.0, 6.0, 3.0, 20.0, 1.0, 0.0, 6.0, 2.0, 20.0, 1.0, 0.0, 6.0,
     3.0, 3.0, 1.0, 0.0, 6.0, 5.0, 3.0, 1.0, 0.0, 6.0, 4.0, 3.0, 1.0, 0.0, 6.0,
     5.0, 2.0, 1.0, 0.0, 6.0, 6.0, 3.0, 1.0, 0.0, 6.0, 6.0, 2.0, 1.0, 0.0, 6.0,
     6.0, 4.0, 1.0, 0.0, 6.0, 7.0, 3.0, 1.0, 0.0, 6.0, 6.0, 5.0, 1.0, 0.0, 6.0,
     8.0, 3.0, 1.0, 0.0, 6.0, 8.0, 2.0, 1.0, 0.0, 6.0, 6.0, 6.0, 1.0, 0.0, 6.0,
     5.0, 6.0, 1.0, 0.0, 6.0, 7.0, 6.0, 1.0, 0.0, 6.0, 7.0, 2.0, 1.0, 0.0, 6.0,
     7.0, 1.0, 1.0, 0.0, 6.0, 7.0, 5.0, 1.0, 0.0, 6.0, 7.0, 7.0, 1.0, 0.0, 6.0,
     8.0, 6.0, 1.0, 0.0, 6.0, 5.0, 7.0, 1.0, 0.0, 6.0, 6.0, 8.0, 1.0, 0.0, 6.0,
     4.0, 7.0, 2.0, 0.0, 6.0, 5.0, 8.0, 1.0, 0.0, 6.0, 7.0, 9.0, 1.0, 0.0, 6.0,
     6.0, 9.0, 1.0, 0.0, 6.0, 6.0, 10.0, 2.0, 0.0, 6.0, 5.0, 9.0, 1.0, 0.0, 6.0,
     7.0, 11.0, 1.0, 0.0, 6.0, 6.0, 11.0, 1.0, 0.0, 6.0, 8.0, 12.0, 1.0, 0.0, 6.0,
     6.0, 12.0, 1.0, 0.0, 6.0, 7.0, 12.0, 1.0, 0.0, 6.0, 9.0, 13.0, 1.0, 0.0, 6.0,
     9.0, 12.0, 1.0, 0.0, 6.0, 6.0, 13.0, 1.0, 0.0, 6.0, 5.0, 13.0, 1.0, 0.0, 6.0,
     10.0, 14.0, 1.0, 0.0, 6.0, 9.0, 14.0, 1.0, 0.0, 6.0, 8.0, 14.0, 1.0, 0.0, 6.0,
     5.0, 14.0, 1.0, 0.0, 6.0, 8.0, 13.0, 1.0, 0.0, 6.0, 7.0, 13.0, 1.0, 0.0, 6.0,
     4.0, 15.0, 1.0, 0.0, 6.0, 8.0, 8.0, 1.0, 0.0, 6.0, 7.0, 8.0, 1.0, 0.0, 6.0,
     8.0, 15.0, 1.0, 0.0, 6.0, 7.0, 15.0, 1.0, 0.0, 6.0, 3.0, 15.0, 1.0, 0.0, 6.0,
     3.0, 14.0, 1.0, 0.0, 6.0, 5.0, 15.0, 1.0, 0.0, 6.0, 9.0, 16.0, 1.0, 0.0, 6.0,
     3.0, 13.0, 1.0, 0.0, 6.0, 8.0, 16.0, 1.0, 0.0, 6.0, 9.0, 17.0, 1.0, 0.0, 6.0,
     8.0, 17.0, 1.0, 0.0, 6.0, 7.0, 17.0, 1.0, 0.0, 6.0, 7.0, 16.0, 1.0, 0.0, 6.0,
     7.0, 18.0, 1.0, 0.0, 6.0, 6.0, 18.0, 1.0, 0.0, 6.0, 6.0, 17.0, 1.0, 0.0, 6.0,
     6.0, 16.0, 1.0, 0.0, 6.0, 5.0, 17.0, 1.0, 0.0, 6.0, 4.0, 16.0, 1.0, 0.0, 6.0,
     3.0, 16.0, 1.0, 0.0, 6.0, 6.0, 15.0, 1.0, 0.0, 6.0, 5.0, 16.0, 1.0, 0.0, 6.0,
     10.0, 13.0, 1.0, 0.0, 6.0, 4.0, 13.0, 1.0, 0.0, 6.0, 9.0, 15.0, 1.0, 0.0, 6.0,
     4.0, 12.0, 1.0, 0.0, 6.0, 7.0, 14.0, 1.0, 0.0, 6.0, 6.0, 14.0, 1.0, 0.0, 6.0,
     4.0, 14.0, 1.0, 75.0, 7.0, 4.0, 7.0, 1.0, 75.0, 7.0, 4.0, 6.0, 2.0, 151.0, 8.0,
     3.0, 2.0, 1.0, 151.0, 8.0, 4.0, 6.0, 1.0, 229.0, 9.0, 1.0, -1.0, 2.0, 4.0, 0.0]
    self.assertEqual(output["number_of_lakes"],9)
    self.assertEqual(output["lakes_as_array"],expected_lakes_as_array)
    np.testing.assert_array_equal(output["lake_mask"],expected_lake_mask)

  def testBasinEvaluationTwo(self):
    coarse_catchment_nums_in = np.array([[3,3,2,2],
                                         [3,3,2,2],
                                         [1,1,1,2],
                                         [1,1,1,1]],
                                         dtype=np.int32)
    corrected_orography_in = np.array([
      [20.0,20.0,20.0,20.0,20.0, 20.0,20.0,20.0,20.0,20.0, 20.0,20.0,20.0,20.0,20.0, 20.0,20.0,20.0,20.0,20.0],
      [20.0, 1.0,10.0,20.0, 9.0, 20.0,20.0,20.0, 1.0,16.0, 20.0,20.0, 1.0,20.0,20.0, 20.0,20.0,20.0,20.0,20.0],
      [20.0, 2.0,11.0,20.0, 8.0, 20.0,20.0,20.0, 2.0,15.0, 20.0,20.0, 2.0,20.0,20.0, 20.0,20.0,20.0,20.0,20.0],
      [18.0, 3.0,12.0,20.0, 7.0, 20.0,20.0,20.0, 3.0,14.0, 20.0,20.0, 3.0,18.0, 0.9,  0.8, 0.0, 0.7, 0.8, 0.9],
      [20.0, 4.0,13.0, 6.0, 5.0, 20.0,20.0,20.0, 4.0,13.0,  5.0, 5.0, 4.0,20.0,20.0, 20.0,20.0,20.0,20.0,20.0],
      [20.0, 5.0,14.0,20.0, 4.0, 20.0,20.0,20.0, 5.0,12.0, 20.0,20.0, 6.0,20.0,20.0, 20.0,20.0,20.0,20.0,20.0],
      [20.0, 6.0,15.0,20.0, 3.0, 20.0,20.0,20.0, 6.0,11.0, 20.0,20.0, 7.0,20.0,20.0, 20.0,20.0,20.0,20.0,20.0],
      [20.0, 8.0,16.0,20.0, 2.0, 20.0,20.0,20.0, 7.0,10.0, 20.0,20.0, 8.0,20.0,20.0, 20.0,20.0, 5.0,20.0,20.0],
      [20.0, 9.0,17.0,20.0, 1.0, 20.0,20.0,20.0, 8.0, 9.0, 20.0,20.0, 9.0,20.0,20.0, 20.0, 4.0, 6.0,20.0,20.0],
      [20.0,20.0,20.0,20.0,20.0, 20.0,20.0,20.0,20.0,20.0, 20.0,20.0,20.0,20.0,20.0,  3.0, 7.0,20.0,20.0,20.0],
      [20.0,20.0,20.0,20.0,20.0, 20.0,20.0,20.0,20.0,20.0, 20.0,20.0,20.0,20.0, 2.0,  8.0,20.0,20.0,20.0,20.0],
      [20.0, 1.0,16.0,20.0, 2.0, 20.0,20.0,20.0,20.0,20.0, 20.0,20.0,20.0, 1.0, 9.0, 20.0,20.0,20.0,20.0,20.0],
      [20.0, 2.0,15.0,20.0, 3.0, 20.0,20.0,20.0,20.0,20.0, 20.0,20.0,20.0,10.0,20.0, 20.0,20.0,20.0,20.0,20.0],
      [20.0, 3.0,14.0,20.0, 4.0, 20.0,20.0, 1.0,20.0, 5.0, 20.0,20.0,20.0, 0.9,20.0, 20.0,20.0,20.0,20.0,20.0],
      [20.0, 4.0,13.0, 6.0, 5.0, 20.0,20.0, 2.0, 4.0, 3.0, 20.0,20.0, 0.8,20.0,20.0, 20.0,20.0,20.0,20.0,20.0],
      [20.0, 5.0,12.0,20.0, 7.0, 20.0,20.0, 3.0,20.0, 2.0, 20.0,20.0, 0.7,20.0,20.0, 20.0,20.0,20.0,20.0,20.0],
      [20.0, 6.0,11.0,20.0, 8.0, 20.0,20.0, 4.0,20.0, 1.0, 20.0,20.0, 0.6,20.0,20.0, 20.0,20.0,20.0,20.0,20.0],
      [20.0, 7.0,10.0,20.0, 9.0, 20.0,20.0, 6.0,20.0,20.0, 20.0,20.0, 0.5,20.0,20.0, 20.0,20.0,20.0,20.0,20.0],
      [20.0, 8.0, 9.0,20.0,10.0, 18.0, 0.9, 0.8,20.0,20.0, 20.0, 0.4,20.0,20.0,20.0, 20.0,20.0,20.0,20.0,20.0],
      [20.0,20.0,20.0,20.0,20.0, 20.0,20.0,20.0, 0.0, 0.2,  0.3,20.0,20.0,20.0,20.0, 20.0,20.0,20.0,20.0,20.0]],
      dtype=np.float64)
    raw_orography_in = np.array([
      [20.0,20.0,20.0,20.0,20.0, 20.0,20.0,20.0,20.0,20.0, 20.0,20.0,20.0,20.0,20.0, 20.0,20.0,20.0,20.0,20.0],
      [20.0, 1.0,10.0,20.0, 9.0, 20.0,20.0,20.0, 1.0,16.0, 20.0,20.0, 1.0,20.0,20.0, 20.0,20.0,20.0,20.0,20.0],
      [20.0, 2.0,11.0,20.0, 8.0, 20.0,20.0,20.0, 2.0,15.0, 20.0,20.0, 2.0,20.0,20.0, 20.0,20.0,20.0,20.0,20.0],
      [18.0, 3.0,12.0,20.0, 7.0, 20.0,20.0,20.0, 3.0,14.0, 20.0,20.0, 3.0,18.0, 0.9,  0.8, 0.0, 0.7, 0.8, 0.9],
      [20.0, 4.0,13.0,20.0, 5.0, 20.0,20.0,20.0, 4.0,13.0,  5.0, 5.0, 4.0,20.0,20.0, 20.0,20.0,20.0,20.0,20.0],
      [20.0, 5.0,14.0,20.0, 4.0, 20.0,20.0,20.0, 5.0,12.0, 20.0,20.0, 6.0,20.0,20.0, 20.0,20.0,20.0,20.0,20.0],
      [20.0, 6.0,15.0,20.0, 3.0, 20.0,20.0,20.0, 6.0,11.0, 20.0,20.0, 7.0,20.0,20.0, 20.0,20.0,20.0,20.0,20.0],
      [20.0, 8.0,16.0,20.0, 2.0, 20.0,20.0,20.0, 7.0,10.0, 20.0,20.0, 8.0,20.0,20.0, 20.0,20.0, 5.0,20.0,20.0],
      [20.0, 9.0,17.0,20.0, 1.0, 20.0,20.0,20.0, 8.0, 9.0, 20.0,20.0, 9.0,20.0,20.0, 20.0, 4.0, 6.0,20.0,20.0],
      [20.0,20.0,20.0,20.0,20.0, 20.0,20.0,20.0,20.0,20.0, 20.0,20.0,20.0,20.0,20.0,  3.0, 7.0,20.0,20.0,20.0],
      [20.0,20.0,20.0,20.0,20.0, 20.0,20.0,20.0,20.0,20.0, 20.0,20.0,20.0,20.0, 2.0,  8.0,20.0,20.0,20.0,20.0],
      [20.0, 1.0,16.0,20.0, 2.0, 20.0,20.0,20.0,20.0,20.0, 20.0,20.0,20.0, 1.0, 9.0, 20.0,20.0,20.0,20.0,20.0],
      [20.0, 2.0,15.0,20.0, 3.0, 20.0,20.0,20.0,20.0,20.0, 20.0,20.0,20.0,10.0,20.0, 20.0,20.0,20.0,20.0,20.0],
      [20.0, 3.0,14.0,20.0, 4.0, 20.0,20.0, 1.0,20.0, 5.0, 20.0,20.0,20.0, 0.9,20.0, 20.0,20.0,20.0,20.0,20.0],
      [20.0, 4.0,13.0,20.0, 5.0, 20.0,20.0, 2.0, 4.0, 3.0, 20.0,20.0, 0.8,20.0,20.0, 20.0,20.0,20.0,20.0,20.0],
      [20.0, 5.0,12.0,20.0, 7.0, 20.0,20.0, 3.0,20.0, 2.0, 20.0,20.0, 0.7,20.0,20.0, 20.0,20.0,20.0,20.0,20.0],
      [20.0, 6.0,11.0,20.0, 8.0, 20.0,20.0, 4.0,20.0, 1.0, 20.0,20.0, 0.6,20.0,20.0, 20.0,20.0,20.0,20.0,20.0],
      [20.0, 7.0,10.0,20.0, 9.0, 20.0,20.0, 6.0,20.0,20.0, 20.0,20.0, 0.5,20.0,20.0, 20.0,20.0,20.0,20.0,20.0],
      [20.0, 8.0, 9.0,20.0,10.0, 18.0, 0.9, 0.8,20.0,20.0, 20.0, 0.4,20.0,20.0,20.0, 20.0,20.0,20.0,20.0,20.0],
      [20.0,20.0,20.0,20.0,20.0, 20.0,20.0,20.0, 0.0, 0.2,  0.3,20.0,20.0,20.0,20.0, 20.0,20.0,20.0,20.0,20.0]],
      dtype=np.float64)
    minima_in = np.array([
      [False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False],
      [False, True,False,False,False,False,False,False, True,False,False,False, True,False,False,False,False,False,False,False],
      [False, False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False],
      [False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False],
      [False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False],
      [False,False,False,False,False,False,False,False,False,False,False,False,False,False, False,False,False,False,False,False],
      [False,False,False,False,False,False, False,False,False,False,False,False,False,False,False,False,False,False,False,False],
      [False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False],
      [False,False,False,False, True,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False],
      [False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False],
      [False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False],
      [False, True,False,False, True,False,False,False,False,False,False,False,False, True,False,False,False,False,False,False],
      [False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False],
      [False,False,False,False,False,False,False, True,False,False,False,False,False,False,False,False,False,False,False,False],
      [False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False],
      [False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False],
      [False,False,False,False,False,False,False,False,False, True,False,False,False,False,False,False,False,False,False,False],
      [False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False],
      [False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False],
      [False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False]],
      dtype=np.int32)
    prior_fine_rdirs_in = np.array([
      [1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,3.0,3.0,3.0,3.0,3.0,3.0,2.0,1.0,1.0,3.0,3.0,2.0],
      [2.0,1.0,2.0,1.0,1.0,2.0,1.0,1.0,1.0,3.0,3.0,3.0,2.0,3.0,2.0,1.0,1.0,3.0,3.0,3.0],
      [5.0,4.0,1.0,1.0,3.0,2.0,1.0,1.0,1.0,1.0,3.0,3.0,2.0,1.0,1.0,1.0,1.0,6.0,6.0,6.0],
      [8.0,7.0,4.0,4.0,3.0,2.0,1.0,1.0,2.0,1.0,6.0,3.0,2.0,1.0,1.0,1.0,1.0,1.0,9.0,9.0],
      [9.0,8.0,7.0,3.0,3.0,2.0,1.0,2.0,1.0,1.0,3.0,6.0,3.0,2.0,1.0,1.0,1.0,1.0,1.0,9.0],
      [9.0,8.0,7.0,3.0,3.0,2.0,1.0,1.0,1.0,1.0,3.0,3.0,6.0,5.0,4.0,4.0,1.0,1.0,1.0,3.0],
      [9.0,8.0,7.0,6.0,6.0,5.0,4.0,4.0,4.0,4.0,6.0,6.0,9.0,8.0,7.0,1.0,1.0,4.0,4.0,6.0],
      [9.0,9.0,8.0,9.0,9.0,8.0,7.0,7.0,7.0,7.0,9.0,9.0,8.0,7.0,5.0,4.0,4.0,7.0,7.0,9.0],
      [9.0,9.0,8.0,7.0,9.0,8.0,7.0,8.0,7.0,7.0,9.0,9.0,8.0,7.0,8.0,7.0,7.0,7.0,2.0,1.0],
      [9.0,9.0,8.0,9.0,9.0,8.0,7.0,7.0,7.0,9.0,9.0,9.0,8.0,7.0,7.0,7.0,7.0,7.0,2.0,1.0],
      [1.0,1.0,9.0,9.0,9.0,8.0,7.0,7.0,7.0,9.0,9.0,9.0,8.0,7.0,7.0,7.0,7.0,3.0,2.0,1.0],
      [1.0,3.0,3.0,2.0,1.0,1.0,1.0,1.0,9.0,9.0,9.0,9.0,8.0,3.0,3.0,2.0,1.0,3.0,2.0,1.0],
      [1.0,3.0,3.0,2.0,1.0,1.0,1.0,1.0,1.0,9.0,9.0,9.0,3.0,3.0,3.0,2.0,1.0,1.0,1.0,1.0],
      [4.0,3.0,3.0,2.0,1.0,1.0,1.0,1.0,1.0,9.0,9.0,3.0,6.0,6.0,6.0,5.0,4.0,4.0,4.0,4.0],
      [7.0,3.0,3.0,2.0,1.0,1.0,1.0,1.0,1.0,1.0,3.0,3.0,3.0,9.0,9.0,8.0,7.0,7.0,7.0,7.0],
      [7.0,3.0,6.0,5.0,4.0,1.0,1.0,1.0,1.0,1.0,3.0,3.0,3.0,3.0,9.0,8.0,7.0,7.0,7.0,7.0],
      [3.0,3.0,3.0,2.0,1.0,4.0,4.0,4.0,4.0,4.0,3.0,3.0,3.0,3.0,3.0,2.0,1.0,1.0,7.0,7.0],
      [3.0,3.0,3.0,2.0,1.0,7.0,7.0,7.0,7.0,7.0,3.0,3.0,3.0,3.0,3.0,2.0,1.0,1.0,1.0,7.0],
      [3.0,3.0,3.0,2.0,1.0,1.0,7.0,7.0,7.0,7.0,3.0,3.0,3.0,3.0,3.0,2.0,1.0,1.0,1.0,3.0],
      [6.0,6.0,6.0,0.0,4.0,4.0,4.0,7.0,7.0,7.0,6.0,6.0,6.0,6.0,6.0,0.0,4.0,4.0,4.0,6.0]],
      dtype=np.float64)
    prior_coarse_rdirs_in = np.array([[5.0,5.0,5.0,5.0],
                                      [5.0,5.0,5.0,5.0],
                                      [5.0,5.0,5.0,5.0],
                                      [5.0,5.0,5.0,5.0]],
                                      dtype=np.float64)
    prior_fine_catchments_in = np.array([
      [11,11,11,11,11,11,13,13,12,12,12,12,12,12,12,12,12,11,11,11],
      [11,11,11,11,11,13,13,13,13,12,12,12,12,12,12,12,12,11,11,11],
      [11,11,11,11,13,13,13,13,13,13,12,12,12,12,12,12,12,11,11,11],
      [11,11,11,11,13,13,13,13,13,13,12,12,12,12,12,12,12,12,11,11],
      [11,11,11,13,13,13,13,13,13,13,12,12,12,12,12,12,12,14,14,11],
      [11,11,11,13,13,13,13,13,13,13,12,12,12,12,12,12,14,14,14,11],
      [11,11,11,13,13,13,13,13,13,13,12,12,12,12,12,14,14,14,14,11],
      [11,11,11,13,13,13,13,13,13,13,12,12,12,12,14,14,14,14,14,11],
      [11,11,11,11,13,13,13,13,13,13,12,12,12,12,14,14,14,14,15,15],
      [11,11,11,13,13,13,13,13,13,12,12,12,12,12,12,14,14,14,15,15],
      [15,15,13,13,13,13,13,13,13,12,12,12,12,12,12,12,14,15,15,15],
      [15,16,16,16,16,16,16,16,12,12,12,12,12,15,15,15,15,15,15,15],
      [15,16,16,16,16,16,16,16, 4,12,12,12,15,15,15,15,15,15,15,15],
      [15,16,16,16,16,16,16, 4, 4,12,12, 9,15,15,15,15,15,15,15,15],
      [15,16,16,16,16,16, 4, 4, 4, 4,10, 9, 9,15,15,15,15,15,15,15],
      [15, 4,16,16,16, 4, 4, 4, 4, 4, 7,10, 9, 9,15,15,15,15,15,15],
      [5, 4, 4, 4, 4, 4, 4, 4, 4, 4, 7, 7,10, 9, 9, 9, 9, 9,15,15],
      [2, 5, 4, 4, 4, 4, 4, 4, 4, 4, 7, 7, 7,10, 9, 9, 9, 8, 6,15],
      [2, 2, 5, 4, 3, 1, 4, 4, 4, 4, 7, 7, 7, 7,10, 9, 8, 6, 6, 2],
      [2, 2, 2, 0, 1, 1, 1, 4, 4, 4, 7, 7, 7, 7, 7, 0, 6, 6, 6, 2]],
      dtype=np.int32)
    landsea_in = np.array([
      [False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False],
      [False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False],
      [False, False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False],
      [False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,True,False,False,False],
      [False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False],
      [False,False,False,False,False,False,False,False,False,False,False,False,False,False, False,False,False,False,False,False],
      [False,False,False,False,False,False, False,False,False,False,False,False,False,False,False,False,False,False,False,False],
      [False,False,False,False,False,False,False,False,False,False,False,False,False,False,False, False,False,False,False,False],
      [False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False],
      [False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False],
      [False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False],
      [False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False],
      [False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False],
      [False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False],
      [False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False],
      [False,False,False,False, False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False],
      [False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False],
      [False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False],
      [False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False],
      [False,False,False,False,False,False,False,False, True,False,False,False,False,False,False,False,False,False,False,False]],
      dtype=np.int32)
    cell_areas_in = np.full((20,20),1.0)
    output,alg = \
      LatLonEvaluateBasin.evaluate_basins(landsea_in,
                                          minima_in,
                                          raw_orography_in,
                                          corrected_orography_in,
                                          cell_areas_in,
                                          prior_fine_rdirs_in,
                                          prior_fine_catchments_in,
                                          coarse_catchment_nums_in,
                                          return_algorithm_object=True)
    expected_lake_mask = np.array([
       [False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False,
        False, False],
       [False,  True,  True, False,  True, False, False, False,  True,
         True, False, False,  True, False, False, False, False, False,
        False, False],
       [False,  True,  True, False,  True, False, False, False,  True,
         True, False, False,  True, False, False, False, False, False,
        False, False],
       [False,  True,  True, False,  True, False, False, False,  True,
         True, False, False,  True, False, False, False, False, False,
        False, False],
       [False,  True,  True,  True,  True, False, False, False,  True,
         True,  True,  True,  True, False, False, False, False, False,
        False, False],
       [False,  True,  True, False,  True, False, False, False,  True,
         True, False, False,  True, False, False, False, False, False,
        False, False],
       [False,  True,  True, False,  True, False, False, False,  True,
         True, False, False,  True, False, False, False, False, False,
        False, False],
       [False,  True,  True, False,  True, False, False, False,  True,
         True, False, False,  True, False, False, False, False,  True,
        False, False],
       [False,  True,  True, False,  True, False, False, False,  True,
         True, False, False,  True, False, False, False,  True,  True,
        False, False],
       [False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False,  True,  True, False,
        False, False],
       [False, False, False, False, False, False, False, False, False,
        False, False, False, False, False,  True,  True, False, False,
        False, False],
       [False,  True,  True, False,  True, False, False, False, False,
        False, False, False, False,  True,  True, False, False, False,
        False, False],
       [False,  True,  True, False,  True, False, False, False, False,
        False, False, False, False, False, False, False, False, False,
        False, False],
       [False,  True,  True, False,  True, False, False,  True, False,
         True, False, False, False, False, False, False, False, False,
        False, False],
       [False,  True,  True,  True,  True, False, False,  True,  True,
         True, False, False, False, False, False, False, False, False,
        False, False],
       [False,  True,  True, False,  True, False, False,  True, False,
         True, False, False, False, False, False, False, False, False,
        False, False],
       [False,  True,  True, False,  True, False, False,  True, False,
         True, False, False, False, False, False, False, False, False,
        False, False],
       [False,  True,  True, False,  True, False, False, False, False,
        False, False, False, False, False, False, False, False, False,
        False, False],
       [False,  True,  True, False,  True, False, False, False, False,
        False, False, False, False, False, False, False, False, False,
        False, False],
       [False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False,
        False, False]])
    expected_lakes_as_array = \
      [13.0, 26.0, 1.0, 11.0, 0.0, 17.0, 10.0, 3.0, 17.0, 10.0, 1.0, 1.0, 2.0, 16.0, 10.0,
       1.0, 3.0, 3.0, 15.0, 10.0, 1.0, 6.0, 4.0, 1.0, 2.0, 4.0, 2.0, 0.0, 26.0, 2.0,
       11.0, 0.0, 14.0, 8.0, 3.0, 14.0, 8.0, 1.0, 1.0, 2.0, 15.0, 8.0, 1.0, 3.0, 3.0,
       16.0, 8.0, 1.0, 6.0, 4.0, 1.0, 1.0, -1.0, -1.0, 1.0, 56.0, 3.0, -1.0, 0.0, 12.0,
       14.0, 9.0, 12.0, 14.0, 1.0, 1.0, 2.0, 11.0, 15.0, 1.0, 3.0, 3.0, 10.0, 16.0, 1.0,
       6.0, 4.0, 9.0, 17.0, 1.0, 10.0, 5.0, 8.0, 18.0, 1.0, 15.0, 6.0, 9.0, 18.0, 1.0,
       21.0, 7.0, 10.0, 17.0, 1.0, 28.0, 8.0, 11.0, 16.0, 1.0, 36.0, 9.0, 12.0, 15.0, 1.0,
       45.0, 10.0, 1.0, -1.0, 3.0, 4.0, 0.0, 56.0, 4.0, 12.0, 0.0, 12.0, 5.0, 9.0, 12.0,
       5.0, 1.0, 1.0, 3.0, 13.0, 5.0, 1.0, 3.0, 4.0, 14.0, 5.0, 1.0, 6.0, 5.0, 15.0,
       5.0, 1.0, 10.0, 6.0, 15.0, 4.0, 2.0, 14.0, 7.0, 16.0, 5.0, 1.0, 19.0, 8.0, 17.0,
       5.0, 1.0, 25.0, 9.0, 18.0, 5.0, 1.0, 32.0, 10.0, 19.0, 5.0, 1.0, 48.0, 12.0, 1.0,
       5.0, 4.0, 1.0, 0.0, 66.0, 5.0, 12.0, 0.0, 12.0, 2.0, 11.0, 12.0, 2.0, 1.0, 1.0,
       2.0, 13.0, 2.0, 1.0, 3.0, 3.0, 14.0, 2.0, 1.0, 6.0, 4.0, 15.0, 2.0, 1.0, 10.0,
       5.0, 16.0, 2.0, 1.0, 15.0, 6.0, 17.0, 2.0, 1.0, 21.0, 7.0, 18.0, 2.0, 1.0, 28.0,
       8.0, 19.0, 2.0, 1.0, 36.0, 9.0, 19.0, 3.0, 1.0, 45.0, 10.0, 18.0, 3.0, 1.0, 55.0,
       11.0, 17.0, 3.0, 1.0, 66.0, 12.0, 1.0, 4.0, -1.0, -1.0, 1.0, 56.0, 6.0, 10.0, 0.0,
       9.0, 5.0, 9.0, 9.0, 5.0, 1.0, 1.0, 2.0, 8.0, 5.0, 1.0, 3.0, 3.0, 7.0, 5.0,
       1.0, 6.0, 4.0, 6.0, 5.0, 1.0, 10.0, 5.0, 5.0, 5.0, 1.0, 15.0, 6.0, 5.0, 4.0,
       2.0, 20.0, 7.0, 4.0, 5.0, 1.0, 26.0, 8.0, 3.0, 5.0, 1.0, 33.0, 9.0, 2.0, 5.0,
       1.0, 57.0, 12.0, 1.0, 9.0, -1.0, -1.0, 1.0, 61.0, 7.0, 13.0, 0.0, 2.0, 13.0, 10.0,
       2.0, 13.0, 1.0, 1.0, 2.0, 3.0, 13.0, 1.0, 3.0, 3.0, 4.0, 13.0, 1.0, 6.0, 4.0,
       5.0, 13.0, 1.0, 10.0, 5.0, 5.0, 12.0, 1.0, 10.0, 5.0, 5.0, 11.0, 1.0, 16.0, 6.0,
       6.0, 13.0, 1.0, 23.0, 7.0, 7.0, 13.0, 1.0, 31.0, 8.0, 8.0, 13.0, 1.0, 40.0, 9.0,
       9.0, 13.0, 1.0, 70.0, 12.0, 1.0, 8.0, 2.0, 2.0, 0.0, 66.0, 8.0, 13.0, 0.0, 2.0,
       9.0, 11.0, 2.0, 9.0, 1.0, 1.0, 2.0, 3.0, 9.0, 1.0, 3.0, 3.0, 4.0, 9.0, 1.0,
       6.0, 4.0, 5.0, 9.0, 1.0, 10.0, 5.0, 6.0, 9.0, 1.0, 15.0, 6.0, 7.0, 9.0, 1.0,
       21.0, 7.0, 8.0, 9.0, 1.0, 28.0, 8.0, 9.0, 9.0, 1.0, 36.0, 9.0, 9.0, 10.0, 1.0,
       45.0, 10.0, 8.0, 10.0, 1.0, 55.0, 11.0, 7.0, 10.0, 1.0, 66.0, 12.0, 1.0, 7.0, -1.0,
       -1.0, 1.0, 61.0, 9.0, 10.0, 0.0, 2.0, 2.0, 10.0, 2.0, 2.0, 1.0, 1.0, 2.0, 3.0,
       2.0, 1.0, 3.0, 3.0, 4.0, 2.0, 1.0, 6.0, 4.0, 5.0, 2.0, 1.0, 10.0, 5.0, 6.0,
       2.0, 1.0, 15.0, 6.0, 7.0, 2.0, 1.0, 27.0, 8.0, 8.0, 2.0, 1.0, 34.0, 9.0, 9.0,
       2.0, 1.0, 42.0, 10.0, 2.0, 3.0, 1.0, 51.0, 11.0, 3.0, 3.0, 1.0, 61.0, 12.0, 1.0,
       6.0, 1.0, 1.0, 0.0, 138.0, 10.0, -1.0, 2.0, 9.0, 6.0, 2.0, 2.0, 25.0, 2.0, 2.0,
       1.0, 0.0, 12.0, 3.0, 3.0, 1.0, 0.0, 12.0, 2.0, 3.0, 1.0, 0.0, 12.0, 4.0, 3.0,
       1.0, 0.0, 12.0, 4.0, 2.0, 1.0, 0.0, 12.0, 5.0, 4.0, 2.0, 0.0, 12.0, 5.0, 2.0,
       1.0, 0.0, 12.0, 6.0, 5.0, 1.0, 0.0, 12.0, 3.0, 2.0, 1.0, 0.0, 12.0, 7.0, 5.0,
       1.0, 0.0, 12.0, 5.0, 5.0, 1.0, 0.0, 12.0, 8.0, 5.0, 1.0, 0.0, 12.0, 6.0, 2.0,
       1.0, 0.0, 12.0, 9.0, 5.0, 1.0, 0.0, 12.0, 7.0, 2.0, 1.0, 0.0, 12.0, 4.0, 5.0,
       1.0, 0.0, 12.0, 8.0, 2.0, 1.0, 0.0, 12.0, 3.0, 5.0, 1.0, 0.0, 12.0, 9.0, 2.0,
       1.0, 0.0, 12.0, 2.0, 5.0, 1.0, 19.0, 13.0, 5.0, 3.0, 1.0, 39.0, 14.0, 6.0, 3.0,
       1.0, 60.0, 15.0, 7.0, 3.0, 1.0, 82.0, 16.0, 8.0, 3.0, 1.0, 105.0, 17.0, 9.0, 3.0,
       1.0, 129.0, 18.0, 1.0, -1.0, 2.0, 1.0, 0.0, 58.0, 11.0, -1.0, 2.0, 1.0, 2.0, 17.0,
       10.0, 9.0, 17.0, 10.0, 1.0, 0.0, 4.0, 16.0, 10.0, 1.0, 0.0, 4.0, 15.0, 10.0, 1.0,
       0.0, 4.0, 15.0, 9.0, 1.0, 0.0, 4.0, 16.0, 8.0, 1.0, 0.0, 4.0, 15.0, 8.0, 1.0,
       0.0, 4.0, 14.0, 8.0, 1.0, 0.0, 4.0, 17.0, 8.0, 1.0, 8.0, 5.0, 14.0, 10.0, 1.0,
       17.0, 6.0, 1.0, -1.0, 4.0, 2.0, 0.0, 138.0, 12.0, -1.0, 2.0, 4.0, 5.0, 12.0, 5.0,
       25.0, 12.0, 5.0, 1.0, 0.0, 12.0, 13.0, 5.0, 1.0, 0.0, 12.0, 14.0, 5.0, 1.0, 0.0,
       12.0, 15.0, 5.0, 1.0, 0.0, 12.0, 15.0, 4.0, 2.0, 0.0, 12.0, 16.0, 5.0, 1.0, 0.0,
       12.0, 16.0, 3.0, 1.0, 0.0, 12.0, 17.0, 5.0, 1.0, 0.0, 12.0, 17.0, 3.0, 1.0, 0.0,
       12.0, 17.0, 2.0, 1.0, 0.0, 12.0, 18.0, 3.0, 1.0, 0.0, 12.0, 18.0, 2.0, 1.0, 0.0,
       12.0, 19.0, 3.0, 1.0, 0.0, 12.0, 19.0, 2.0, 1.0, 0.0, 12.0, 15.0, 2.0, 1.0, 0.0,
       12.0, 18.0, 5.0, 1.0, 0.0, 12.0, 14.0, 2.0, 1.0, 0.0, 12.0, 16.0, 2.0, 1.0, 0.0,
       12.0, 19.0, 5.0, 1.0, 0.0, 12.0, 13.0, 2.0, 1.0, 0.0, 12.0, 12.0, 2.0, 1.0, 20.0,
       13.0, 15.0, 3.0, 1.0, 41.0, 14.0, 14.0, 3.0, 1.0, 63.0, 15.0, 13.0, 3.0, 1.0, 86.0,
       16.0, 12.0, 3.0, 1.0, 134.0, 18.0, 1.0, -1.0, 4.0, 2.0, 0.0, 143.0, 13.0, -1.0, 2.0,
       7.0, 8.0, 2.0, 13.0, 26.0, 2.0, 13.0, 1.0, 0.0, 12.0, 3.0, 13.0, 1.0, 0.0, 12.0,
       4.0, 13.0, 1.0, 0.0, 12.0, 5.0, 13.0, 1.0, 0.0, 12.0, 5.0, 12.0, 1.0, 0.0, 12.0,
       6.0, 13.0, 1.0, 0.0, 12.0, 5.0, 11.0, 1.0, 0.0, 12.0, 7.0, 13.0, 1.0, 0.0, 12.0,
       6.0, 10.0, 1.0, 0.0, 12.0, 8.0, 13.0, 1.0, 0.0, 12.0, 7.0, 9.0, 1.0, 0.0, 12.0,
       6.0, 9.0, 1.0, 0.0, 12.0, 5.0, 9.0, 1.0, 0.0, 12.0, 8.0, 10.0, 1.0, 0.0, 12.0,
       8.0, 9.0, 1.0, 0.0, 12.0, 9.0, 13.0, 1.0, 0.0, 12.0, 7.0, 10.0, 1.0, 0.0, 12.0,
       4.0, 9.0, 1.0, 0.0, 12.0, 9.0, 9.0, 1.0, 0.0, 12.0, 9.0, 10.0, 1.0, 0.0, 12.0,
       3.0, 9.0, 1.0, 0.0, 12.0, 2.0, 9.0, 1.0, 22.0, 13.0, 5.0, 10.0, 1.0, 45.0, 14.0,
       4.0, 10.0, 1.0, 69.0, 15.0, 3.0, 10.0, 1.0, 94.0, 16.0, 2.0, 10.0, 1.0, 146.0, 18.0,
       1.0, -1.0, 1.0, 3.0, 0.0]
    self.assertEqual(output["number_of_lakes"],13)
    self.assertEqual(output["lakes_as_array"],expected_lakes_as_array)
    np.testing.assert_array_equal(output["lake_mask"],expected_lake_mask)

  def testBasinEvaluationThree(self):
    coarse_catchment_nums_in = np.array([[3,3,2,2],
                                         [3,3,2,2],
                                         [1,1,1,2],
                                         [1,1,1,1]],
                                         dtype=np.int32)
    corrected_orography_in = np.array([
      [20.0,20.0,20.0,20.0,20.0, 20.0,20.0,20.0,20.0,20.0, 20.0,20.0,20.0,20.0,20.0, 20.0,20.0,20.0,20.0,20.0],
      [20.0, 1.0,10.0,20.0, 9.0, 20.0,20.0,20.0, 1.0,16.0, 20.0,20.0, 1.0,20.0,20.0, 20.0,20.0,20.0,20.0,20.0],
      [20.0, 2.0,11.0,20.0, 8.0, 20.0,20.0,20.0, 2.0,15.0, 20.0,20.0, 2.0,20.0,20.0, 20.0,20.0,20.0,20.0,20.0],
      [18.0, 3.0,12.0,20.0, 7.0, 20.0,20.0,20.0, 3.0,14.0, 20.0,20.0, 3.0,18.0, 0.9,  0.8, 0.0, 0.7, 0.8, 0.9],
      [20.0, 4.0,13.0, 6.0, 5.0, 20.0,20.0,20.0, 4.0,13.0,  5.0, 5.0, 4.0,20.0,20.0, 20.0,20.0,20.0,20.0,20.0],
      [20.0, 5.0,14.0,20.0, 4.0, 20.0,20.0,20.0, 5.0,12.0, 20.0,20.0, 6.0,20.0,20.0, 20.0,20.0,20.0,20.0,20.0],
      [20.0, 6.0,15.0,20.0, 3.0, 20.0,20.0,20.0, 6.0,11.0, 20.0,20.0, 7.0,20.0,20.0, 20.0,20.0,20.0,20.0,20.0],
      [20.0, 8.0,16.0,20.0, 2.0, 20.0,20.0,20.0, 7.0,10.0, 20.0,20.0, 8.0,20.0,20.0, 20.0,20.0, 5.0,20.0,20.0],
      [20.0, 9.0,17.0,20.0, 1.0, 20.0,20.0,20.0, 8.0, 9.0, 20.0,20.0, 9.0,20.0,20.0, 20.0, 4.0, 6.0,20.0,20.0],
      [20.0,20.0,20.0,20.0,20.0, 20.0,20.0,20.0,20.0,20.0, 20.0,20.0,20.0,20.0,20.0,  3.0, 7.0,20.0,20.0,20.0],
      [20.0,20.0,20.0,20.0,20.0, 20.0,20.0,20.0,20.0,20.0, 20.0,20.0,20.0,20.0, 2.0,  8.0,20.0,20.0,20.0,20.0],
      [20.0, 1.0,16.0,20.0, 2.0, 20.0,20.0,20.0,20.0,20.0, 20.0,20.0,20.0, 1.0, 9.0, 20.0,20.0,20.0,20.0,20.0],
      [20.0, 2.0,15.0,20.0, 3.0, 20.0,20.0,20.0,20.0,20.0, 20.0,20.0,20.0,10.0,20.0, 20.0,20.0,20.0,20.0,20.0],
      [20.0, 3.0,14.0,20.0, 4.0, 20.0,20.0, 1.0,20.0, 5.0, 20.0,20.0,20.0, 0.9,20.0, 20.0,20.0,20.0,20.0,20.0],
      [20.0, 4.0,13.0, 6.0, 5.0, 20.0,20.0, 2.0, 4.0, 3.0, 20.0,20.0, 0.8,20.0,20.0, 20.0,20.0,20.0,20.0,20.0],
      [20.0, 5.0,12.0,20.0, 7.0, 20.0,20.0, 3.0,20.0, 2.0, 20.0,20.0, 0.7,20.0,20.0, 20.0,20.0,20.0,20.0,20.0],
      [20.0, 6.0,11.0,20.0, 8.0, 20.0,20.0, 4.0,20.0, 1.0, 20.0,20.0, 0.6,20.0,20.0, 20.0,20.0,20.0,20.0,20.0],
      [20.0, 7.0,10.0,20.0, 9.0, 20.0,20.0, 6.0,20.0,20.0, 20.0,20.0, 0.5,20.0,20.0, 20.0,20.0,20.0,20.0,20.0],
      [20.0, 8.0, 9.0,20.0,10.0, 18.0, 0.9, 0.8,20.0,20.0, 20.0, 0.4,20.0,20.0,20.0, 20.0,20.0,20.0,20.0,20.0],
      [20.0,20.0,20.0,20.0,20.0, 20.0,20.0,20.0, 0.0, 0.2,  0.3,20.0,20.0,20.0,20.0, 20.0,20.0,20.0,20.0,20.0]],
      dtype=np.float64)
    raw_orography_in = np.array([
      [20.0,20.0,20.0,20.0,20.0, 20.0,20.0,20.0,20.0,20.0, 20.0,20.0,20.0,20.0,20.0, 20.0,20.0,20.0,20.0,20.0],
      [20.0, 1.0,10.0,20.0, 9.0, 20.0,20.0,20.0, 1.0,16.0, 20.0,20.0, 1.0,20.0,20.0, 20.0,20.0,20.0,20.0,20.0],
      [20.0, 2.0,11.0,20.0, 8.0, 20.0,20.0,20.0, 2.0,15.0, 20.0,20.0, 2.0,20.0,20.0, 20.0,20.0,20.0,20.0,20.0],
      [18.0, 3.0,12.0,20.0, 7.0, 20.0,20.0,20.0, 3.0,14.0, 20.0,20.0, 3.0,18.0, 0.9,  0.8, 0.0, 0.7, 0.8, 0.9],
      [20.0, 4.0,13.0,20.0, 5.0, 20.0,20.0,20.0, 4.0,13.0,  5.0, 5.0, 4.0,20.0,20.0, 20.0,20.0,20.0,20.0,20.0],
      [20.0, 5.0,14.0,20.0, 4.0, 20.0,20.0,20.0, 5.0,12.0, 20.0,20.0, 6.0,20.0,20.0, 20.0,20.0,20.0,20.0,20.0],
      [20.0, 6.0,15.0,20.0, 3.0, 20.0,20.0,20.0, 6.0,11.0, 20.0,20.0, 7.0,20.0,20.0, 20.0,20.0,20.0,20.0,20.0],
      [20.0, 8.0,16.0,20.0, 2.0, 20.0,20.0,20.0, 7.0,10.0, 20.0,20.0, 8.0,20.0,20.0, 20.0,20.0, 5.0,20.0,20.0],
      [20.0, 9.0,17.0,20.0, 1.0, 20.0,20.0,20.0, 8.0, 9.0, 20.0,20.0, 9.0,20.0,20.0, 20.0, 4.0, 6.0,20.0,20.0],
      [20.0,20.0,20.0,20.0,20.0, 20.0,20.0,20.0,20.0,20.0, 20.0,20.0,20.0,20.0,20.0,  3.0, 7.0,20.0,20.0,20.0],
      [20.0,20.0,20.0,20.0,20.0, 20.0,20.0,20.0,20.0,20.0, 20.0,20.0,20.0,20.0, 2.0,  8.0,20.0,20.0,20.0,20.0],
      [20.0, 1.0,16.0,20.0, 2.0, 20.0,20.0,20.0,20.0,20.0, 20.0,20.0,20.0, 1.0, 9.0, 20.0,20.0,20.0,20.0,20.0],
      [20.0, 2.0,15.0,20.0, 3.0, 20.0,20.0,20.0,20.0,20.0, 20.0,20.0,20.0,10.0,20.0, 20.0,20.0,20.0,20.0,20.0],
      [20.0, 3.0,14.0,20.0, 4.0, 20.0,20.0, 1.0,20.0, 5.0, 20.0,20.0,20.0, 0.9,20.0, 20.0,20.0,20.0,20.0,20.0],
      [20.0, 4.0,13.0,20.0, 5.0, 20.0,20.0, 2.0, 4.0, 3.0, 20.0,20.0, 0.8,20.0,20.0, 20.0,20.0,20.0,20.0,20.0],
      [20.0, 5.0,12.0,20.0, 7.0, 20.0,20.0, 3.0,20.0, 2.0, 20.0,20.0, 0.7,20.0,20.0, 20.0,20.0,20.0,20.0,20.0],
      [20.0, 6.0,11.0,20.0, 8.0, 20.0,20.0, 4.0,20.0, 1.0, 20.0,20.0, 0.6,20.0,20.0, 20.0,20.0,20.0,20.0,20.0],
      [20.0, 7.0,10.0,20.0, 9.0, 20.0,20.0, 6.0,20.0,20.0, 20.0,20.0, 0.5,20.0,20.0, 20.0,20.0,20.0,20.0,20.0],
      [20.0, 8.0, 9.0,20.0,10.0, 18.0, 0.9, 0.8,20.0,20.0, 20.0, 0.4,20.0,20.0,20.0, 20.0,20.0,20.0,20.0,20.0],
      [20.0,20.0,20.0,20.0,20.0, 20.0,20.0,20.0, 0.0, 0.2,  0.3,20.0,20.0,20.0,20.0, 20.0,20.0,20.0,20.0,20.0]],
      dtype=np.float64)
    minima_in = np.array([
      [False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False],
      [False, True,False,False,False,False,False,False, True,False,False,False, True,False,False,False,False,False,False,False],
      [False, False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False],
      [False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False],
      [False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False],
      [False,False,False,False,False,False,False,False,False,False,False,False,False,False, False,False,False,False,False,False],
      [False,False,False,False,False,False, False,False,False,False,False,False,False,False,False,False,False,False,False,False],
      [False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False],
      [False,False,False,False, True,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False],
      [False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False],
      [False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False],
      [False, True,False,False, True,False,False,False,False,False,False,False,False, True,False,False,False,False,False,False],
      [False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False],
      [False,False,False,False,False,False,False, True,False,False,False,False,False,False,False,False,False,False,False,False],
      [False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False],
      [False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False],
      [False,False,False,False,False,False,False,False,False, True,False,False,False,False,False,False,False,False,False,False],
      [False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False],
      [False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False],
      [False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False]],
      dtype=np.int32)
    prior_fine_rdirs_in = np.array([
      [1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,3.0,3.0,3.0,3.0,3.0,3.0,2.0,1.0,1.0,3.0,3.0,2.0],
      [2.0,1.0,2.0,1.0,1.0,2.0,1.0,1.0,1.0,3.0,3.0,3.0,2.0,3.0,2.0,1.0,1.0,3.0,3.0,3.0],
      [5.0,4.0,1.0,1.0,3.0,2.0,1.0,1.0,1.0,1.0,3.0,3.0,2.0,1.0,1.0,1.0,1.0,6.0,6.0,6.0],
      [8.0,7.0,4.0,4.0,3.0,2.0,1.0,1.0,2.0,1.0,6.0,3.0,2.0,1.0,1.0,1.0,1.0,1.0,9.0,9.0],
      [9.0,8.0,7.0,3.0,3.0,2.0,1.0,2.0,1.0,1.0,3.0,6.0,3.0,2.0,1.0,1.0,1.0,1.0,1.0,9.0],
      [9.0,8.0,7.0,3.0,3.0,2.0,1.0,1.0,1.0,1.0,3.0,3.0,6.0,5.0,4.0,4.0,1.0,1.0,1.0,3.0],
      [9.0,8.0,7.0,6.0,6.0,5.0,4.0,4.0,4.0,4.0,6.0,6.0,9.0,8.0,7.0,1.0,1.0,4.0,4.0,6.0],
      [9.0,9.0,8.0,9.0,9.0,8.0,7.0,7.0,7.0,7.0,9.0,9.0,8.0,7.0,5.0,4.0,4.0,7.0,7.0,9.0],
      [9.0,9.0,8.0,7.0,9.0,8.0,7.0,8.0,7.0,7.0,9.0,9.0,8.0,7.0,8.0,7.0,7.0,7.0,2.0,1.0],
      [9.0,9.0,8.0,9.0,9.0,8.0,7.0,7.0,7.0,9.0,9.0,9.0,8.0,7.0,7.0,7.0,7.0,7.0,2.0,1.0],
      [1.0,1.0,9.0,9.0,9.0,8.0,7.0,7.0,7.0,9.0,9.0,9.0,8.0,7.0,7.0,7.0,7.0,3.0,2.0,1.0],
      [1.0,3.0,3.0,2.0,1.0,1.0,1.0,1.0,9.0,9.0,9.0,9.0,8.0,3.0,3.0,2.0,1.0,3.0,2.0,1.0],
      [1.0,3.0,3.0,2.0,1.0,1.0,1.0,1.0,1.0,9.0,9.0,9.0,3.0,3.0,3.0,2.0,1.0,1.0,1.0,1.0],
      [4.0,3.0,3.0,2.0,1.0,1.0,1.0,1.0,1.0,9.0,9.0,3.0,6.0,6.0,6.0,5.0,4.0,4.0,4.0,4.0],
      [7.0,3.0,3.0,2.0,1.0,1.0,1.0,1.0,1.0,1.0,3.0,3.0,3.0,9.0,9.0,8.0,7.0,7.0,7.0,7.0],
      [7.0,3.0,6.0,5.0,4.0,1.0,1.0,1.0,1.0,1.0,3.0,3.0,3.0,3.0,9.0,8.0,7.0,7.0,7.0,7.0],
      [3.0,3.0,3.0,2.0,1.0,4.0,4.0,4.0,4.0,4.0,3.0,3.0,3.0,3.0,3.0,2.0,1.0,1.0,7.0,7.0],
      [3.0,3.0,3.0,2.0,1.0,7.0,7.0,7.0,7.0,7.0,3.0,3.0,3.0,3.0,3.0,2.0,1.0,1.0,1.0,7.0],
      [3.0,3.0,3.0,2.0,1.0,1.0,7.0,7.0,7.0,7.0,3.0,3.0,3.0,3.0,3.0,2.0,1.0,1.0,1.0,3.0],
      [6.0,6.0,6.0,0.0,4.0,4.0,4.0,7.0,7.0,7.0,6.0,6.0,6.0,6.0,6.0,0.0,4.0,4.0,4.0,6.0]],
      dtype=np.float64)
    prior_coarse_rdirs_in = np.array([[5.0,5.0,5.0,5.0],
                                      [5.0,5.0,5.0,5.0],
                                      [5.0,5.0,5.0,5.0],
                                      [5.0,5.0,5.0,5.0]],
                                      dtype=np.float64)
    prior_fine_catchments_in = np.array([
      [11,11,11,11,11,11,13,13,12,12,12,12,12,12,12,12,12,11,11,11],
      [11,11,11,11,11,13,13,13,13,12,12,12,12,12,12,12,12,11,11,11],
      [11,11,11,11,13,13,13,13,13,13,12,12,12,12,12,12,12,11,11,11],
      [11,11,11,11,13,13,13,13,13,13,12,12,12,12,12,12,12,12,11,11],
      [11,11,11,13,13,13,13,13,13,13,12,12,12,12,12,12,12,14,14,11],
      [11,11,11,13,13,13,13,13,13,13,12,12,12,12,12,12,14,14,14,11],
      [11,11,11,13,13,13,13,13,13,13,12,12,12,12,12,14,14,14,14,11],
      [11,11,11,13,13,13,13,13,13,13,12,12,12,12,14,14,14,14,14,11],
      [11,11,11,11,13,13,13,13,13,13,12,12,12,12,14,14,14,14,15,15],
      [11,11,11,13,13,13,13,13,13,12,12,12,12,12,12,14,14,14,15,15],
      [15,15,13,13,13,13,13,13,13,12,12,12,12,12,12,12,14,15,15,15],
      [15,16,16,16,16,16,16,16,12,12,12,12,12,15,15,15,15,15,15,15],
      [15,16,16,16,16,16,16,16, 4,12,12,12,15,15,15,15,15,15,15,15],
      [15,16,16,16,16,16,16, 4, 4,12,12, 9,15,15,15,15,15,15,15,15],
      [15,16,16,16,16,16, 4, 4, 4, 4,10, 9, 9,15,15,15,15,15,15,15],
      [15, 4,16,16,16, 4, 4, 4, 4, 4, 7,10, 9, 9,15,15,15,15,15,15],
      [5, 4, 4, 4, 4, 4, 4, 4, 4, 4, 7, 7,10, 9, 9, 9, 9, 9,15,15],
      [2, 5, 4, 4, 4, 4, 4, 4, 4, 4, 7, 7, 7,10, 9, 9, 9, 8, 6,15],
      [2, 2, 5, 4, 3, 1, 4, 4, 4, 4, 7, 7, 7, 7,10, 9, 8, 6, 6, 2],
      [2, 2, 2, 0, 1, 1, 1, 4, 4, 4, 7, 7, 7, 7, 7, 0, 6, 6, 6, 2]],
      dtype=np.int32)
    cell_areas_in = np.array([[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],
                              [2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2],
                              [3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3],
                              [4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4],
                              [5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],
                              [6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6],
                              [7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7],
                              [8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8],
                              [9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9],
                              [10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10],
                              [10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10],
                              [9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9],
                              [8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8],
                              [7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7],
                              [6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6],
                              [5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],
                              [4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4],
                              [3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3],
                              [2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2],
                              [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]],
                              dtype=np.float64)
    landsea_in = np.array([
      [False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False],
      [False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False],
      [False, False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False],
      [False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,True,False,False,False],
      [False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False],
      [False,False,False,False,False,False,False,False,False,False,False,False,False,False, False,False,False,False,False,False],
      [False,False,False,False,False,False, False,False,False,False,False,False,False,False,False,False,False,False,False,False],
      [False,False,False,False,False,False,False,False,False,False,False,False,False,False,False, False,False,False,False,False],
      [False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False],
      [False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False],
      [False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False],
      [False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False],
      [False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False],
      [False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False],
      [False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False],
      [False,False,False,False, False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False],
      [False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False],
      [False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False],
      [False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False],
      [False,False,False,False,False,False,False,False, True,False,False,False,False,False,False,False,False,False,False,False]],
      dtype=np.int32)
    cell_areas_in = np.full((20,20),1.0)
    output,alg = \
      LatLonEvaluateBasin.evaluate_basins(landsea_in,
                                          minima_in,
                                          raw_orography_in,
                                          corrected_orography_in,
                                          cell_areas_in,
                                          prior_fine_rdirs_in,
                                          prior_fine_catchments_in,
                                          coarse_catchment_nums_in,
                                          return_algorithm_object=True)
    expected_lake_mask = np.array([
       [False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False,
        False, False],
       [False,  True,  True, False,  True, False, False, False,  True,
         True, False, False,  True, False, False, False, False, False,
        False, False],
       [False,  True,  True, False,  True, False, False, False,  True,
         True, False, False,  True, False, False, False, False, False,
        False, False],
       [False,  True,  True, False,  True, False, False, False,  True,
         True, False, False,  True, False, False, False, False, False,
        False, False],
       [False,  True,  True,  True,  True, False, False, False,  True,
         True,  True,  True,  True, False, False, False, False, False,
        False, False],
       [False,  True,  True, False,  True, False, False, False,  True,
         True, False, False,  True, False, False, False, False, False,
        False, False],
       [False,  True,  True, False,  True, False, False, False,  True,
         True, False, False,  True, False, False, False, False, False,
        False, False],
       [False,  True,  True, False,  True, False, False, False,  True,
         True, False, False,  True, False, False, False, False,  True,
        False, False],
       [False,  True,  True, False,  True, False, False, False,  True,
         True, False, False,  True, False, False, False,  True,  True,
        False, False],
       [False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False,  True,  True, False,
        False, False],
       [False, False, False, False, False, False, False, False, False,
        False, False, False, False, False,  True,  True, False, False,
        False, False],
       [False,  True,  True, False,  True, False, False, False, False,
        False, False, False, False,  True,  True, False, False, False,
        False, False],
       [False,  True,  True, False,  True, False, False, False, False,
        False, False, False, False, False, False, False, False, False,
        False, False],
       [False,  True,  True, False,  True, False, False,  True, False,
         True, False, False, False, False, False, False, False, False,
        False, False],
       [False,  True,  True,  True,  True, False, False,  True,  True,
         True, False, False, False, False, False, False, False, False,
        False, False],
       [False,  True,  True, False,  True, False, False,  True, False,
         True, False, False, False, False, False, False, False, False,
        False, False],
       [False,  True,  True, False,  True, False, False,  True, False,
         True, False, False, False, False, False, False, False, False,
        False, False],
       [False,  True,  True, False,  True, False, False, False, False,
        False, False, False, False, False, False, False, False, False,
        False, False],
       [False,  True,  True, False,  True, False, False, False, False,
        False, False, False, False, False, False, False, False, False,
        False, False],
       [False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False,
        False, False]])
    expected_lakes_as_array = \
      [13.0, 26.0, 1.0, 11.0, 0.0, 17.0, 10.0, 3.0, 17.0, 10.0, 1.0, 1.0, 2.0, 16.0, 10.0,
       1.0, 3.0, 3.0, 15.0, 10.0, 1.0, 6.0, 4.0, 1.0, 2.0, 4.0, 2.0, 0.0, 26.0, 2.0,
       11.0, 0.0, 14.0, 8.0, 3.0, 14.0, 8.0, 1.0, 1.0, 2.0, 15.0, 8.0, 1.0, 3.0, 3.0,
       16.0, 8.0, 1.0, 6.0, 4.0, 1.0, 1.0, -1.0, -1.0, 1.0, 56.0, 3.0, -1.0, 0.0, 12.0,
       14.0, 9.0, 12.0, 14.0, 1.0, 1.0, 2.0, 11.0, 15.0, 1.0, 3.0, 3.0, 10.0, 16.0, 1.0,
       6.0, 4.0, 9.0, 17.0, 1.0, 10.0, 5.0, 8.0, 18.0, 1.0, 15.0, 6.0, 9.0, 18.0, 1.0,
       21.0, 7.0, 10.0, 17.0, 1.0, 28.0, 8.0, 11.0, 16.0, 1.0, 36.0, 9.0, 12.0, 15.0, 1.0,
       45.0, 10.0, 1.0, -1.0, 3.0, 4.0, 0.0, 56.0, 4.0, 12.0, 0.0, 12.0, 5.0, 9.0, 12.0,
       5.0, 1.0, 1.0, 3.0, 13.0, 5.0, 1.0, 3.0, 4.0, 14.0, 5.0, 1.0, 6.0, 5.0, 15.0,
       5.0, 1.0, 10.0, 6.0, 15.0, 4.0, 2.0, 14.0, 7.0, 16.0, 5.0, 1.0, 19.0, 8.0, 17.0,
       5.0, 1.0, 25.0, 9.0, 18.0, 5.0, 1.0, 32.0, 10.0, 19.0, 5.0, 1.0, 48.0, 12.0, 1.0,
       5.0, 4.0, 1.0, 0.0, 66.0, 5.0, 12.0, 0.0, 12.0, 2.0, 11.0, 12.0, 2.0, 1.0, 1.0,
       2.0, 13.0, 2.0, 1.0, 3.0, 3.0, 14.0, 2.0, 1.0, 6.0, 4.0, 15.0, 2.0, 1.0, 10.0,
       5.0, 16.0, 2.0, 1.0, 15.0, 6.0, 17.0, 2.0, 1.0, 21.0, 7.0, 18.0, 2.0, 1.0, 28.0,
       8.0, 19.0, 2.0, 1.0, 36.0, 9.0, 19.0, 3.0, 1.0, 45.0, 10.0, 18.0, 3.0, 1.0, 55.0,
       11.0, 17.0, 3.0, 1.0, 66.0, 12.0, 1.0, 4.0, -1.0, -1.0, 1.0, 56.0, 6.0, 10.0, 0.0,
       9.0, 5.0, 9.0, 9.0, 5.0, 1.0, 1.0, 2.0, 8.0, 5.0, 1.0, 3.0, 3.0, 7.0, 5.0,
       1.0, 6.0, 4.0, 6.0, 5.0, 1.0, 10.0, 5.0, 5.0, 5.0, 1.0, 15.0, 6.0, 5.0, 4.0,
       2.0, 20.0, 7.0, 4.0, 5.0, 1.0, 26.0, 8.0, 3.0, 5.0, 1.0, 33.0, 9.0, 2.0, 5.0,
       1.0, 57.0, 12.0, 1.0, 9.0, -1.0, -1.0, 1.0, 61.0, 7.0, 13.0, 0.0, 2.0, 13.0, 10.0,
       2.0, 13.0, 1.0, 1.0, 2.0, 3.0, 13.0, 1.0, 3.0, 3.0, 4.0, 13.0, 1.0, 6.0, 4.0,
       5.0, 13.0, 1.0, 10.0, 5.0, 5.0, 12.0, 1.0, 10.0, 5.0, 5.0, 11.0, 1.0, 16.0, 6.0,
       6.0, 13.0, 1.0, 23.0, 7.0, 7.0, 13.0, 1.0, 31.0, 8.0, 8.0, 13.0, 1.0, 40.0, 9.0,
       9.0, 13.0, 1.0, 70.0, 12.0, 1.0, 8.0, 2.0, 2.0, 0.0, 66.0, 8.0, 13.0, 0.0, 2.0,
       9.0, 11.0, 2.0, 9.0, 1.0, 1.0, 2.0, 3.0, 9.0, 1.0, 3.0, 3.0, 4.0, 9.0, 1.0,
       6.0, 4.0, 5.0, 9.0, 1.0, 10.0, 5.0, 6.0, 9.0, 1.0, 15.0, 6.0, 7.0, 9.0, 1.0,
       21.0, 7.0, 8.0, 9.0, 1.0, 28.0, 8.0, 9.0, 9.0, 1.0, 36.0, 9.0, 9.0, 10.0, 1.0,
       45.0, 10.0, 8.0, 10.0, 1.0, 55.0, 11.0, 7.0, 10.0, 1.0, 66.0, 12.0, 1.0, 7.0, -1.0,
       -1.0, 1.0, 61.0, 9.0, 10.0, 0.0, 2.0, 2.0, 10.0, 2.0, 2.0, 1.0, 1.0, 2.0, 3.0,
       2.0, 1.0, 3.0, 3.0, 4.0, 2.0, 1.0, 6.0, 4.0, 5.0, 2.0, 1.0, 10.0, 5.0, 6.0,
       2.0, 1.0, 15.0, 6.0, 7.0, 2.0, 1.0, 27.0, 8.0, 8.0, 2.0, 1.0, 34.0, 9.0, 9.0,
       2.0, 1.0, 42.0, 10.0, 2.0, 3.0, 1.0, 51.0, 11.0, 3.0, 3.0, 1.0, 61.0, 12.0, 1.0,
       6.0, 1.0, 1.0, 0.0, 138.0, 10.0, -1.0, 2.0, 9.0, 6.0, 2.0, 2.0, 25.0, 2.0, 2.0,
       1.0, 0.0, 12.0, 3.0, 3.0, 1.0, 0.0, 12.0, 2.0, 3.0, 1.0, 0.0, 12.0, 4.0, 3.0,
       1.0, 0.0, 12.0, 4.0, 2.0, 1.0, 0.0, 12.0, 5.0, 4.0, 2.0, 0.0, 12.0, 5.0, 2.0,
       1.0, 0.0, 12.0, 6.0, 5.0, 1.0, 0.0, 12.0, 3.0, 2.0, 1.0, 0.0, 12.0, 7.0, 5.0,
       1.0, 0.0, 12.0, 5.0, 5.0, 1.0, 0.0, 12.0, 8.0, 5.0, 1.0, 0.0, 12.0, 6.0, 2.0,
       1.0, 0.0, 12.0, 9.0, 5.0, 1.0, 0.0, 12.0, 7.0, 2.0, 1.0, 0.0, 12.0, 4.0, 5.0,
       1.0, 0.0, 12.0, 8.0, 2.0, 1.0, 0.0, 12.0, 3.0, 5.0, 1.0, 0.0, 12.0, 9.0, 2.0,
       1.0, 0.0, 12.0, 2.0, 5.0, 1.0, 19.0, 13.0, 5.0, 3.0, 1.0, 39.0, 14.0, 6.0, 3.0,
       1.0, 60.0, 15.0, 7.0, 3.0, 1.0, 82.0, 16.0, 8.0, 3.0, 1.0, 105.0, 17.0, 9.0, 3.0,
       1.0, 129.0, 18.0, 1.0, -1.0, 2.0, 1.0, 0.0, 58.0, 11.0, -1.0, 2.0, 1.0, 2.0, 17.0,
       10.0, 9.0, 17.0, 10.0, 1.0, 0.0, 4.0, 16.0, 10.0, 1.0, 0.0, 4.0, 15.0, 10.0, 1.0,
       0.0, 4.0, 15.0, 9.0, 1.0, 0.0, 4.0, 16.0, 8.0, 1.0, 0.0, 4.0, 15.0, 8.0, 1.0,
       0.0, 4.0, 14.0, 8.0, 1.0, 0.0, 4.0, 17.0, 8.0, 1.0, 8.0, 5.0, 14.0, 10.0, 1.0,
       17.0, 6.0, 1.0, -1.0, 4.0, 2.0, 0.0, 138.0, 12.0, -1.0, 2.0, 4.0, 5.0, 12.0, 5.0,
       25.0, 12.0, 5.0, 1.0, 0.0, 12.0, 13.0, 5.0, 1.0, 0.0, 12.0, 14.0, 5.0, 1.0, 0.0,
       12.0, 15.0, 5.0, 1.0, 0.0, 12.0, 15.0, 4.0, 2.0, 0.0, 12.0, 16.0, 5.0, 1.0, 0.0,
       12.0, 16.0, 3.0, 1.0, 0.0, 12.0, 17.0, 5.0, 1.0, 0.0, 12.0, 17.0, 3.0, 1.0, 0.0,
       12.0, 17.0, 2.0, 1.0, 0.0, 12.0, 18.0, 3.0, 1.0, 0.0, 12.0, 18.0, 2.0, 1.0, 0.0,
       12.0, 19.0, 3.0, 1.0, 0.0, 12.0, 19.0, 2.0, 1.0, 0.0, 12.0, 15.0, 2.0, 1.0, 0.0,
       12.0, 18.0, 5.0, 1.0, 0.0, 12.0, 14.0, 2.0, 1.0, 0.0, 12.0, 16.0, 2.0, 1.0, 0.0,
       12.0, 19.0, 5.0, 1.0, 0.0, 12.0, 13.0, 2.0, 1.0, 0.0, 12.0, 12.0, 2.0, 1.0, 20.0,
       13.0, 15.0, 3.0, 1.0, 41.0, 14.0, 14.0, 3.0, 1.0, 63.0, 15.0, 13.0, 3.0, 1.0, 86.0,
       16.0, 12.0, 3.0, 1.0, 134.0, 18.0, 1.0, -1.0, 4.0, 2.0, 0.0, 143.0, 13.0, -1.0, 2.0,
       7.0, 8.0, 2.0, 13.0, 26.0, 2.0, 13.0, 1.0, 0.0, 12.0, 3.0, 13.0, 1.0, 0.0, 12.0,
       4.0, 13.0, 1.0, 0.0, 12.0, 5.0, 13.0, 1.0, 0.0, 12.0, 5.0, 12.0, 1.0, 0.0, 12.0,
       6.0, 13.0, 1.0, 0.0, 12.0, 5.0, 11.0, 1.0, 0.0, 12.0, 7.0, 13.0, 1.0, 0.0, 12.0,
       6.0, 10.0, 1.0, 0.0, 12.0, 8.0, 13.0, 1.0, 0.0, 12.0, 7.0, 9.0, 1.0, 0.0, 12.0,
       6.0, 9.0, 1.0, 0.0, 12.0, 5.0, 9.0, 1.0, 0.0, 12.0, 8.0, 10.0, 1.0, 0.0, 12.0,
       8.0, 9.0, 1.0, 0.0, 12.0, 9.0, 13.0, 1.0, 0.0, 12.0, 7.0, 10.0, 1.0, 0.0, 12.0,
       4.0, 9.0, 1.0, 0.0, 12.0, 9.0, 9.0, 1.0, 0.0, 12.0, 9.0, 10.0, 1.0, 0.0, 12.0,
       3.0, 9.0, 1.0, 0.0, 12.0, 2.0, 9.0, 1.0, 22.0, 13.0, 5.0, 10.0, 1.0, 45.0, 14.0,
       4.0, 10.0, 1.0, 69.0, 15.0, 3.0, 10.0, 1.0, 94.0, 16.0, 2.0, 10.0, 1.0, 146.0, 18.0,
       1.0, -1.0, 1.0, 3.0, 0.0]
    self.assertEqual(output["number_of_lakes"],13)
    self.assertEqual(output["lakes_as_array"],expected_lakes_as_array)
    np.testing.assert_array_equal(output["lake_mask"],expected_lake_mask)

  # def testEvaluateBasinsFour(self):
  #   cell_neighbors = np.array([[5,7,2],
  #                              [1,10,3],
  #                              [2,13,4],
  #                              [3,16,5],
  #                              [4,19,1],
  #                              [20,21,7],
  #                              [1,6,8],
  #                              [7,23,9],
  #                              [8,25,10],
  #                              [2,9,11],
  #                              [10,27,12],
  #                              [11,29,13],
  #                              [3,12,14],
  #                              [13,31,15],
  #                              [14,33,16],
  #                              [4,15,17],
  #                              [16,35,18],
  #                              [17,37,19],
  #                              [5,18,20],
  #                              [19,39,6],
  #                              [6,40,22],
  #                              [21,41,23],
  #                              [8,22,24],
  #                              [23,43,25],
  #                              [24,26,9],
  #                              [25,45,27],
  #                              [11,26,28],
  #                              [27,47,29],
  #                              [12,28,30],
  #                              [29,49,31],
  #                              [14,30,32],
  #                              [31,51,33],
  #                              [15,32,34],
  #                              [33,53,35],
  #                              [17,34,36],
  #                              [35,55,37],
  #                              [18,36,38],
  #                              [37,57,39],
  #                              [20,38,40],
  #                              [39,59,21],
  #                              [22,60,42],
  #                              [41,61,43],
  #                              [24,42,44],
  #                              [43,63,45],
  #                              [26,44,46],
  #                              [45,64,47],
  #                              [28,46,48],
  #                              [47,66,49],
  #                              [30,48,50],
  #                              [49,67,51],
  #                              [32,50,52],
  #                              [51,69,53],
  #                              [34,52,54],
  #                              [53,70,55],
  #                              [36,54,56],
  #                              [55,72,57],
  #                              [38,56,58],
  #                              [57,73,59],
  #                              [40,58,60],
  #                              [59,75,41],
  #                              [42,75,62],
  #                              [61,76,63],
  #                              [44,62,64],
  #                              [46,63,65],
  #                              [64,77,66],
  #                              [48,65,67],
  #                              [50,66,68],
  #                              [67,78,69],
  #                              [52,68,70],
  #                              [54,69,71],
  #                              [70,79,72],
  #                              [56,71,73],
  #                              [58,72,74],
  #                              [73,80,75],
  #                              [60,74,61],
  #                              [62,80,77],
  #                              [65,76,78],
  #                              [68,77,79],
  #                              [71,78,80],
  #                              [74,79,76]],
  #                              dtype=np.int32)
  #   prior_fine_rdirs_in = np.array([[8],
  #                                   [13],
  #                                   [13],
  #                                   [13],
  #                                   [19],
  #                                   [8],
  #                                   [8],
  #                                   [24],
  #                                   [24],
  #                                   [13],
  #                                   [13],
  #                                   [13],
  #                                   [-2],
  #                                   [13],
  #                                   [13],
  #                                   [13],
  #                                   [36],
  #                                   [36],
  #                                   [37],
  #                                   [37],
  #                                   [8],
  #                                   [24],
  #                                   [24],
  #                                   [64],
  #                                   [45],
  #                                   [45],
  #                                   [45],
  #                                   [49],
  #                                   [49],
  #                                   [13],
  #                                   [13],
  #                                   [30],
  #                                   [52],
  #                                   [55],
  #                                   [55],
  #                                   [55],
  #                                   [55],
  #                                   [55],
  #                                   [37],
  #                                   [38],
  #                                   [61],
  #                                   [61],
  #                                   [64],
  #                                   [64],
  #                                   [64],
  #                                   [64],
  #                                   [64],
  #                                   [64],
  #                                   [-2],
  #                                   [49],
  #                                   [30],
  #                                   [54],
  #                                   [55],
  #                                   [55],
  #                                   [0],
  #                                   [55],
  #                                   [55],
  #                                   [38],
  #                                   [38],
  #                                   [59],
  #                                   [63],
  #                                   [64],
  #                                   [64],
  #                                   [-2],
  #                                   [64],
  #                                   [38],
  #                                   [49],
  #                                   [52],
  #                                   [55],
  #                                   [55],
  #                                   [55],
  #                                   [55],
  #                                   [56],
  #                                   [58],
  #                                   [58],
  #                                   [64],
  #                                   [64],
  #                                   [68],
  #                                   [71],
  #                                   [71]],
  #                                   dtype=np.int32)
  #   prior_coarse_rdirs_in = prior_fine_rdirs_in.copy()
  #   raw_orography_in = np.array([[10.0],
  #                                [10.0],
  #                                [10.0],
  #                                [10.0],
  #                                [10.0],
  #                                [10.0],
  #                                [10.0],
  #                                [10.0],
  #                                [10.0],
  #                                [10.0],
  #                                [10.0],
  #                                [10.0],
  #                                [3.0],
  #                                [10.0],
  #                                [10.0],
  #                                [10.0],
  #                                [10.0],
  #                                [10.0],
  #                                [10.0],
  #                                [10.0],
  #                                [10.0],
  #                                [10.0],
  #                                [10.0],
  #                                [10.0],
  #                                [10.0],
  #                                [10.0],
  #                                [10.0],
  #                                [10.0],
  #                                [10.0],
  #                                [6.0],
  #                                [10.0],
  #                                [10.0],
  #                                [10.0],
  #                                [10.0],
  #                                [10.0],
  #                                [10.0],
  #                                [10.0],
  #                                [10.0],
  #                                [10.0],
  #                                [10.0],
  #                                [10.0],
  #                                [10.0],
  #                                [10.0],
  #                                [10.0],
  #                                [4.0],
  #                                [4.0],
  #                                [7.0],
  #                                [10.0],
  #                                [5.0],
  #                                [9.0],
  #                                [10.0],
  #                                [8.0],
  #                                [10.0],
  #                                [6.0],
  #                                [0.0],
  #                                [10.0],
  #                                [10.0],
  #                                [10.0],
  #                                [10.0],
  #                                [10.0],
  #                                [10.0],
  #                                [10.0],
  #                                [4.0],
  #                                [3.0],
  #                                [10.0],
  #                                [10.0],
  #                                [10.0],
  #                                [10.0],
  #                                [10.0],
  #                                [10.0],
  #                                [10.0],
  #                                [10.0],
  #                                [10.0],
  #                                [10.0],
  #                                [10.0],
  #                                [5.0],
  #                                [10.0],
  #                                [10.0],
  #                                [10.0],
  #                                [10.0]],
  #                                dtype=np.float64)
  #   corrected_orography_in = raw_orography_in.copy()
  #   minima_in = np.array([[False],
  #                         [False],
  #                         [False],
  #                         [False],
  #                         [False],
  #                         [False],
  #                         [False],
  #                         [False],
  #                         [False],
  #                         [False],
  #                         [False],
  #                         [False],
  #                         [True],
  #                         [False],
  #                         [False],
  #                         [False],
  #                         [False],
  #                         [False],
  #                         [False],
  #                         [False],
  #                         [False],
  #                         [False],
  #                         [False],
  #                         [False],
  #                         [False],
  #                         [False],
  #                         [False],
  #                         [False],
  #                         [False],
  #                         [False],
  #                         [False],
  #                         [False],
  #                         [False],
  #                         [False],
  #                         [False],
  #                         [False],
  #                         [False],
  #                         [False],
  #                         [False],
  #                         [False],
  #                         [False],
  #                         [False],
  #                         [False],
  #                         [False],
  #                         [False],
  #                         [False],
  #                         [False],
  #                         [False],
  #                         [True],
  #                         [False],
  #                         [False],
  #                         [False],
  #                         [False],
  #                         [False],
  #                         [False],
  #                         [False],
  #                         [False],
  #                         [False],
  #                         [False],
  #                         [False],
  #                         [False],
  #                         [False],
  #                         [False],
  #                         [True],
  #                         [False],
  #                         [False],
  #                         [False],
  #                         [False],
  #                         [False],
  #                         [False],
  #                         [False],
  #                         [False],
  #                         [False],
  #                         [False],
  #                         [False],
  #                         [False],
  #                         [False],
  #                         [False],
  #                         [False],
  #                         [False]],
  #                         dtype=np.int32)
  #   catchments_from_sink_filling_in = np.zeros((80),dtype=np.int32)
  #   fill_sinks_cpp_func(orography_array=
  #                       corrected_orography_in,
  #                       method = 4,
  #                       use_ls_mask = False,
  #                       landsea_in = np.full((80),0,dtype=np.int32),
  #                       set_ls_as_no_data_flag = False,
  #                       use_true_sinks = False,
  #                       true_sinks_in = np.zeros((80),dtype=np.int32),
  #                       rdirs_in = np.zeros((80),dtype=np.float64),
  #                       next_cell_lat_index_in = np.zeros((80),dtype=np.int32),
  #                       next_cell_lon_index_in = np.zeros((80),dtype=np.int32),
  #                       catchment_nums_in = catchments_from_sink_filling_in,
  #                       prefer_non_diagonal_initial_dirs = False)
  #   alg = SingleIndexBasinEvaluationAlgorithm(minima_in,
  #                                             raw_orography_in,
  #                                             corrected_orography_in,
  #                                             cell_areas_in,
  #                                             prior_fine_rdirs_in,
  #                                             prior_fine_catchments_in,
  #                                             coarse_catchment_nums_in,
  #                                             catchments_from_sink_filling_in)
  #   alg.evaluate_basins()
  #   print("---")
  #   print([lake.filling_order for lake in alg.lakes])
  #   print([lake.primary_lake for lake in alg.lakes])
  #   print([lake.spill_points for lake in alg.lakes])
  #   print([lake.outflow_points for lake in alg.lakes])

  def testEvaluateBasinsFive(self):
    coarse_catchment_nums_in = np.array([[5,5,5,5],
                                         [2,2,5,5],
                                         [5,4,8,8],
                                         [8,7,4,0]],
                                         dtype=np.int32)
    corrected_orography_in = np.array([
      [9.0,9.0,9.0,9.0,9.0, 9.0,9.0,9.0,9.0,9.0, 9.0,9.0,9.0,9.0,9.0, 9.0,9.0,9.0,9.0,9.0],
      [9.0,9.0,9.0,3.0,3.0, 3.0,9.0,1.0,1.0,9.0, 1.0,1.0,1.0,1.0,9.0, 9.0,2.0,2.0,2.0,9.0],
      [9.0,1.0,9.0,3.0,3.0, 3.0,6.0,1.0,1.0,1.0, 1.0,1.0,1.0,1.0,7.0, 7.0,2.0,2.0,2.0,9.0],
      [9.0,1.0,9.0,3.0,3.0, 3.0,9.0,1.0,1.0,1.0, 1.0,1.0,1.0,1.0,9.0, 9.0,2.0,2.0,2.0,9.0],
      [9.0,1.0,9.0,9.0,9.0, 9.0,9.0,9.0,9.0,9.0, 9.0,1.0,1.0,1.0,9.0, 9.0,2.0,2.0,2.0,9.0],
      [9.0,1.0,9.0,9.0,9.0, 9.0,9.0,9.0,9.0,9.0, 9.0,1.0,1.0,1.0,9.0, 9.0,9.0,6.0,9.0,9.0],
      [9.0,1.0,9.0,9.0,9.0, 9.0,9.0,9.0,9.0,9.0, 9.0,9.0,5.0,9.0,9.0, 9.0,3.0,3.0,3.0,9.0],
      [9.0,1.0,9.0,9.0,9.0, 9.0,9.0,9.0,9.0,9.0, 9.0,4.0,4.0,4.0,9.0, 9.0,3.0,3.0,3.0,9.0],
      [9.0,1.0,9.0,9.0,9.0, 9.0,9.0,9.0,9.0,9.0, 9.0,4.0,4.0,4.0,9.0, 9.0,3.0,3.0,3.0,9.0],
      [9.0,1.0,9.0,9.0,9.0, 9.0,9.0,9.0,9.0,9.0, 9.0,4.0,4.0,4.0,9.0, 9.0,3.0,3.0,3.0,9.0],
      [9.0,1.0,9.0,9.0,9.0, 9.0,9.0,9.0,9.0,9.0, 9.0,4.0,4.0,4.0,9.0, 9.0,3.0,3.0,3.0,9.0],
      [9.0,1.0,9.0,9.0,9.0, 9.0,9.0,9.0,9.0,9.0, 9.0,4.0,4.0,4.0,9.0, 9.0,3.0,3.0,3.0,9.0],
      [9.0,1.0,9.0,9.0,9.0, 9.0,9.0,9.0,9.0,9.0, 9.0,4.0,4.0,4.0,9.0, 9.0,3.0,3.0,3.0,9.0],
      [9.0,7.0,9.0,9.0,9.0, 9.0,9.0,9.0,9.0,9.0, 9.0,9.0,9.0,9.0,9.0, 9.0,9.0,9.0,8.0,9.0],
      [9.0,6.0,6.0,6.0,6.0, 6.0,6.0,6.0,6.0,6.0, 9.0,9.0,9.0,9.0,7.0, 7.0,7.0,7.0,7.0,7.0],
      [9.0,6.0,6.0,6.0,6.0, 6.0,6.0,6.0,6.0,6.0, 6.0,6.0,6.0,9.0,7.0, 0.0,0.0,0.0,0.0,0.0],
      [9.0,6.0,6.0,6.0,6.0, 6.0,6.0,6.0,6.0,6.0, 6.0,6.0,6.0,9.0,7.0, 0.0,0.0,0.0,0.0,0.0],
      [9.0,6.0,6.0,6.0,6.0, 6.0,6.0,6.0,6.0,6.0, 6.0,6.0,6.0,8.0,7.0, 0.0,0.0,0.0,0.0,0.0],
      [9.0,9.0,9.0,9.0,9.0, 9.0,9.0,9.0,9.0,9.0, 9.0,9.0,9.0,9.0,7.0, 0.0,0.0,0.0,0.0,0.0],
      [9.0,9.0,9.0,9.0,9.0, 9.0,9.0,9.0,9.0,9.0, 9.0,9.0,9.0,9.0,7.0, 0.0,0.0,0.0,0.0,0.0]],
      dtype=np.float64)
    raw_orography_in = np.array([
      [9.0,9.0,9.0,9.0,9.0, 9.0,9.0,9.0,9.0,9.0, 9.0,9.0,9.0,9.0,9.0, 9.0,9.0,9.0,9.0,9.0],
      [9.0,9.0,9.0,3.0,3.0, 3.0,9.0,1.0,1.0,9.0, 1.0,1.0,1.0,1.0,9.0, 9.0,2.0,2.0,2.0,9.0],
      [9.0,1.0,9.0,3.0,3.0, 3.0,6.0,1.0,1.0,1.0, 1.0,1.0,1.0,1.0,7.0, 7.0,2.0,2.0,2.0,9.0],
      [9.0,1.0,9.0,3.0,3.0, 3.0,9.0,1.0,1.0,1.0, 1.0,1.0,1.0,1.0,9.0, 9.0,2.0,2.0,2.0,9.0],
      [9.0,1.0,9.0,9.0,9.0, 9.0,9.0,9.0,9.0,9.0, 9.0,1.0,1.0,1.0,9.0, 9.0,2.0,2.0,2.0,9.0],
      [9.0,1.0,9.0,9.0,9.0, 9.0,9.0,9.0,9.0,9.0, 9.0,1.0,1.0,1.0,9.0, 9.0,9.0,6.0,9.0,9.0],
      [9.0,1.0,9.0,9.0,9.0, 9.0,9.0,9.0,9.0,9.0, 9.0,9.0,5.0,9.0,9.0, 9.0,3.0,3.0,3.0,9.0],
      [9.0,1.0,9.0,9.0,9.0, 9.0,9.0,9.0,9.0,9.0, 9.0,4.0,4.0,4.0,9.0, 9.0,3.0,3.0,3.0,9.0],
      [9.0,1.0,9.0,9.0,9.0, 9.0,9.0,9.0,9.0,9.0, 9.0,4.0,4.0,4.0,9.0, 9.0,3.0,3.0,3.0,9.0],
      [9.0,1.0,9.0,9.0,9.0, 9.0,9.0,9.0,9.0,9.0, 9.0,4.0,4.0,4.0,9.0, 9.0,3.0,3.0,3.0,9.0],
      [9.0,1.0,9.0,9.0,9.0, 9.0,9.0,9.0,9.0,9.0, 9.0,4.0,4.0,4.0,9.0, 9.0,3.0,3.0,3.0,9.0],
      [9.0,1.0,9.0,9.0,9.0, 9.0,9.0,9.0,9.0,9.0, 9.0,4.0,4.0,4.0,9.0, 9.0,3.0,3.0,3.0,9.0],
      [9.0,1.0,9.0,9.0,9.0, 9.0,9.0,9.0,9.0,9.0, 9.0,4.0,4.0,4.0,9.0, 9.0,3.0,3.0,3.0,9.0],
      [9.0,9.0,9.0,9.0,9.0, 9.0,9.0,9.0,9.0,9.0, 9.0,9.0,9.0,9.0,9.0, 9.0,9.0,9.0,8.0,9.0],
      [9.0,6.0,6.0,6.0,6.0, 6.0,6.0,6.0,6.0,6.0, 9.0,9.0,9.0,9.0,7.0, 7.0,7.0,7.0,7.0,7.0],
      [9.0,6.0,6.0,6.0,6.0, 6.0,6.0,6.0,6.0,6.0, 6.0,6.0,6.0,9.0,7.0, 0.0,0.0,0.0,0.0,0.0],
      [9.0,6.0,6.0,6.0,6.0, 6.0,6.0,6.0,6.0,6.0, 6.0,6.0,6.0,9.0,7.0, 0.0,0.0,0.0,0.0,0.0],
      [9.0,6.0,6.0,6.0,6.0, 6.0,6.0,6.0,6.0,6.0, 6.0,6.0,6.0,8.0,7.0, 0.0,0.0,0.0,0.0,0.0],
      [9.0,9.0,9.0,9.0,9.0, 9.0,9.0,9.0,9.0,9.0, 9.0,9.0,9.0,9.0,7.0, 0.0,0.0,0.0,0.0,0.0],
      [9.0,9.0,9.0,9.0,9.0, 9.0,9.0,9.0,9.0,9.0, 9.0,9.0,9.0,9.0,7.0, 0.0,0.0,0.0,0.0,0.0]],
      dtype=np.float64)
    minima_in = np.array([[False, False, False, False, False,  False, False, False, False, False,
                           False, False, False, False, False,  False, False, False, False, False],
                          [False, False, False,  True, False,  False, False,  True, False, False,
                          False, False, False, False, False,   False,  True, False, False, False],
                          [False,  True, False, False, False,  False, False, False, False, False,
                           False, False, False, False, False,  False, False, False, False, False],
                          [False, False, False, False, False,  False, False, False, False, False,
                           False, False, False, False, False,  False, False, False, False, False],
                          [False, False, False, False, False,  False, False, False, False, False,
                           False, False, False, False, False,  False, False, False, False, False],
                          [False, False, False, False, False,  False, False, False, False, False,
                           False, False, False, False, False,  False, False, False, False, False],
                          [False, False, False, False, False,  False, False, False, False, False,
                           False, False, False, False, False,  False, False, False, False, False],
                          [False, False, False, False, False,  False, False, False, False, False,
                           False,  True, False, False, False,  False, True,  False, False, False],
                          [False, False, False, False, False,  False, False, False, False, False,
                           False, False, False, False, False,  False, False, False, False, False],
                          [False, False, False, False, False,  False, False, False, False, False,
                           False, False, False, False, False,  False, False, False, False, False],
                          [False, False, False, False, False,  False, False, False, False, False,
                           False, False, False, False, False,  False, False, False, False, False],
                          [False, False, False, False, False,  False, False, False, False, False,
                           False, False, False, False, False,  False, False, False, False, False],
                          [False, False, False, False, False,  False, False, False, False, False,
                           False, False, False, False, False,  False, False, False, False, False],
                          [False, False, False, False, False,  False, False, False, False, False,
                           False, False, False, False, False,  False, False, False, False, False],
                          [False,  True, False, False, False,  False, False, False, False, False,
                           False, False, False, False, False,  False, False, False, False, False],
                          [False, False, False, False, False,  False, False, False, False, False,
                           False, False, False, False, False,  False, False, False, False, False],
                          [False, False, False, False, False,  False, False, False, False, False,
                           False, False, False, False, False,  False, False, False, False, False],
                          [False, False, False, False, False,  False, False, False, False, False,
                           False, False, False, False, False,  False, False, False, False, False],
                          [False, False, False, False, False,  False, False, False, False, False,
                           False, False, False, False, False,  False, False, False, False, False],
                          [False, False, False, False, False,  False, False, False, False, False,
                           False, False, False, False, False,  False, False, False, False, False]],
                          dtype=np.int32)
    prior_fine_rdirs_in = np.array([
      [1., 4., 3., 2., 1., 1., 3., 2., 1., 1., 2., 1., 1., 1., 1., 3., 2., 1., 1., 1.],
      [3., 2., 1., 5., 4., 4., 6., 5., 4., 4., 1., 4., 4., 4., 4., 6., 5., 4., 4., 4.],
      [6., 5., 4., 8., 7., 7., 9., 8., 7., 7., 4., 7., 7., 7., 7., 9., 8., 7., 7., 7.],
      [9., 8., 7., 8., 7., 7., 9., 8., 7., 7., 7., 7., 7., 7., 7., 9., 8., 7., 7., 7.],
      [9., 8., 7., 8., 7., 7., 9., 8., 7., 7., 7., 7., 7., 7., 7., 9., 8., 7., 7., 7.],
      [9., 8., 7., 2., 1., 4., 4., 4., 4., 4., 9., 8., 7., 7., 7., 9., 8., 7., 7., 7.],
      [9., 8., 7., 1., 4., 7., 7., 7., 7., 7., 9., 8., 7., 7., 7., 6., 5., 4., 4., 4.],
      [9., 8., 7., 4., 7., 7., 7., 7., 7., 7., 6., 5., 4., 4., 4., 9., 8., 7., 7., 7.],
      [9., 8., 7., 7., 7., 7., 7., 7., 7., 7., 9., 8., 7., 7., 7., 9., 8., 7., 7., 7.],
      [9., 8., 7., 8., 7., 7., 7., 7., 7., 7., 9., 8., 7., 7., 7., 9., 8., 7., 7., 7.],
      [9., 8., 7., 8., 7., 7., 7., 7., 7., 7., 9., 8., 7., 7., 7., 9., 8., 7., 7., 7.],
      [9., 8., 7., 8., 7., 7., 7., 7., 7., 7., 9., 8., 7., 7., 7., 9., 8., 7., 7., 7.],
      [9., 8., 7., 8., 7., 7., 7., 7., 7., 7., 9., 8., 7., 7., 7., 9., 8., 7., 7., 7.],
      [9., 8., 7., 1., 1., 1., 1., 1., 1., 1., 9., 8., 7., 7., 7., 9., 8., 7., 7., 7.],
      [1., 5., 4., 4., 4., 4., 4., 4., 4., 4., 4., 1., 1., 1., 3., 2., 1., 1., 1., 1.],
      [4., 8., 7., 7., 7., 7., 7., 7., 7., 7., 7., 4., 4., 4., 6., 3., 2., 1., 1., 1.],
      [7., 8., 7., 7., 7., 7., 7., 7., 7., 7., 7., 7., 7., 7., 9., 6., 3., 2., 1., 1.],
      [7., 8., 7., 7., 7., 7., 7., 7., 7., 7., 7., 7., 7., 7., 9., 9., 6., 3., 2., 1.],
      [1., 8., 7., 7., 7., 7., 7., 7., 7., 7., 7., 7., 7., 7., 9., 9., 9., 6., 3., 2.],
      [4., 6., 6., 6., 6., 6., 6., 6., 6., 6., 6., 6., 9., 9., 9., 9., 9., 9., 6., 0.]],
      dtype=np.float64)
    prior_coarse_rdirs_in = np.array([[5,5,5,5],
                                      [2,2,5,5],
                                      [5,4,8,8],
                                      [8,7,4,0]],
                                      dtype=np.float64)
    prior_fine_catchments_in = np.array([
      [3, 3, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3],
      [4, 4, 4, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3],
      [4, 4, 4, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3],
      [4, 4, 4, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3],
      [4, 4, 4, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3],
      [4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3],
      [4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 2, 2, 2, 2, 2, 5, 5, 5, 5, 5],
      [4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 6, 6, 6, 6, 6, 5, 5, 5, 5, 5],
      [4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 6, 6, 6, 6, 6, 5, 5, 5, 5, 5],
      [4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 6, 6, 6, 6, 6, 5, 5, 5, 5, 5],
      [4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 6, 6, 6, 6, 6, 5, 5, 5, 5, 5],
      [4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 6, 6, 6, 6, 6, 5, 5, 5, 5, 5],
      [4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 6, 6, 6, 6, 6, 5, 5, 5, 5, 5],
      [4, 4, 4, 7, 7, 7, 7, 7, 7, 7, 6, 6, 6, 6, 6, 5, 5, 5, 5, 5],
      [8, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 8, 8, 8, 8, 8, 8],
      [8, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 8, 8, 8, 8, 8, 8],
      [8, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 8, 8, 8, 8, 8, 8],
      [8, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 8, 8, 8, 8, 8, 8],
      [8, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 8, 8, 8, 8, 8, 8],
      [8, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 8, 8, 8, 8, 8, 8, 8]],
      dtype=np.int32)
    cell_areas_in = np.array([[1,1,1,1,1, 1,1,1,1,1, 1,1,1,1,1, 1,1,1,1,1],
                              [1,1,1,1,1, 1,1,1,1,1, 1,1,1,1,1, 1,1,1,1,1],
                              [1,1,1,1,1, 1,1,1,1,1, 1,1,1,1,1, 1,1,1,1,1],
                              [1,1,1,1,1, 1,1,1,1,1, 1,1,1,1,1, 1,1,1,1,1],
                              [1,1,1,1,1, 1,1,1,1,1, 1,1,1,1,1, 1,1,1,1,1],
                              [1,1,1,1,1, 1,1,1,1,1, 1,1,1,1,1, 1,1,1,1,1],
                              [1,1,1,1,1, 1,1,1,1,1, 1,1,1,1,1, 1,1,1,1,1],
                              [1,1,1,1,1, 1,1,1,1,1, 1,1,1,1,1, 1,1,1,1,1],
                              [1,1,1,1,1, 1,1,1,1,1, 1,1,1,1,1, 1,1,1,1,1],
                              [1,1,1,1,1, 1,1,1,1,1, 1,1,1,1,1, 1,1,1,1,1],
                              [1,1,1,1,1, 1,1,1,1,1, 1,1,1,1,1, 1,1,1,1,1],
                              [1,1,1,1,1, 1,1,1,1,1, 1,1,1,1,1, 1,1,1,1,1],
                              [1,1,1,1,1, 1,1,1,1,1, 1,1,1,1,1, 1,1,1,1,1],
                              [1,1,1,1,1, 1,1,1,1,1, 1,1,1,1,1, 1,1,1,1,1],
                              [1,1,1,1,1, 1,1,1,1,1, 1,1,1,1,1, 1,1,1,1,1],
                              [1,1,1,1,1, 1,1,1,1,1, 1,1,1,1,1, 1,1,1,1,1],
                              [1,1,1,1,1, 1,1,1,1,1, 1,1,1,1,1, 1,1,1,1,1],
                              [1,1,1,1,1, 1,1,1,1,1, 1,1,1,1,1, 1,1,1,1,1],
                              [1,1,1,1,1, 1,1,1,1,1, 1,1,1,1,1, 1,1,1,1,1],
                              [1,1,1,1,1, 1,1,1,1,1, 1,1,1,1,1, 1,1,1,1,1]],
                              dtype=np.float64)
    landsea_in = np.array([
      [False,False,False,False,False, False,False,False,False,False, False,False,False,False,False, False,False,False,False,False],
      [False,False,False,False,False, False,False,False,False,False, False,False,False,False,False, False,False,False,False,False],
      [False,False,False,False,False, False,False,False,False,False, False,False,False,False,False, False,False,False,False,False],
      [False,False,False,False,False, False,False,False,False,False, False,False,False,False,False, False,False,False,False,False],
      [False,False,False,False,False, False,False,False,False,False, False,False,False,False,False, False,False,False,False,False],
      [False,False,False,False,False, False,False,False,False,False, False,False,False,False,False, False,False,False,False,False],
      [False,False,False,False,False, False,False,False,False,False, False,False,False,False,False, False,False,False,False,False],
      [False,False,False,False,False, False,False,False,False,False, False,False,False,False,False, False,False,False,False,False],
      [False,False,False,False,False, False,False,False,False,False, False,False,False,False,False, False,False,False,False,False],
      [False,False,False,False,False, False,False,False,False,False, False,False,False,False,False, False,False,False,False,False],
      [False,False,False,False,False, False,False,False,False,False, False,False,False,False,False, False,False,False,False,False],
      [False,False,False,False,False, False,False,False,False,False, False,False,False,False,False, False,False,False,False,False],
      [False,False,False,False,False, False,False,False,False,False, False,False,False,False,False, False,False,False,False,False],
      [False,False,False,False,False, False,False,False,False,False, False,False,False,False,False, False,False,False,False,False],
      [False,False,False,False,False, False,False,False,False,False, False,False,False,False,False, False,False,False,False,False],
      [False,False,False,False,False, False,False,False,False,False, False,False,False,False,False, False,False,False,False,False],
      [False,False,False,False,False, False,False,False,False,False, False,False,False,False,False, False,False,False,False,False],
      [False,False,False,False,False, False,False,False,False,False, False,False,False,False,False, False,False,False,False,False],
      [False,False,False,False,False, False,False,False,False,False, False,False,False,False,False, False,False,False,False,False],
      [False,False,False,False,False, False,False,False,False,False, False,False,False,False,False, False,False,False,False,True]],
      dtype=np.int32)
    output,alg = \
      LatLonEvaluateBasin.evaluate_basins(landsea_in,
                                          minima_in,
                                          raw_orography_in,
                                          corrected_orography_in,
                                          cell_areas_in,
                                          prior_fine_rdirs_in,
                                          prior_fine_catchments_in,
                                          coarse_catchment_nums_in,
                                          return_algorithm_object=True)
    expected_lake_mask = np.array([[False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False,
        False, False],
       [False, False, False,  True,  True,  True, False,  True,  True,
        False,  True,  True,  True,  True, False, False,  True,  True,
         True, False],
       [False,  True, False,  True,  True,  True,  True,  True,  True,
         True,  True,  True,  True,  True,  True,  True,  True,  True,
         True, False],
       [False,  True, False,  True,  True,  True, False,  True,  True,
         True,  True,  True,  True,  True, False, False,  True,  True,
         True, False],
       [False,  True, False, False, False, False, False, False, False,
        False, False,  True,  True,  True, False, False,  True,  True,
         True, False],
       [False,  True, False, False, False, False, False, False, False,
        False, False,  True,  True,  True, False, False, False,  True,
        False, False],
       [False,  True, False, False, False, False, False, False, False,
        False, False, False,  True, False, False, False,  True,  True,
         True, False],
       [False,  True, False, False, False, False, False, False, False,
        False, False,  True,  True,  True, False, False,  True,  True,
         True, False],
       [False,  True, False, False, False, False, False, False, False,
        False, False,  True,  True,  True, False, False,  True,  True,
         True, False],
       [False,  True, False, False, False, False, False, False, False,
        False, False,  True,  True,  True, False, False,  True,  True,
         True, False],
       [False,  True, False, False, False, False, False, False, False,
        False, False,  True,  True,  True, False, False,  True,  True,
         True, False],
       [False,  True, False, False, False, False, False, False, False,
        False, False,  True,  True,  True, False, False,  True,  True,
         True, False],
       [False,  True, False, False, False, False, False, False, False,
        False, False,  True,  True,  True, False, False,  True,  True,
         True, False],
       [False,  True, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False,
        False, False],
       [False,  True,  True,  True,  True,  True,  True,  True,  True,
         True, False, False, False, False, False, False, False, False,
        False, False],
       [False,  True,  True,  True,  True,  True,  True,  True,  True,
         True,  True,  True,  True, False, False, False, False, False,
        False, False],
       [False,  True,  True,  True,  True,  True,  True,  True,  True,
         True,  True,  True,  True, False, False, False, False, False,
        False, False],
       [False,  True,  True,  True,  True,  True,  True,  True,  True,
         True,  True,  True,  True, False, False, False, False, False,
        False, False],
       [False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False,
        False, False],
       [False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False,
        False, False]])
    expected_lakes_as_array = \
     [12.0, 236.0, 1.0, 8.0, 0.0, 15.0, 2.0, 45.0, 15.0, 2.0, 1.0, 0.0, 6.0, 16.0, 3.0,
      1.0, 0.0, 6.0, 15.0, 3.0, 1.0, 0.0, 6.0, 16.0, 4.0, 1.0, 0.0, 6.0, 16.0, 2.0,
      1.0, 0.0, 6.0, 17.0, 4.0, 1.0, 0.0, 6.0, 15.0, 5.0, 1.0, 0.0, 6.0, 16.0, 5.0,
      1.0, 0.0, 6.0, 18.0, 3.0, 1.0, 0.0, 6.0, 16.0, 6.0, 1.0, 0.0, 6.0, 17.0, 6.0,
      1.0, 0.0, 6.0, 15.0, 6.0, 1.0, 0.0, 6.0, 18.0, 2.0, 1.0, 0.0, 6.0, 15.0, 7.0,
      1.0, 0.0, 6.0, 18.0, 6.0, 1.0, 0.0, 6.0, 18.0, 7.0, 1.0, 0.0, 6.0, 15.0, 4.0,
      1.0, 0.0, 6.0, 18.0, 8.0, 1.0, 0.0, 6.0, 17.0, 8.0, 1.0, 0.0, 6.0, 18.0, 9.0,
      1.0, 0.0, 6.0, 17.0, 9.0, 1.0, 0.0, 6.0, 16.0, 9.0, 1.0, 0.0, 6.0, 18.0, 10.0,
      1.0, 0.0, 6.0, 17.0, 10.0, 1.0, 0.0, 6.0, 16.0, 10.0, 1.0, 0.0, 6.0, 15.0, 9.0,
      1.0, 0.0, 6.0, 18.0, 11.0, 1.0, 0.0, 6.0, 15.0, 10.0, 1.0, 0.0, 6.0, 17.0, 2.0,
      1.0, 0.0, 6.0, 18.0, 4.0, 1.0, 0.0, 6.0, 18.0, 5.0, 1.0, 0.0, 6.0, 15.0, 8.0,
      1.0, 0.0, 6.0, 17.0, 12.0, 1.0, 0.0, 6.0, 16.0, 8.0, 1.0, 0.0, 6.0, 18.0, 13.0,
      1.0, 0.0, 6.0, 16.0, 12.0, 1.0, 0.0, 6.0, 16.0, 13.0, 1.0, 0.0, 6.0, 17.0, 3.0,
      1.0, 0.0, 6.0, 17.0, 5.0, 1.0, 0.0, 6.0, 16.0, 7.0, 1.0, 0.0, 6.0, 17.0, 7.0,
      1.0, 0.0, 6.0, 17.0, 11.0, 1.0, 0.0, 6.0, 18.0, 12.0, 1.0, 0.0, 6.0, 16.0, 11.0,
      1.0, 0.0, 6.0, 17.0, 13.0, 1.0, 45.0, 7.0, 1.0, 4.0, 3.0, 1.0, 0.0, 116.0, 2.0,
      9.0, 0.0, 8.0, 17.0, 21.0, 8.0, 17.0, 1.0, 0.0, 3.0, 9.0, 18.0, 1.0, 0.0, 3.0,
      7.0, 18.0, 1.0, 0.0, 3.0, 10.0, 17.0, 1.0, 0.0, 3.0, 7.0, 17.0, 1.0, 0.0, 3.0,
      8.0, 19.0, 1.0, 0.0, 3.0, 11.0, 18.0, 1.0, 0.0, 3.0, 7.0, 19.0, 1.0, 0.0, 3.0,
      8.0, 18.0, 1.0, 0.0, 3.0, 10.0, 19.0, 1.0, 0.0, 3.0, 9.0, 17.0, 1.0, 0.0, 3.0,
      12.0, 18.0, 1.0, 0.0, 3.0, 12.0, 17.0, 1.0, 0.0, 3.0, 13.0, 17.0, 1.0, 0.0, 3.0,
      12.0, 19.0, 1.0, 0.0, 3.0, 11.0, 19.0, 1.0, 0.0, 3.0, 13.0, 19.0, 1.0, 0.0, 3.0,
      13.0, 18.0, 1.0, 0.0, 3.0, 10.0, 18.0, 1.0, 0.0, 3.0, 9.0, 19.0, 1.0, 0.0, 3.0,
      11.0, 17.0, 1.0, 63.0, 6.0, 1.0, 5.0, -1.0, -1.0, 1.0, 101.0, 3.0, 10.0, 0.0, 8.0,
      12.0, 18.0, 8.0, 12.0, 1.0, 0.0, 4.0, 9.0, 13.0, 1.0, 0.0, 4.0, 8.0, 13.0, 1.0,
      0.0, 4.0, 10.0, 12.0, 1.0, 0.0, 4.0, 9.0, 12.0, 1.0, 0.0, 4.0, 11.0, 13.0, 1.0,
      0.0, 4.0, 11.0, 12.0, 1.0, 0.0, 4.0, 12.0, 14.0, 1.0, 0.0, 4.0, 11.0, 14.0, 1.0,
      0.0, 4.0, 12.0, 12.0, 1.0, 0.0, 4.0, 13.0, 13.0, 1.0, 0.0, 4.0, 8.0, 14.0, 1.0,
      0.0, 4.0, 10.0, 14.0, 1.0, 0.0, 4.0, 9.0, 14.0, 1.0, 0.0, 4.0, 13.0, 14.0, 1.0,
      0.0, 4.0, 13.0, 12.0, 1.0, 0.0, 4.0, 10.0, 13.0, 1.0, 0.0, 4.0, 12.0, 13.0, 1.0,
      18.0, 5.0, 1.0, 6.0, 2.0, 3.0, 0.0, 66.0, 4.0, 8.0, 0.0, 3.0, 2.0, 11.0, 3.0,
      2.0, 1.0, 0.0, 1.0, 4.0, 2.0, 1.0, 0.0, 1.0, 5.0, 2.0, 1.0, 0.0, 1.0, 6.0,
      2.0, 1.0, 0.0, 1.0, 7.0, 2.0, 1.0, 0.0, 1.0, 8.0, 2.0, 1.0, 0.0, 1.0, 9.0,
      2.0, 1.0, 0.0, 1.0, 10.0, 2.0, 1.0, 0.0, 1.0, 11.0, 2.0, 1.0, 0.0, 1.0, 12.0,
      2.0, 1.0, 0.0, 1.0, 13.0, 2.0, 1.0, 66.0, 7.0, 1.0, 1.0, -1.0, -1.0, 1.0, 71.0,
      5.0, 9.0, 0.0, 2.0, 17.0, 12.0, 2.0, 17.0, 1.0, 0.0, 2.0, 3.0, 18.0, 1.0, 0.0,
      2.0, 2.0, 18.0, 1.0, 0.0, 2.0, 4.0, 17.0, 1.0, 0.0, 2.0, 3.0, 17.0, 1.0, 0.0,
      2.0, 5.0, 18.0, 1.0, 0.0, 2.0, 5.0, 17.0, 1.0, 0.0, 2.0, 5.0, 19.0, 1.0, 0.0,
      2.0, 2.0, 19.0, 1.0, 0.0, 2.0, 4.0, 19.0, 1.0, 0.0, 2.0, 3.0, 19.0, 1.0, 0.0,
      2.0, 4.0, 18.0, 1.0, 48.0, 6.0, 1.0, 2.0, -1.0, -1.0, 1.0, 141.0, 6.0, 10.0, 0.0,
      2.0, 8.0, 26.0, 2.0, 8.0, 1.0, 0.0, 1.0, 3.0, 9.0, 1.0, 0.0, 1.0, 2.0, 9.0,
      1.0, 0.0, 1.0, 4.0, 8.0, 1.0, 0.0, 1.0, 3.0, 8.0, 1.0, 0.0, 1.0, 4.0, 10.0,
      1.0, 0.0, 1.0, 3.0, 10.0, 1.0, 0.0, 1.0, 4.0, 11.0, 1.0, 0.0, 1.0, 4.0, 9.0,
      1.0, 0.0, 1.0, 3.0, 11.0, 1.0, 0.0, 1.0, 2.0, 11.0, 1.0, 0.0, 1.0, 4.0, 12.0,
      1.0, 0.0, 1.0, 3.0, 12.0, 1.0, 0.0, 1.0, 2.0, 12.0, 1.0, 0.0, 1.0, 4.0, 13.0,
      1.0, 0.0, 1.0, 3.0, 13.0, 1.0, 0.0, 1.0, 2.0, 13.0, 1.0, 0.0, 1.0, 5.0, 14.0,
      1.0, 0.0, 1.0, 4.0, 14.0, 1.0, 0.0, 1.0, 6.0, 14.0, 1.0, 0.0, 1.0, 6.0, 13.0,
      1.0, 0.0, 1.0, 3.0, 14.0, 1.0, 0.0, 1.0, 6.0, 12.0, 1.0, 0.0, 1.0, 2.0, 14.0,
      1.0, 0.0, 1.0, 5.0, 12.0, 1.0, 0.0, 1.0, 5.0, 13.0, 1.0, 104.0, 5.0, 1.0, 3.0,
      -1.0, -1.0, 1.0, 56.0, 7.0, 11.0, 0.0, 2.0, 4.0, 9.0, 2.0, 4.0, 1.0, 0.0, 3.0,
      3.0, 5.0, 1.0, 0.0, 3.0, 2.0, 5.0, 1.0, 0.0, 3.0, 4.0, 6.0, 1.0, 0.0, 3.0,
      4.0, 5.0, 1.0, 0.0, 3.0, 3.0, 4.0, 1.0, 0.0, 3.0, 3.0, 6.0, 1.0, 0.0, 3.0,
      4.0, 4.0, 1.0, 0.0, 3.0, 2.0, 6.0, 1.0, 27.0, 6.0, 1.0, 10.0, 1.0, 2.0, 0.0,
      298.0, 8.0, -1.0, 2.0, 1.0, 4.0, 15.0, 2.0, 57.0, 15.0, 2.0, 1.0, 0.0, 7.0, 16.0,
      3.0, 1.0, 0.0, 7.0, 15.0, 3.0, 1.0, 0.0, 7.0, 14.0, 2.0, 2.0, 0.0, 7.0, 16.0,
      4.0, 1.0, 0.0, 7.0, 16.0, 2.0, 1.0, 0.0, 7.0, 17.0, 3.0, 1.0, 0.0, 7.0, 16.0,
      5.0, 1.0, 0.0, 7.0, 15.0, 5.0, 1.0, 0.0, 7.0, 18.0, 3.0, 1.0, 0.0, 7.0, 18.0,
      2.0, 1.0, 0.0, 7.0, 17.0, 6.0, 1.0, 0.0, 7.0, 15.0, 6.0, 1.0, 0.0, 7.0, 18.0,
      4.0, 1.0, 0.0, 7.0, 18.0, 5.0, 1.0, 0.0, 7.0, 15.0, 4.0, 1.0, 0.0, 7.0, 17.0,
      2.0, 1.0, 0.0, 7.0, 17.0, 5.0, 1.0, 0.0, 7.0, 15.0, 7.0, 1.0, 0.0, 7.0, 18.0,
      6.0, 1.0, 0.0, 7.0, 13.0, 2.0, 1.0, 0.0, 7.0, 16.0, 7.0, 1.0, 0.0, 7.0, 12.0,
      2.0, 1.0, 0.0, 7.0, 17.0, 8.0, 1.0, 0.0, 7.0, 11.0, 2.0, 1.0, 0.0, 7.0, 18.0,
      9.0, 1.0, 0.0, 7.0, 17.0, 9.0, 1.0, 0.0, 7.0, 18.0, 8.0, 1.0, 0.0, 7.0, 10.0,
      2.0, 1.0, 0.0, 7.0, 16.0, 9.0, 1.0, 0.0, 7.0, 15.0, 8.0, 1.0, 0.0, 7.0, 17.0,
      7.0, 1.0, 0.0, 7.0, 16.0, 8.0, 1.0, 0.0, 7.0, 17.0, 4.0, 1.0, 0.0, 7.0, 18.0,
      7.0, 1.0, 0.0, 7.0, 15.0, 9.0, 1.0, 0.0, 7.0, 16.0, 10.0, 1.0, 0.0, 7.0, 9.0,
      2.0, 1.0, 0.0, 7.0, 15.0, 10.0, 1.0, 0.0, 7.0, 16.0, 6.0, 1.0, 0.0, 7.0, 17.0,
      10.0, 1.0, 0.0, 7.0, 8.0, 2.0, 1.0, 0.0, 7.0, 17.0, 11.0, 1.0, 0.0, 7.0, 16.0,
      11.0, 1.0, 0.0, 7.0, 18.0, 11.0, 1.0, 0.0, 7.0, 17.0, 12.0, 1.0, 0.0, 7.0, 16.0,
      12.0, 1.0, 0.0, 7.0, 7.0, 2.0, 1.0, 0.0, 7.0, 18.0, 13.0, 1.0, 0.0, 7.0, 16.0,
      13.0, 1.0, 0.0, 7.0, 17.0, 13.0, 1.0, 0.0, 7.0, 6.0, 2.0, 1.0, 0.0, 7.0, 18.0,
      12.0, 1.0, 0.0, 7.0, 5.0, 2.0, 1.0, 0.0, 7.0, 18.0, 10.0, 1.0, 0.0, 7.0, 4.0,
      2.0, 1.0, 0.0, 7.0, 3.0, 2.0, 1.0, 56.0, 8.0, 1.0, -1.0, 4.0, 4.0, 0.0, 183.0,
      9.0, 12.0, 2.0, 2.0, 5.0, 8.0, 17.0, 34.0, 8.0, 17.0, 1.0, 0.0, 6.0, 9.0, 18.0,
      1.0, 0.0, 6.0, 7.0, 18.0, 1.0, 0.0, 6.0, 10.0, 17.0, 1.0, 0.0, 6.0, 7.0, 17.0,
      1.0, 0.0, 6.0, 8.0, 19.0, 1.0, 0.0, 6.0, 6.0, 18.0, 1.0, 0.0, 6.0, 11.0, 18.0,
      1.0, 0.0, 6.0, 7.0, 19.0, 1.0, 0.0, 6.0, 5.0, 17.0, 1.0, 0.0, 6.0, 12.0, 18.0,
      1.0, 0.0, 6.0, 12.0, 17.0, 1.0, 0.0, 6.0, 4.0, 18.0, 1.0, 0.0, 6.0, 13.0, 19.0,
      1.0, 0.0, 6.0, 13.0, 17.0, 1.0, 0.0, 6.0, 13.0, 18.0, 1.0, 0.0, 6.0, 4.0, 19.0,
      1.0, 0.0, 6.0, 4.0, 17.0, 1.0, 0.0, 6.0, 8.0, 18.0, 1.0, 0.0, 6.0, 10.0, 19.0,
      1.0, 0.0, 6.0, 9.0, 17.0, 1.0, 0.0, 6.0, 11.0, 19.0, 1.0, 0.0, 6.0, 12.0, 19.0,
      1.0, 0.0, 6.0, 5.0, 19.0, 1.0, 0.0, 6.0, 5.0, 18.0, 1.0, 0.0, 6.0, 10.0, 18.0,
      1.0, 0.0, 6.0, 9.0, 19.0, 1.0, 0.0, 6.0, 11.0, 17.0, 1.0, 0.0, 6.0, 3.0, 17.0,
      1.0, 0.0, 6.0, 3.0, 19.0, 1.0, 0.0, 6.0, 3.0, 18.0, 1.0, 0.0, 6.0, 2.0, 18.0,
      1.0, 0.0, 6.0, 2.0, 17.0, 1.0, 0.0, 6.0, 2.0, 19.0, 1.0, 34.0, 7.0, 1.0, 11.0,
      1.0, 3.0, 0.0, 238.0, 10.0, 11.0, 2.0, 3.0, 6.0, 8.0, 12.0, 45.0, 8.0, 12.0, 1.0,
      0.0, 5.0, 9.0, 13.0, 1.0, 0.0, 5.0, 7.0, 13.0, 1.0, 0.0, 5.0, 10.0, 12.0, 1.0,
      0.0, 5.0, 8.0, 13.0, 1.0, 0.0, 5.0, 8.0, 14.0, 1.0, 0.0, 5.0, 6.0, 13.0, 1.0,
      0.0, 5.0, 11.0, 13.0, 1.0, 0.0, 5.0, 6.0, 12.0, 1.0, 0.0, 5.0, 6.0, 14.0, 1.0,
      0.0, 5.0, 5.0, 12.0, 1.0, 0.0, 5.0, 12.0, 12.0, 1.0, 0.0, 5.0, 4.0, 13.0, 1.0,
      0.0, 5.0, 4.0, 11.0, 1.0, 0.0, 5.0, 13.0, 13.0, 1.0, 0.0, 5.0, 13.0, 12.0, 1.0,
      0.0, 5.0, 4.0, 14.0, 1.0, 0.0, 5.0, 3.0, 10.0, 1.0, 0.0, 5.0, 4.0, 12.0, 1.0,
      0.0, 5.0, 10.0, 13.0, 1.0, 0.0, 5.0, 10.0, 14.0, 1.0, 0.0, 5.0, 9.0, 14.0, 1.0,
      0.0, 5.0, 12.0, 13.0, 1.0, 0.0, 5.0, 2.0, 9.0, 1.0, 0.0, 5.0, 3.0, 9.0, 1.0,
      0.0, 5.0, 11.0, 14.0, 1.0, 0.0, 5.0, 5.0, 13.0, 1.0, 0.0, 5.0, 12.0, 14.0, 1.0,
      0.0, 5.0, 4.0, 8.0, 1.0, 0.0, 5.0, 3.0, 8.0, 1.0, 0.0, 5.0, 2.0, 8.0, 1.0,
      0.0, 5.0, 4.0, 9.0, 1.0, 0.0, 5.0, 9.0, 12.0, 1.0, 0.0, 5.0, 5.0, 14.0, 1.0,
      0.0, 5.0, 2.0, 11.0, 1.0, 0.0, 5.0, 4.0, 10.0, 1.0, 0.0, 5.0, 13.0, 14.0, 1.0,
      0.0, 5.0, 2.0, 12.0, 1.0, 0.0, 5.0, 11.0, 12.0, 1.0, 0.0, 5.0, 3.0, 12.0, 1.0,
      0.0, 5.0, 2.0, 13.0, 1.0, 0.0, 5.0, 3.0, 11.0, 1.0, 0.0, 5.0, 3.0, 14.0, 1.0,
      0.0, 5.0, 2.0, 14.0, 1.0, 0.0, 5.0, 3.0, 13.0, 1.0, 45.0, 6.0, 1.0, 7.0, 1.0,
      2.0, 0.0, 288.0, 11.0, 12.0, 2.0, 10.0, 7.0, 8.0, 12.0, 55.0, 8.0, 12.0, 1.0, 0.0,
      6.0, 9.0, 13.0, 1.0, 0.0, 6.0, 7.0, 13.0, 1.0, 0.0, 6.0, 10.0, 12.0, 1.0, 0.0,
      6.0, 8.0, 13.0, 1.0, 0.0, 6.0, 8.0, 14.0, 1.0, 0.0, 6.0, 6.0, 13.0, 1.0, 0.0,
      6.0, 11.0, 13.0, 1.0, 0.0, 6.0, 6.0, 12.0, 1.0, 0.0, 6.0, 6.0, 14.0, 1.0, 0.0,
      6.0, 5.0, 12.0, 1.0, 0.0, 6.0, 12.0, 12.0, 1.0, 0.0, 6.0, 4.0, 13.0, 1.0, 0.0,
      6.0, 4.0, 11.0, 1.0, 0.0, 6.0, 13.0, 13.0, 1.0, 0.0, 6.0, 13.0, 12.0, 1.0, 0.0,
      6.0, 4.0, 14.0, 1.0, 0.0, 6.0, 3.0, 10.0, 1.0, 0.0, 6.0, 4.0, 12.0, 1.0, 0.0,
      6.0, 10.0, 13.0, 1.0, 0.0, 6.0, 10.0, 14.0, 1.0, 0.0, 6.0, 9.0, 14.0, 1.0, 0.0,
      6.0, 12.0, 13.0, 1.0, 0.0, 6.0, 2.0, 9.0, 1.0, 0.0, 6.0, 3.0, 9.0, 1.0, 0.0,
      6.0, 11.0, 14.0, 1.0, 0.0, 6.0, 5.0, 13.0, 1.0, 0.0, 6.0, 12.0, 14.0, 1.0, 0.0,
      6.0, 4.0, 8.0, 1.0, 0.0, 6.0, 3.0, 8.0, 1.0, 0.0, 6.0, 2.0, 8.0, 1.0, 0.0,
      6.0, 4.0, 9.0, 1.0, 0.0, 6.0, 3.0, 7.0, 1.0, 0.0, 6.0, 9.0, 12.0, 1.0, 0.0,
      6.0, 2.0, 6.0, 1.0, 0.0, 6.0, 5.0, 14.0, 1.0, 0.0, 6.0, 3.0, 5.0, 1.0, 0.0,
      6.0, 2.0, 5.0, 1.0, 0.0, 6.0, 4.0, 5.0, 1.0, 0.0, 6.0, 4.0, 4.0, 1.0, 0.0,
      6.0, 2.0, 4.0, 1.0, 0.0, 6.0, 3.0, 4.0, 1.0, 0.0, 6.0, 4.0, 6.0, 1.0, 0.0,
      6.0, 3.0, 6.0, 1.0, 0.0, 6.0, 2.0, 11.0, 1.0, 0.0, 6.0, 4.0, 10.0, 1.0, 0.0,
      6.0, 2.0, 12.0, 1.0, 0.0, 6.0, 13.0, 14.0, 1.0, 0.0, 6.0, 2.0, 13.0, 1.0, 0.0,
      6.0, 11.0, 12.0, 1.0, 0.0, 6.0, 2.0, 14.0, 1.0, 0.0, 6.0, 3.0, 12.0, 1.0, 0.0,
      6.0, 3.0, 11.0, 1.0, 0.0, 6.0, 3.0, 14.0, 1.0, 0.0, 6.0, 3.0, 13.0, 1.0, 55.0,
      7.0, 1.0, 9.0, 1.0, 4.0, 0.0, 468.0, 12.0, -1.0, 2.0, 9.0, 11.0, 8.0, 17.0, 91.0,
      8.0, 17.0, 1.0, 0.0, 7.0, 9.0, 18.0, 1.0, 0.0, 7.0, 7.0, 18.0, 1.0, 0.0, 7.0,
      10.0, 17.0, 1.0, 0.0, 7.0, 7.0, 17.0, 1.0, 0.0, 7.0, 8.0, 19.0, 1.0, 0.0, 7.0,
      6.0, 18.0, 1.0, 0.0, 7.0, 11.0, 18.0, 1.0, 0.0, 7.0, 7.0, 19.0, 1.0, 0.0, 7.0,
      5.0, 17.0, 1.0, 0.0, 7.0, 12.0, 18.0, 1.0, 0.0, 7.0, 12.0, 17.0, 1.0, 0.0, 7.0,
      4.0, 18.0, 1.0, 0.0, 7.0, 13.0, 19.0, 1.0, 0.0, 7.0, 13.0, 17.0, 1.0, 0.0, 7.0,
      13.0, 18.0, 1.0, 0.0, 7.0, 4.0, 19.0, 1.0, 0.0, 7.0, 4.0, 17.0, 1.0, 0.0, 7.0,
      8.0, 18.0, 1.0, 0.0, 7.0, 10.0, 19.0, 1.0, 0.0, 7.0, 9.0, 17.0, 1.0, 0.0, 7.0,
      11.0, 19.0, 1.0, 0.0, 7.0, 12.0, 19.0, 1.0, 0.0, 7.0, 5.0, 19.0, 1.0, 0.0, 7.0,
      5.0, 18.0, 1.0, 0.0, 7.0, 3.0, 16.0, 1.0, 0.0, 7.0, 10.0, 18.0, 1.0, 0.0, 7.0,
      9.0, 19.0, 1.0, 0.0, 7.0, 11.0, 17.0, 1.0, 0.0, 7.0, 3.0, 15.0, 1.0, 0.0, 7.0,
      3.0, 17.0, 1.0, 0.0, 7.0, 2.0, 17.0, 1.0, 0.0, 7.0, 3.0, 19.0, 1.0, 0.0, 7.0,
      4.0, 14.0, 1.0, 0.0, 7.0, 2.0, 14.0, 1.0, 0.0, 7.0, 2.0, 19.0, 1.0, 0.0, 7.0,
      5.0, 14.0, 1.0, 0.0, 7.0, 4.0, 13.0, 1.0, 0.0, 7.0, 6.0, 14.0, 1.0, 0.0, 7.0,
      6.0, 13.0, 1.0, 0.0, 7.0, 5.0, 12.0, 1.0, 0.0, 7.0, 4.0, 12.0, 1.0, 0.0, 7.0,
      6.0, 12.0, 1.0, 0.0, 7.0, 4.0, 11.0, 1.0, 0.0, 7.0, 3.0, 11.0, 1.0, 0.0, 7.0,
      3.0, 12.0, 1.0, 0.0, 7.0, 4.0, 10.0, 1.0, 0.0, 7.0, 3.0, 10.0, 1.0, 0.0, 7.0,
      2.0, 12.0, 1.0, 0.0, 7.0, 2.0, 11.0, 1.0, 0.0, 7.0, 4.0, 9.0, 1.0, 0.0, 7.0,
      3.0, 9.0, 1.0, 0.0, 7.0, 2.0, 9.0, 1.0, 0.0, 7.0, 7.0, 13.0, 1.0, 0.0, 7.0,
      2.0, 8.0, 1.0, 0.0, 7.0, 3.0, 13.0, 1.0, 0.0, 7.0, 2.0, 13.0, 1.0, 0.0, 7.0,
      5.0, 13.0, 1.0, 0.0, 7.0, 2.0, 18.0, 1.0, 0.0, 7.0, 3.0, 14.0, 1.0, 0.0, 7.0,
      3.0, 18.0, 1.0, 0.0, 7.0, 8.0, 13.0, 1.0, 0.0, 7.0, 8.0, 12.0, 1.0, 0.0, 7.0,
      3.0, 7.0, 1.0, 0.0, 7.0, 8.0, 14.0, 1.0, 0.0, 7.0, 4.0, 8.0, 1.0, 0.0, 7.0,
      3.0, 8.0, 1.0, 0.0, 7.0, 9.0, 13.0, 1.0, 0.0, 7.0, 4.0, 6.0, 1.0, 0.0, 7.0,
      3.0, 6.0, 1.0, 0.0, 7.0, 2.0, 6.0, 1.0, 0.0, 7.0, 10.0, 13.0, 1.0, 0.0, 7.0,
      10.0, 12.0, 1.0, 0.0, 7.0, 3.0, 5.0, 1.0, 0.0, 7.0, 2.0, 5.0, 1.0, 0.0, 7.0,
      4.0, 5.0, 1.0, 0.0, 7.0, 4.0, 4.0, 1.0, 0.0, 7.0, 3.0, 4.0, 1.0, 0.0, 7.0,
      2.0, 4.0, 1.0, 0.0, 7.0, 11.0, 14.0, 1.0, 0.0, 7.0, 11.0, 13.0, 1.0, 0.0, 7.0,
      11.0, 12.0, 1.0, 0.0, 7.0, 12.0, 14.0, 1.0, 0.0, 7.0, 12.0, 13.0, 1.0, 0.0, 7.0,
      12.0, 12.0, 1.0, 0.0, 7.0, 13.0, 14.0, 1.0, 0.0, 7.0, 13.0, 13.0, 1.0, 0.0, 7.0,
      13.0, 12.0, 1.0, 0.0, 7.0, 9.0, 12.0, 1.0, 0.0, 7.0, 10.0, 14.0, 1.0, 0.0, 7.0,
      9.0, 14.0, 1.0, 91.0, 8.0, 1.0, -1.0, 4.0, 4.0, 0.0]
    self.assertEqual(output["number_of_lakes"],12)
    self.assertEqual(output["lakes_as_array"],expected_lakes_as_array)
    np.testing.assert_array_equal(output["lake_mask"],expected_lake_mask)

  def testEvaluateBasinsSix(self):
    coarse_catchment_nums_in = np.array([[5,5,5,5],
                                         [5,5,5,5],
                                         [5,5,6,2],
                                         [5,6,6,0]],
                                         dtype=np.int32)
    corrected_orography_in = np.array([
      [9.0,9.0,9.0,9.0,9.0, 9.0,9.0,9.0,9.0,9.0, 9.0,9.0,9.0,9.0,9.0, 9.0,9.0,9.0,9.0,9.0],
      [9.0,1.0,9.0,1.0,9.0, 9.0,1.0,9.0,1.0,9.0, 9.0,1.0,9.0,1.0,9.0, 9.0,9.0,9.0,9.0,9.0],
      [9.0,9.0,2.0,9.0,3.0, 3.0,9.0,2.0,9.0,3.0, 3.0,9.0,2.0,9.0,3.0, 3.0,3.0,3.0,9.0,9.0],
      [9.0,1.0,9.0,1.0,9.0, 9.0,1.0,9.0,1.0,9.0, 9.0,1.0,9.0,1.0,9.0, 9.0,9.0,3.0,9.0,9.0],
      [9.0,9.0,2.0,9.0,9.0, 9.0,9.0,3.0,9.0,9.0, 9.0,9.0,3.0,9.0,9.0, 9.0,9.0,3.0,9.0,9.0],
      #
      [9.0,1.0,9.0,1.0,9.0, 9.0,9.0,3.0,9.0,9.0, 9.0,9.0,3.0,9.0,9.0, 9.0,9.0,3.0,9.0,9.0],
      [9.0,9.0,2.0,9.0,9.0, 9.0,1.0,9.0,1.0,9.0, 9.0,1.0,9.0,1.0,9.0, 9.0,2.0,9.0,2.0,9.0],
      [9.0,1.0,9.0,1.0,9.0, 9.0,9.0,2.0,9.0,9.0, 9.0,9.0,3.0,9.0,9.0, 9.0,9.0,1.0,9.0,9.0],
      [9.0,9.0,2.0,9.0,9.0, 9.0,1.0,9.0,1.0,9.0, 9.0,1.0,9.0,1.0,9.0, 9.0,2.0,9.0,2.0,9.0],
      [9.0,1.0,9.0,1.0,9.0, 9.0,9.0,3.0,9.0,9.0, 9.0,9.0,3.0,9.0,9.0, 9.0,9.0,3.0,9.0,9.0],
      #
      [9.0,9.0,2.0,9.0,9.0, 9.0,9.0,3.0,9.0,9.0, 9.0,9.0,3.0,9.0,9.0, 9.0,1.0,9.0,1.0,9.0],
      [9.0,1.0,9.0,1.0,9.0, 9.0,1.0,9.0,1.0,9.0, 9.0,1.0,9.0,1.0,9.0, 9.0,9.0,2.0,9.0,9.0],
      [9.0,9.0,2.0,9.0,9.0, 9.0,9.0,2.0,9.0,9.0, 9.0,9.0,2.0,9.0,9.0, 9.0,1.0,9.0,1.0,9.0],
      [9.0,1.0,9.0,1.0,9.0, 9.0,1.0,9.0,1.0,9.0, 9.0,1.0,9.0,1.0,9.0, 9.0,9.0,4.0,9.0,9.0],
      [9.0,9.0,3.0,9.0,9.0, 9.0,9.0,3.0,9.0,9.0, 9.0,9.0,3.0,9.0,7.0, 7.0,7.0,4.0,7.0,7.0],
      #
      [9.0,1.0,9.0,1.0,9.0, 9.0,9.0,3.0,9.0,9.0, 9.0,9.0,3.0,9.0,7.0, 0.0,0.0,0.0,0.0,0.0],
      [9.0,9.0,2.0,9.0,9.0, 9.0,9.0,3.0,9.0,9.0, 9.0,1.0,9.0,1.0,7.0, 0.0,0.0,0.0,0.0,0.0],
      [9.0,1.0,9.0,1.0,9.0, 9.0,1.0,9.0,1.0,9.0, 9.0,9.0,2.0,9.0,7.0, 0.0,0.0,0.0,0.0,0.0],
      [9.0,9.0,2.0,9.0,9.0, 9.0,9.0,2.0,9.0,9.0, 9.0,1.0,9.0,1.0,7.0, 0.0,0.0,0.0,0.0,0.0],
      [9.0,1.0,9.0,9.0,9.0, 9.0,1.0,9.0,1.0,9.0, 9.0,9.0,9.0,9.0,7.0, 0.0,0.0,0.0,0.0,0.0]],
      dtype=np.float64)
    raw_orography_in = np.array([
      [9.0,9.0,9.0,9.0,9.0, 9.0,9.0,9.0,9.0,9.0, 9.0,9.0,9.0,9.0,9.0, 9.0,9.0,9.0,9.0,9.0],
      [9.0,1.0,9.0,1.0,9.0, 9.0,1.0,9.0,1.0,9.0, 9.0,1.0,9.0,1.0,9.0, 9.0,9.0,9.0,9.0,9.0],
      [9.0,9.0,2.0,9.0,9.0, 3.0,9.0,2.0,9.0,3.0, 9.0,9.0,2.0,9.0,9.0, 9.0,9.0,9.0,9.0,9.0],
      [9.0,1.0,9.0,1.0,9.0, 9.0,1.0,9.0,1.0,9.0, 9.0,1.0,9.0,1.0,9.0, 9.0,9.0,9.0,9.0,9.0],
      [9.0,9.0,2.0,9.0,9.0, 9.0,9.0,3.0,9.0,9.0, 9.0,9.0,9.0,9.0,9.0, 9.0,9.0,3.0,9.0,9.0],
      #
      [9.0,1.0,9.0,1.0,9.0, 9.0,9.0,3.0,9.0,9.0, 9.0,9.0,9.0,9.0,9.0, 9.0,9.0,3.0,9.0,9.0],
      [9.0,9.0,2.0,9.0,9.0, 9.0,1.0,9.0,1.0,9.0, 9.0,1.0,9.0,1.0,9.0, 9.0,2.0,9.0,2.0,9.0],
      [9.0,1.0,9.0,1.0,9.0, 9.0,9.0,2.0,9.0,9.0, 9.0,9.0,3.0,9.0,9.0, 9.0,9.0,1.0,9.0,9.0],
      [9.0,9.0,2.0,9.0,9.0, 9.0,1.0,9.0,1.0,9.0, 9.0,1.0,9.0,1.0,9.0, 9.0,2.0,9.0,2.0,9.0],
      [9.0,1.0,9.0,1.0,9.0, 9.0,9.0,3.0,9.0,9.0, 9.0,9.0,9.0,9.0,9.0, 9.0,9.0,3.0,9.0,9.0],
      #
      [9.0,9.0,2.0,9.0,9.0, 9.0,9.0,3.0,9.0,9.0, 9.0,9.0,9.0,9.0,9.0, 9.0,1.0,9.0,1.0,9.0],
      [9.0,1.0,9.0,1.0,9.0, 9.0,1.0,9.0,1.0,9.0, 9.0,9.0,9.0,9.0,9.0, 9.0,9.0,2.0,9.0,9.0],
      [9.0,9.0,2.0,9.0,9.0, 9.0,9.0,2.0,9.0,9.0, 9.0,9.0,9.0,9.0,9.0, 9.0,1.0,9.0,1.0,9.0],
      [9.0,1.0,9.0,1.0,9.0, 9.0,1.0,9.0,1.0,9.0, 9.0,9.0,9.0,9.0,9.0, 9.0,9.0,4.0,9.0,9.0],
      [9.0,9.0,3.0,9.0,9.0, 9.0,9.0,3.0,9.0,9.0, 9.0,9.0,9.0,9.0,7.0, 7.0,7.0,4.0,7.0,7.0],
      #
      [9.0,1.0,9.0,1.0,9.0, 9.0,9.0,3.0,9.0,9.0, 9.0,9.0,9.0,9.0,7.0, 0.0,0.0,0.0,0.0,0.0],
      [9.0,9.0,2.0,9.0,9.0, 9.0,9.0,3.0,9.0,9.0, 9.0,9.0,9.0,9.0,7.0, 0.0,0.0,0.0,0.0,0.0],
      [9.0,1.0,9.0,1.0,9.0, 9.0,1.0,9.0,1.0,9.0, 9.0,9.0,9.0,9.0,7.0, 0.0,0.0,0.0,0.0,0.0],
      [9.0,9.0,2.0,9.0,9.0, 9.0,9.0,2.0,9.0,9.0, 9.0,9.0,9.0,9.0,7.0, 0.0,0.0,0.0,0.0,0.0],
      [9.0,1.0,9.0,9.0,9.0, 9.0,1.0,9.0,1.0,9.0, 9.0,9.0,9.0,9.0,7.0, 0.0,0.0,0.0,0.0,0.0]],
      dtype=np.float64)
    minima_in = np.array([
     [False,False,False,False,False,False,False,False,False,False,False,False,
      False,False,False,False,False,False,False,False],
     [False, True,False, True,False,False, True,False, True,False,False, True,
      False, True,False,False,False,False,False,False],
     [False,False,False,False,False,False,False,False,False,False,False,False,
      False,False,False,False,False,False,False,False],
     [False, True,False, True,False,False, True,False, True,False,False, True,
      False, True,False,False,False,False,False,False],
     [False,False,False,False,False,False,False,False,False,False,False,False,
      False,False,False,False,False,False,False,False],
     [False, True,False, True,False,False,False,False,False,False,False,False,
      False,False,False,False,False,False,False,False],
     [False,False,False,False,False,False, True,False, True,False,False, True,
      False, True,False,False,False,False,False,False],
     [False, True,False, True,False,False,False,False,False,False,False,False,
      False,False,False,False,False, True,False,False],
     [False,False,False,False,False,False, True,False, True,False,False, True,
      False, True,False,False,False,False,False,False],
     [False, True,False, True,False,False,False,False,False,False,False,False,
      False,False,False,False,False,False,False,False],
     [False,False,False,False,False,False,False,False,False,False,False,False,
      False,False,False,False, True,False, True,False],
     [False, True,False, True,False,False, True,False, True,False,False, True,
      False, True,False,False,False,False,False,False],
     [False,False,False,False,False,False,False,False,False,False,False,False,
      False,False,False,False, True,False, True,False],
     [False, True,False, True,False,False, True,False, True,False,False, True,
      False, True,False,False,False,False,False,False],
     [False,False,False,False,False,False,False,False,False,False,False,False,
      False,False,False,False,False,False,False,False],
     [False, True,False, True,False,False,False,False,False,False,False,False,
      False,False,False,False,False,False,False,False],
     [False,False,False,False,False,False,False,False,False,False,False, True,
      False, True,False,False,False,False,False,False],
     [False, True,False, True,False,False, True,False, True,False,False,False,
      False,False,False,False,False,False,False,False],
     [False,False,False,False,False,False,False,False,False,False,False, True,
      False, True,False,False,False,False,False,False],
     [False, True,False,False,False,False, True,False, True,False,False,False,
      False,False,False,False,False,False,False,False]],
                          dtype=np.int32)
    prior_fine_rdirs_in = np.array([
       [3.0,2.0,1.0,2.0,1.0,3.0,2.0,1.0,2.0,1.0,3.0,2.0,1.0,2.0,1.0,2.0,2.0,2.0,2.0,2.0],
       [6.0,5.0,4.0,5.0,4.0,6.0,5.0,6.0,5.0,4.0,6.0,5.0,4.0,5.0,6.0,3.0,3.0,2.0,1.0,1.0],
       [3.0,2.0,1.0,2.0,1.0,3.0,2.0,1.0,8.0,1.0,3.0,2.0,1.0,8.0,6.0,6.0,6.0,2.0,4.0,4.0],
       [6.0,5.0,4.0,5.0,4.0,6.0,5.0,6.0,5.0,4.0,6.0,5.0,4.0,5.0,6.0,6.0,6.0,2.0,4.0,4.0],
       [3.0,2.0,1.0,2.0,1.0,9.0,8.0,7.0,8.0,7.0,9.0,8.0,7.0,8.0,7.0,6.0,6.0,2.0,4.0,4.0],
       [6.0,5.0,4.0,5.0,4.0,3.0,2.0,1.0,2.0,1.0,3.0,2.0,1.0,2.0,1.0,6.0,6.0,2.0,4.0,4.0],
       [3.0,2.0,1.0,2.0,1.0,6.0,5.0,6.0,5.0,4.0,6.0,5.0,4.0,5.0,6.0,6.0,6.0,2.0,4.0,4.0],
       [6.0,5.0,4.0,5.0,4.0,3.0,2.0,1.0,8.0,1.0,3.0,2.0,1.0,8.0,1.0,6.0,6.0,5.0,4.0,4.0],
       [3.0,2.0,1.0,2.0,1.0,6.0,5.0,6.0,5.0,4.0,6.0,5.0,4.0,5.0,4.0,6.0,9.0,8.0,7.0,4.0],
       [6.0,5.0,4.0,5.0,4.0,9.0,8.0,7.0,8.0,7.0,9.0,8.0,7.0,8.0,7.0,3.0,2.0,1.0,2.0,1.0],
       [3.0,2.0,1.0,2.0,1.0,3.0,2.0,1.0,2.0,1.0,3.0,2.0,1.0,2.0,1.0,6.0,5.0,6.0,5.0,4.0],
       [6.0,5.0,4.0,5.0,4.0,6.0,5.0,6.0,5.0,4.0,6.0,5.0,4.0,5.0,4.0,9.0,8.0,7.0,2.0,1.0],
       [3.0,2.0,1.0,2.0,1.0,9.0,8.0,7.0,2.0,1.0,3.0,2.0,1.0,8.0,1.0,6.0,5.0,6.0,5.0,4.0],
       [6.0,5.0,4.0,5.0,4.0,6.0,5.0,6.0,5.0,4.0,6.0,5.0,4.0,5.0,3.0,2.0,2.0,2.0,2.0,2.0],
       [3.0,2.0,1.0,2.0,1.0,9.0,8.0,7.0,8.0,7.0,9.0,8.0,7.0,8.0,6.0,2.0,2.0,2.0,2.0,2.0],
       [6.0,5.0,4.0,5.0,4.0,8.0,8.0,8.0,8.0,8.0,3.0,2.0,1.0,2.0,6.0,0.0,0.0,0.0,0.0,0.0],
       [3.0,2.0,1.0,2.0,1.0,3.0,2.0,1.0,2.0,1.0,6.0,5.0,4.0,5.0,6.0,0.0,0.0,0.0,0.0,0.0],
       [6.0,5.0,4.0,5.0,4.0,6.0,5.0,6.0,5.0,4.0,3.0,2.0,1.0,8.0,6.0,0.0,0.0,0.0,0.0,0.0],
       [9.0,8.0,7.0,8.0,7.0,9.0,8.0,7.0,8.0,7.0,6.0,5.0,4.0,5.0,6.0,0.0,0.0,0.0,0.0,0.0],
       [8.0,8.0,8.0,8.0,8.0,8.0,8.0,8.0,8.0,8.0,9.0,8.0,7.0,8.0,6.0,0.0,0.0,0.0,0.0,0.0]],
      dtype=np.float64)
    prior_coarse_rdirs_in = np.array([[5,5,5,5],
                                      [5,5,5,5],
                                      [5,5,5,5],
                                      [5,5,5,0]],
                                      dtype=np.float64)
    prior_fine_catchments_in = np.array([
      [ 1, 1, 1, 2, 2, 3, 3, 3, 4, 4, 5, 5, 5, 6, 6,21,21,21,21,21],
      [ 1, 1, 1, 2, 2, 3, 3, 4, 4, 4, 5, 5, 5, 6,21,21,21,21,21,21],
      [ 7, 7, 7, 8, 8, 9, 9, 9, 4,10,11,11,11, 6,21,21,21,21,21,21],
      [ 7, 7, 7, 8, 8, 9, 9,10,10,10,11,11,11,12,21,21,21,21,21,21],
      [13,13,13,14,14, 9, 9, 9,10,10,11,11,11,12,12,21,21,21,21,21],
      [13,13,13,14,14,15,15,15,16,16,17,17,17,18,18,21,21,21,21,21],
      [19,19,19,20,20,15,15,16,16,16,17,17,17,18,21,21,21,21,21,21],
      [19,19,19,20,20,22,22,22,16,23,24,24,24,18,25,21,21,21,21,21],
      [26,26,26,27,27,22,22,23,23,23,24,24,24,25,25,21,21,21,21,21],
      [26,26,26,27,27,22,22,22,23,23,24,24,24,25,25,28,28,28,29,29],
      [30,30,30,31,31,32,32,32,33,33,34,34,34,35,35,28,28,29,29,29],
      [30,30,30,31,31,32,32,33,33,33,34,34,34,35,35,28,28,28,37,37],
      [38,38,38,39,39,32,32,32,41,41,42,42,42,35,43,36,36,37,37,37],
      [38,38,38,39,39,40,40,41,41,41,42,42,42,43,54,54,54,54,54,54],
      [44,44,44,45,45,40,40,40,41,41,42,42,42,43,54,54,54,54,54,54],
      [44,44,44,45,45,40,40,40,41,41,46,46,46,47,54,54,54,54,54,54],
      [48,48,48,49,49,50,50,50,51,51,46,46,46,47,54,54,54,54,54,54],
      [48,48,48,49,49,50,50,51,51,51,52,52,52,47,54,54,54,54,54,54],
      [48,48,48,49,49,50,50,50,51,51,52,52,52,53,54,54,54,54,54,54],
      [48,48,48,49,49,50,50,50,51,51,52,52,52,53,54,54,54,54,54,54]],
      dtype=np.int32)
    cell_areas_in = np.array([[1,1,1,1,1, 1,1,1,1,1, 1,1,1,1,1, 1,1,1,1,1],
                              [1,1,1,1,1, 1,1,1,1,1, 1,1,1,1,1, 1,1,1,1,1],
                              [1,1,1,1,1, 1,1,1,1,1, 1,1,1,1,1, 1,1,1,1,1],
                              [1,1,1,1,1, 1,1,1,1,1, 1,1,1,1,1, 1,1,1,1,1],
                              [1,1,1,1,1, 1,1,1,1,1, 1,1,1,1,1, 1,1,1,1,1],
                              [1,1,1,1,1, 1,1,1,1,1, 1,1,1,1,1, 1,1,1,1,1],
                              [1,1,1,1,1, 1,1,1,1,1, 1,1,1,1,1, 1,1,1,1,1],
                              [1,1,1,1,1, 1,1,1,1,1, 1,1,1,1,1, 1,1,1,1,1],
                              [1,1,1,1,1, 1,1,1,1,1, 1,1,1,1,1, 1,1,1,1,1],
                              [1,1,1,1,1, 1,1,1,1,1, 1,1,1,1,1, 1,1,1,1,1],
                              [1,1,1,1,1, 1,1,1,1,1, 1,1,1,1,1, 1,1,1,1,1],
                              [1,1,1,1,1, 1,1,1,1,1, 1,1,1,1,1, 1,1,1,1,1],
                              [1,1,1,1,1, 1,1,1,1,1, 1,1,1,1,1, 1,1,1,1,1],
                              [1,1,1,1,1, 1,1,1,1,1, 1,1,1,1,1, 1,1,1,1,1],
                              [1,1,1,1,1, 1,1,1,1,1, 1,1,1,1,1, 1,1,1,1,1],
                              [1,1,1,1,1, 1,1,1,1,1, 1,1,1,1,1, 1,1,1,1,1],
                              [1,1,1,1,1, 1,1,1,1,1, 1,1,1,1,1, 1,1,1,1,1],
                              [1,1,1,1,1, 1,1,1,1,1, 1,1,1,1,1, 1,1,1,1,1],
                              [1,1,1,1,1, 1,1,1,1,1, 1,1,1,1,1, 1,1,1,1,1],
                              [1,1,1,1,1, 1,1,1,1,1, 1,1,1,1,1, 1,1,1,1,1]],
                              dtype=np.float64)
    landsea_in = np.array([
      [False,False,False,False,False, False,False,False,False,False, False,False,False,False,False, False,False,False,False,False],
      [False,False,False,False,False, False,False,False,False,False, False,False,False,False,False, False,False,False,False,False],
      [False,False,False,False,False, False,False,False,False,False, False,False,False,False,False, False,False,False,False,False],
      [False,False,False,False,False, False,False,False,False,False, False,False,False,False,False, False,False,False,False,False],
      [False,False,False,False,False, False,False,False,False,False, False,False,False,False,False, False,False,False,False,False],
      [False,False,False,False,False, False,False,False,False,False, False,False,False,False,False, False,False,False,False,False],
      [False,False,False,False,False, False,False,False,False,False, False,False,False,False,False, False,False,False,False,False],
      [False,False,False,False,False, False,False,False,False,False, False,False,False,False,False, False,False,False,False,False],
      [False,False,False,False,False, False,False,False,False,False, False,False,False,False,False, False,False,False,False,False],
      [False,False,False,False,False, False,False,False,False,False, False,False,False,False,False, False,False,False,False,False],
      [False,False,False,False,False, False,False,False,False,False, False,False,False,False,False, False,False,False,False,False],
      [False,False,False,False,False, False,False,False,False,False, False,False,False,False,False, False,False,False,False,False],
      [False,False,False,False,False, False,False,False,False,False, False,False,False,False,False, False,False,False,False,False],
      [False,False,False,False,False, False,False,False,False,False, False,False,False,False,False, False,False,False,False,False],
      [False,False,False,False,False, False,False,False,False,False, False,False,False,False,False, False,False,False,False,False],
      [False,False,False,False,False, False,False,False,False,False, False,False,False,False,False, False,False,False,False,False],
      [False,False,False,False,False, False,False,False,False,False, False,False,False,False,False, False,False,False,False,False],
      [False,False,False,False,False, False,False,False,False,False, False,False,False,False,False, False,False,False,False,False],
      [False,False,False,False,False, False,False,False,False,False, False,False,False,False,False, False,False,False,False,False],
      [False,False,False,False,False, False,False,False,False,False, False,False,False,False,False, False,False,False,False,True]],
      dtype=np.int32)
    output,alg = \
      LatLonEvaluateBasin.evaluate_basins(landsea_in,
                                          minima_in,
                                          raw_orography_in,
                                          corrected_orography_in,
                                          cell_areas_in,
                                          prior_fine_rdirs_in,
                                          prior_fine_catchments_in,
                                          coarse_catchment_nums_in,
                                          return_algorithm_object=True)
    expected_lake_mask = np.array([
       [False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False,
        False, False],
       [False,  True, False,  True, False, False,  True, False,  True,
        False, False,  True, False,  True, False, False, False, False,
        False, False],
       [False, False,  True, False,  True,  True, False,  True, False,
         True,  True, False,  True, False,  True,  True,  True,  True,
        False, False],
       [False,  True, False,  True, False, False,  True, False,  True,
        False, False,  True, False,  True, False, False, False,  True,
        False, False],
       [False, False,  True, False, False, False, False,  True, False,
        False, False, False,  True, False, False, False, False,  True,
        False, False],
       [False,  True, False,  True, False, False, False,  True, False,
        False, False, False,  True, False, False, False, False,  True,
        False, False],
       [False, False,  True, False, False, False,  True, False,  True,
        False, False,  True, False,  True, False, False,  True, False,
         True, False],
       [False,  True, False,  True, False, False, False,  True, False,
        False, False, False,  True, False, False, False, False,  True,
        False, False],
       [False, False,  True, False, False, False,  True, False,  True,
        False, False,  True, False,  True, False, False,  True, False,
         True, False],
       [False,  True, False,  True, False, False, False,  True, False,
        False, False, False,  True, False, False, False, False,  True,
        False, False],
       [False, False,  True, False, False, False, False,  True, False,
        False, False, False,  True, False, False, False,  True, False,
         True, False],
       [False,  True, False,  True, False, False,  True, False,  True,
        False, False,  True, False,  True, False, False, False,  True,
        False, False],
       [False, False,  True, False, False, False, False,  True, False,
        False, False, False,  True, False, False, False,  True, False,
         True, False],
       [False,  True, False,  True, False, False,  True, False,  True,
        False, False,  True, False,  True, False, False, False, False,
        False, False],
       [False, False,  True, False, False, False, False,  True, False,
        False, False, False,  True, False, False, False, False, False,
        False, False],
       [False,  True, False,  True, False, False, False,  True, False,
        False, False, False,  True, False, False, False, False, False,
        False, False],
       [False, False,  True, False, False, False, False,  True, False,
        False, False,  True, False,  True, False, False, False, False,
        False, False],
       [False,  True, False,  True, False, False,  True, False,  True,
        False, False, False,  True, False, False, False, False, False,
        False, False],
       [False, False,  True, False, False, False, False,  True, False,
        False, False,  True, False,  True, False, False, False, False,
        False, False],
       [False,  True, False, False, False, False,  True, False,  True,
        False, False, False, False, False, False, False, False, False,
        False, False]])
    expected_lakes_as_array = \
     [68.0, 24.0, 1.0, 57.0, 0.0, 20.0, 9.0, 1.0, 20.0, 9.0, 1.0, 1.0, 2.0, 3.0, 2.0,
      -1.0, -1.0, 1.0, 6.0, -1.0, -1.0, 1.0, 7.0, -1.0, -1.0, 1.0, 24.0, 2.0, 57.0, 0.0,
      20.0, 7.0, 1.0, 20.0, 7.0, 1.0, 1.0, 2.0, 3.0, 1.0, -1.0, -1.0, 1.0, 6.0, -1.0,
      -1.0, 1.0, 7.0, -1.0, -1.0, 1.0, 28.0, 3.0, 61.0, 0.0, 20.0, 2.0, 1.0, 20.0, 2.0,
      1.0, 1.0, 2.0, 4.0, 8.0, -1.0, -1.0, 1.0, 9.0, -1.0, -1.0, 1.0, 12.0, -1.0, -1.0,
      1.0, 13.0, -1.0, -1.0, 1.0, 24.0, 4.0, 60.0, 0.0, 19.0, 14.0, 1.0, 19.0, 14.0, 2.0,
      0.0, 2.0, 3.0, 10.0, -1.0, -1.0, 1.0, 11.0, -1.0, -1.0, 1.0, 5.0, -1.0, -1.0, 1.0,
      24.0, 5.0, 60.0, 0.0, 19.0, 12.0, 1.0, 19.0, 12.0, 2.0, 0.0, 2.0, 3.0, 10.0, -1.0,
      -1.0, 1.0, 11.0, -1.0, -1.0, 1.0, 4.0, -1.0, -1.0, 1.0, 24.0, 6.0, 57.0, 0.0, 18.0,
      9.0, 1.0, 18.0, 9.0, 1.0, 1.0, 2.0, 3.0, 1.0, -1.0, -1.0, 1.0, 2.0, -1.0, -1.0,
      1.0, 7.0, -1.0, -1.0, 1.0, 24.0, 7.0, 57.0, 0.0, 18.0, 7.0, 1.0, 18.0, 7.0, 1.0,
      1.0, 2.0, 3.0, 1.0, -1.0, -1.0, 1.0, 2.0, -1.0, -1.0, 1.0, 6.0, -1.0, -1.0, 1.0,
      28.0, 8.0, 61.0, 0.0, 18.0, 4.0, 1.0, 18.0, 4.0, 1.0, 1.0, 2.0, 4.0, 3.0, -1.0,
      -1.0, 1.0, 9.0, -1.0, -1.0, 1.0, 12.0, -1.0, -1.0, 1.0, 13.0, -1.0, -1.0, 1.0, 28.0,
      9.0, 61.0, 0.0, 18.0, 2.0, 1.0, 18.0, 2.0, 1.0, 1.0, 2.0, 4.0, 3.0, -1.0, -1.0,
      1.0, 8.0, -1.0, -1.0, 1.0, 12.0, -1.0, -1.0, 1.0, 13.0, -1.0, -1.0, 1.0, 24.0, 10.0,
      60.0, 0.0, 17.0, 14.0, 1.0, 17.0, 14.0, 2.0, 0.0, 2.0, 3.0, 11.0, -1.0, -1.0, 1.0,
      4.0, -1.0, -1.0, 1.0, 5.0, -1.0, -1.0, 1.0, 24.0, 11.0, 60.0, 0.0, 17.0, 12.0, 1.0,
      17.0, 12.0, 2.0, 0.0, 2.0, 3.0, 10.0, -1.0, -1.0, 1.0, 4.0, -1.0, -1.0, 1.0, 5.0,
      -1.0, -1.0, 1.0, 28.0, 12.0, 61.0, 0.0, 16.0, 4.0, 1.0, 16.0, 4.0, 1.0, 1.0, 2.0,
      4.0, 3.0, -1.0, -1.0, 1.0, 8.0, -1.0, -1.0, 1.0, 9.0, -1.0, -1.0, 1.0, 13.0, -1.0,
      -1.0, 1.0, 28.0, 13.0, 61.0, 0.0, 16.0, 2.0, 1.0, 16.0, 2.0, 1.0, 1.0, 2.0, 4.0,
      3.0, -1.0, -1.0, 1.0, 8.0, -1.0, -1.0, 1.0, 9.0, -1.0, -1.0, 1.0, 12.0, -1.0, -1.0,
      1.0, 24.0, 14.0, 64.0, 0.0, 14.0, 14.0, 1.0, 14.0, 14.0, 2.0, 0.0, 2.0, 3.0, 22.0,
      -1.0, -1.0, 1.0, 23.0, -1.0, -1.0, 1.0, 15.0, -1.0, -1.0, 1.0, 24.0, 15.0, 64.0, 0.0,
      14.0, 12.0, 1.0, 14.0, 12.0, 2.0, 0.0, 2.0, 3.0, 14.0, -1.0, -1.0, 1.0, 22.0, -1.0,
      -1.0, 1.0, 23.0, -1.0, -1.0, 1.0, 24.0, 16.0, 66.0, 0.0, 14.0, 9.0, 1.0, 14.0, 9.0,
      1.0, 1.0, 2.0, 3.0, 25.0, -1.0, -1.0, 1.0, 17.0, -1.0, -1.0, 1.0, 24.0, -1.0, -1.0,
      1.0, 24.0, 17.0, 66.0, 0.0, 14.0, 7.0, 1.0, 14.0, 7.0, 1.0, 1.0, 2.0, 3.0, 25.0,
      -1.0, -1.0, 1.0, 16.0, -1.0, -1.0, 1.0, 24.0, -1.0, -1.0, 1.0, 64.0, 18.0, 65.0, 0.0,
      14.0, 4.0, 1.0, 14.0, 4.0, 1.0, 1.0, 2.0, 13.0, 37.0, -1.0, -1.0, 1.0, 38.0, -1.0,
      -1.0, 1.0, 43.0, -1.0, -1.0, 1.0, 44.0, -1.0, -1.0, 1.0, 49.0, -1.0, -1.0, 1.0, 50.0,
      -1.0, -1.0, 1.0, 19.0, -1.0, -1.0, 1.0, 55.0, -1.0, -1.0, 1.0, 56.0, -1.0, -1.0, 1.0,
      26.0, -1.0, -1.0, 1.0, 27.0, -1.0, -1.0, 1.0, 30.0, -1.0, -1.0, 1.0, 31.0, -1.0, -1.0,
      1.0, 64.0, 19.0, 65.0, 0.0, 14.0, 2.0, 1.0, 14.0, 2.0, 1.0, 1.0, 2.0, 13.0, 37.0,
      -1.0, -1.0, 1.0, 38.0, -1.0, -1.0, 1.0, 43.0, -1.0, -1.0, 1.0, 44.0, -1.0, -1.0, 1.0,
      49.0, -1.0, -1.0, 1.0, 50.0, -1.0, -1.0, 1.0, 18.0, -1.0, -1.0, 1.0, 55.0, -1.0, -1.0,
      1.0, 56.0, -1.0, -1.0, 1.0, 26.0, -1.0, -1.0, 1.0, 27.0, -1.0, -1.0, 1.0, 30.0, -1.0,
      -1.0, 1.0, 31.0, -1.0, -1.0, 1.0, 24.0, 20.0, 67.0, 0.0, 13.0, 19.0, 1.0, 13.0, 19.0,
      1.0, 1.0, 2.0, 3.0, 28.0, -1.0, -1.0, 1.0, 29.0, -1.0, -1.0, 1.0, 21.0, -1.0, -1.0,
      1.0, 24.0, 21.0, 67.0, 0.0, 13.0, 17.0, 1.0, 13.0, 17.0, 1.0, 1.0, 2.0, 3.0, 20.0,
      -1.0, -1.0, 1.0, 28.0, -1.0, -1.0, 1.0, 29.0, -1.0, -1.0, 1.0, 24.0, 22.0, 64.0, 0.0,
      12.0, 14.0, 1.0, 12.0, 14.0, 2.0, 0.0, 2.0, 3.0, 14.0, -1.0, -1.0, 1.0, 23.0, -1.0,
      -1.0, 1.0, 15.0, -1.0, -1.0, 1.0, 24.0, 23.0, 64.0, 0.0, 12.0, 12.0, 1.0, 12.0, 12.0,
      2.0, 0.0, 2.0, 3.0, 14.0, -1.0, -1.0, 1.0, 22.0, -1.0, -1.0, 1.0, 15.0, -1.0, -1.0,
      1.0, 24.0, 24.0, 66.0, 0.0, 12.0, 9.0, 1.0, 12.0, 9.0, 1.0, 1.0, 2.0, 3.0, 25.0,
      -1.0, -1.0, 1.0, 17.0, -1.0, -1.0, 1.0, 16.0, -1.0, -1.0, 1.0, 24.0, 25.0, 66.0, 0.0,
      12.0, 7.0, 1.0, 12.0, 7.0, 1.0, 1.0, 2.0, 3.0, 17.0, -1.0, -1.0, 1.0, 16.0, -1.0,
      -1.0, 1.0, 24.0, -1.0, -1.0, 1.0, 64.0, 26.0, 65.0, 0.0, 12.0, 4.0, 1.0, 12.0, 4.0,
      1.0, 1.0, 2.0, 13.0, 37.0, -1.0, -1.0, 1.0, 38.0, -1.0, -1.0, 1.0, 43.0, -1.0, -1.0,
      1.0, 44.0, -1.0, -1.0, 1.0, 49.0, -1.0, -1.0, 1.0, 50.0, -1.0, -1.0, 1.0, 19.0, -1.0,
      -1.0, 1.0, 18.0, -1.0, -1.0, 1.0, 55.0, -1.0, -1.0, 1.0, 56.0, -1.0, -1.0, 1.0, 27.0,
      -1.0, -1.0, 1.0, 30.0, -1.0, -1.0, 1.0, 31.0, -1.0, -1.0, 1.0, 64.0, 27.0, 65.0, 0.0,
      12.0, 2.0, 1.0, 12.0, 2.0, 1.0, 1.0, 2.0, 13.0, 37.0, -1.0, -1.0, 1.0, 38.0, -1.0,
      -1.0, 1.0, 43.0, -1.0, -1.0, 1.0, 44.0, -1.0, -1.0, 1.0, 49.0, -1.0, -1.0, 1.0, 50.0,
      -1.0, -1.0, 1.0, 19.0, -1.0, -1.0, 1.0, 18.0, -1.0, -1.0, 1.0, 55.0, -1.0, -1.0, 1.0,
      56.0, -1.0, -1.0, 1.0, 26.0, -1.0, -1.0, 1.0, 30.0, -1.0, -1.0, 1.0, 31.0, -1.0, -1.0,
      1.0, 24.0, 28.0, 67.0, 0.0, 11.0, 19.0, 1.0, 11.0, 19.0, 1.0, 1.0, 2.0, 3.0, 20.0,
      -1.0, -1.0, 1.0, 29.0, -1.0, -1.0, 1.0, 21.0, -1.0, -1.0, 1.0, 24.0, 29.0, 67.0, 0.0,
      11.0, 17.0, 1.0, 11.0, 17.0, 1.0, 1.0, 2.0, 3.0, 20.0, -1.0, -1.0, 1.0, 28.0, -1.0,
      -1.0, 1.0, 21.0, -1.0, -1.0, 1.0, 64.0, 30.0, 65.0, 0.0, 10.0, 4.0, 1.0, 10.0, 4.0,
      1.0, 1.0, 2.0, 13.0, 37.0, -1.0, -1.0, 1.0, 38.0, -1.0, -1.0, 1.0, 43.0, -1.0, -1.0,
      1.0, 44.0, -1.0, -1.0, 1.0, 49.0, -1.0, -1.0, 1.0, 50.0, -1.0, -1.0, 1.0, 19.0, -1.0,
      -1.0, 1.0, 18.0, -1.0, -1.0, 1.0, 55.0, -1.0, -1.0, 1.0, 56.0, -1.0, -1.0, 1.0, 26.0,
      -1.0, -1.0, 1.0, 27.0, -1.0, -1.0, 1.0, 31.0, -1.0, -1.0, 1.0, 64.0, 31.0, 65.0, 0.0,
      10.0, 2.0, 1.0, 10.0, 2.0, 1.0, 1.0, 2.0, 13.0, 37.0, -1.0, -1.0, 1.0, 38.0, -1.0,
      -1.0, 1.0, 43.0, -1.0, -1.0, 1.0, 44.0, -1.0, -1.0, 1.0, 49.0, -1.0, -1.0, 1.0, 50.0,
      -1.0, -1.0, 1.0, 19.0, -1.0, -1.0, 1.0, 18.0, -1.0, -1.0, 1.0, 55.0, -1.0, -1.0, 1.0,
      56.0, -1.0, -1.0, 1.0, 26.0, -1.0, -1.0, 1.0, 27.0, -1.0, -1.0, 1.0, 30.0, -1.0, -1.0,
      1.0, 24.0, 32.0, 58.0, 0.0, 9.0, 14.0, 1.0, 9.0, 14.0, 1.0, 2.0, 3.0, 3.0, 33.0,
      -1.0, -1.0, 1.0, 39.0, -1.0, -1.0, 1.0, 40.0, -1.0, -1.0, 1.0, 24.0, 33.0, 58.0, 0.0,
      9.0, 12.0, 1.0, 9.0, 12.0, 1.0, 2.0, 3.0, 3.0, 32.0, -1.0, -1.0, 1.0, 39.0, -1.0,
      -1.0, 1.0, 40.0, -1.0, -1.0, 1.0, 24.0, 34.0, 59.0, 0.0, 9.0, 9.0, 1.0, 9.0, 9.0,
      1.0, 1.0, 2.0, 3.0, 41.0, -1.0, -1.0, 1.0, 42.0, -1.0, -1.0, 1.0, 35.0, -1.0, -1.0,
      1.0, 24.0, 35.0, 59.0, 0.0, 9.0, 7.0, 1.0, 9.0, 7.0, 1.0, 1.0, 2.0, 3.0, 41.0,
      -1.0, -1.0, 1.0, 42.0, -1.0, -1.0, 1.0, 34.0, -1.0, -1.0, 1.0, 76.0, 36.0, 68.0, 0.0,
      8.0, 18.0, 5.0, 8.0, 18.0, 1.0, 1.0, 2.0, 9.0, 19.0, 1.0, 1.0, 2.0, 7.0, 19.0,
      1.0, 1.0, 2.0, 9.0, 17.0, 1.0, 1.0, 2.0, 7.0, 17.0, 1.0, 6.0, 3.0, 11.0, 65.0,
      1.0, 1.0, 0.0, 66.0, -1.0, -1.0, 1.0, 67.0, -1.0, -1.0, 1.0, 57.0, -1.0, -1.0, 1.0,
      58.0, -1.0, -1.0, 1.0, 59.0, -1.0, -1.0, 1.0, 60.0, -1.0, -1.0, 1.0, 61.0, -1.0, -1.0,
      1.0, 62.0, -1.0, -1.0, 1.0, 63.0, -1.0, -1.0, 1.0, 64.0, -1.0, -1.0, 1.0, 64.0, 37.0,
      65.0, 0.0, 8.0, 4.0, 1.0, 8.0, 4.0, 1.0, 1.0, 2.0, 13.0, 38.0, -1.0, -1.0, 1.0,
      43.0, -1.0, -1.0, 1.0, 44.0, -1.0, -1.0, 1.0, 49.0, -1.0, -1.0, 1.0, 50.0, -1.0, -1.0,
      1.0, 19.0, -1.0, -1.0, 1.0, 18.0, -1.0, -1.0, 1.0, 55.0, -1.0, -1.0, 1.0, 56.0, -1.0,
      -1.0, 1.0, 26.0, -1.0, -1.0, 1.0, 27.0, -1.0, -1.0, 1.0, 30.0, -1.0, -1.0, 1.0, 31.0,
      -1.0, -1.0, 1.0, 64.0, 38.0, 65.0, 0.0, 8.0, 2.0, 1.0, 8.0, 2.0, 1.0, 1.0, 2.0,
      13.0, 37.0, -1.0, -1.0, 1.0, 43.0, -1.0, -1.0, 1.0, 44.0, -1.0, -1.0, 1.0, 49.0, -1.0,
      -1.0, 1.0, 50.0, -1.0, -1.0, 1.0, 19.0, -1.0, -1.0, 1.0, 18.0, -1.0, -1.0, 1.0, 55.0,
      -1.0, -1.0, 1.0, 56.0, -1.0, -1.0, 1.0, 26.0, -1.0, -1.0, 1.0, 27.0, -1.0, -1.0, 1.0,
      30.0, -1.0, -1.0, 1.0, 31.0, -1.0, -1.0, 1.0, 24.0, 39.0, 58.0, 0.0, 7.0, 14.0, 1.0,
      7.0, 14.0, 1.0, 2.0, 3.0, 3.0, 33.0, -1.0, -1.0, 1.0, 32.0, -1.0, -1.0, 1.0, 40.0,
      -1.0, -1.0, 1.0, 24.0, 40.0, 58.0, 0.0, 7.0, 12.0, 1.0, 7.0, 12.0, 1.0, 2.0, 3.0,
      3.0, 33.0, -1.0, -1.0, 1.0, 32.0, -1.0, -1.0, 1.0, 39.0, -1.0, -1.0, 1.0, 24.0, 41.0,
      59.0, 0.0, 7.0, 9.0, 1.0, 7.0, 9.0, 1.0, 1.0, 2.0, 3.0, 42.0, -1.0, -1.0, 1.0,
      35.0, -1.0, -1.0, 1.0, 34.0, -1.0, -1.0, 1.0, 24.0, 42.0, 59.0, 0.0, 7.0, 7.0, 1.0,
      7.0, 7.0, 1.0, 1.0, 2.0, 3.0, 41.0, -1.0, -1.0, 1.0, 35.0, -1.0, -1.0, 1.0, 34.0,
      -1.0, -1.0, 1.0, 64.0, 43.0, 65.0, 0.0, 6.0, 4.0, 1.0, 6.0, 4.0, 1.0, 1.0, 2.0,
      13.0, 37.0, -1.0, -1.0, 1.0, 38.0, -1.0, -1.0, 1.0, 44.0, -1.0, -1.0, 1.0, 49.0, -1.0,
      -1.0, 1.0, 50.0, -1.0, -1.0, 1.0, 19.0, -1.0, -1.0, 1.0, 18.0, -1.0, -1.0, 1.0, 55.0,
      -1.0, -1.0, 1.0, 56.0, -1.0, -1.0, 1.0, 26.0, -1.0, -1.0, 1.0, 27.0, -1.0, -1.0, 1.0,
      30.0, -1.0, -1.0, 1.0, 31.0, -1.0, -1.0, 1.0, 64.0, 44.0, 65.0, 0.0, 6.0, 2.0, 1.0,
      6.0, 2.0, 1.0, 1.0, 2.0, 13.0, 37.0, -1.0, -1.0, 1.0, 38.0, -1.0, -1.0, 1.0, 43.0,
      -1.0, -1.0, 1.0, 49.0, -1.0, -1.0, 1.0, 50.0, -1.0, -1.0, 1.0, 19.0, -1.0, -1.0, 1.0,
      18.0, -1.0, -1.0, 1.0, 55.0, -1.0, -1.0, 1.0, 56.0, -1.0, -1.0, 1.0, 26.0, -1.0, -1.0,
      1.0, 27.0, -1.0, -1.0, 1.0, 30.0, -1.0, -1.0, 1.0, 31.0, -1.0, -1.0, 1.0, 24.0, 45.0,
      62.0, 0.0, 4.0, 14.0, 1.0, 4.0, 14.0, 1.0, 1.0, 2.0, 3.0, 51.0, -1.0, -1.0, 1.0,
      52.0, -1.0, -1.0, 1.0, 46.0, -1.0, -1.0, 1.0, 24.0, 46.0, 62.0, 0.0, 4.0, 12.0, 1.0,
      4.0, 12.0, 1.0, 1.0, 2.0, 3.0, 51.0, -1.0, -1.0, 1.0, 52.0, -1.0, -1.0, 1.0, 45.0,
      -1.0, -1.0, 1.0, 24.0, 47.0, 63.0, 0.0, 4.0, 9.0, 1.0, 4.0, 9.0, 1.0, 1.0, 2.0,
      3.0, 53.0, -1.0, -1.0, 1.0, 54.0, -1.0, -1.0, 1.0, 48.0, -1.0, -1.0, 1.0, 24.0, 48.0,
      63.0, 0.0, 4.0, 7.0, 1.0, 4.0, 7.0, 1.0, 1.0, 2.0, 3.0, 53.0, -1.0, -1.0, 1.0,
      54.0, -1.0, -1.0, 1.0, 47.0, -1.0, -1.0, 1.0, 64.0, 49.0, 65.0, 0.0, 4.0, 4.0, 1.0,
      4.0, 4.0, 1.0, 1.0, 2.0, 13.0, 37.0, -1.0, -1.0, 1.0, 38.0, -1.0, -1.0, 1.0, 43.0,
      -1.0, -1.0, 1.0, 44.0, -1.0, -1.0, 1.0, 50.0, -1.0, -1.0, 1.0, 19.0, -1.0, -1.0, 1.0,
      18.0, -1.0, -1.0, 1.0, 55.0, -1.0, -1.0, 1.0, 56.0, -1.0, -1.0, 1.0, 26.0, -1.0, -1.0,
      1.0, 27.0, -1.0, -1.0, 1.0, 30.0, -1.0, -1.0, 1.0, 31.0, -1.0, -1.0, 1.0, 64.0, 50.0,
      65.0, 0.0, 4.0, 2.0, 1.0, 4.0, 2.0, 1.0, 1.0, 2.0, 13.0, 37.0, -1.0, -1.0, 1.0,
      38.0, -1.0, -1.0, 1.0, 43.0, -1.0, -1.0, 1.0, 44.0, -1.0, -1.0, 1.0, 49.0, -1.0, -1.0,
      1.0, 19.0, -1.0, -1.0, 1.0, 18.0, -1.0, -1.0, 1.0, 55.0, -1.0, -1.0, 1.0, 56.0, -1.0,
      -1.0, 1.0, 26.0, -1.0, -1.0, 1.0, 27.0, -1.0, -1.0, 1.0, 30.0, -1.0, -1.0, 1.0, 31.0,
      -1.0, -1.0, 1.0, 24.0, 51.0, 62.0, 0.0, 2.0, 14.0, 1.0, 2.0, 14.0, 1.0, 1.0, 2.0,
      3.0, 52.0, -1.0, -1.0, 1.0, 45.0, -1.0, -1.0, 1.0, 46.0, -1.0, -1.0, 1.0, 24.0, 52.0,
      62.0, 0.0, 2.0, 12.0, 1.0, 2.0, 12.0, 1.0, 1.0, 2.0, 3.0, 51.0, -1.0, -1.0, 1.0,
      45.0, -1.0, -1.0, 1.0, 46.0, -1.0, -1.0, 1.0, 24.0, 53.0, 63.0, 0.0, 2.0, 9.0, 1.0,
      2.0, 9.0, 1.0, 1.0, 2.0, 3.0, 54.0, -1.0, -1.0, 1.0, 47.0, -1.0, -1.0, 1.0, 48.0,
      -1.0, -1.0, 1.0, 24.0, 54.0, 63.0, 0.0, 2.0, 7.0, 1.0, 2.0, 7.0, 1.0, 1.0, 2.0,
      3.0, 53.0, -1.0, -1.0, 1.0, 47.0, -1.0, -1.0, 1.0, 48.0, -1.0, -1.0, 1.0, 64.0, 55.0,
      65.0, 0.0, 2.0, 4.0, 1.0, 2.0, 4.0, 1.0, 1.0, 2.0, 13.0, 37.0, -1.0, -1.0, 1.0,
      38.0, -1.0, -1.0, 1.0, 43.0, -1.0, -1.0, 1.0, 44.0, -1.0, -1.0, 1.0, 49.0, -1.0, -1.0,
      1.0, 50.0, -1.0, -1.0, 1.0, 19.0, -1.0, -1.0, 1.0, 18.0, -1.0, -1.0, 1.0, 56.0, -1.0,
      -1.0, 1.0, 26.0, -1.0, -1.0, 1.0, 27.0, -1.0, -1.0, 1.0, 30.0, -1.0, -1.0, 1.0, 31.0,
      -1.0, -1.0, 1.0, 64.0, 56.0, 65.0, 0.0, 2.0, 2.0, 1.0, 2.0, 2.0, 1.0, 1.0, 2.0,
      13.0, 37.0, -1.0, -1.0, 1.0, 38.0, -1.0, -1.0, 1.0, 43.0, -1.0, -1.0, 1.0, 44.0, -1.0,
      -1.0, 1.0, 49.0, -1.0, -1.0, 1.0, 50.0, -1.0, -1.0, 1.0, 19.0, -1.0, -1.0, 1.0, 18.0,
      -1.0, -1.0, 1.0, 55.0, -1.0, -1.0, 1.0, 26.0, -1.0, -1.0, 1.0, 27.0, -1.0, -1.0, 1.0,
      30.0, -1.0, -1.0, 1.0, 31.0, -1.0, -1.0, 1.0, 80.0, 57.0, 68.0, 4.0, 1.0, 2.0, 6.0,
      7.0, 20.0, 9.0, 5.0, 20.0, 9.0, 1.0, 0.0, 2.0, 19.0, 8.0, 1.0, 0.0, 2.0, 18.0,
      9.0, 1.0, 0.0, 2.0, 20.0, 7.0, 1.0, 0.0, 2.0, 18.0, 7.0, 1.0, 5.0, 3.0, 11.0,
      65.0, 1.0, 1.0, 0.0, 66.0, -1.0, -1.0, 1.0, 67.0, -1.0, -1.0, 1.0, 36.0, -1.0, -1.0,
      1.0, 58.0, -1.0, -1.0, 1.0, 59.0, -1.0, -1.0, 1.0, 60.0, -1.0, -1.0, 1.0, 61.0, -1.0,
      -1.0, 1.0, 62.0, -1.0, -1.0, 1.0, 63.0, -1.0, -1.0, 1.0, 64.0, -1.0, -1.0, 1.0, 60.0,
      58.0, 68.0, 4.0, 33.0, 32.0, 39.0, 40.0, 9.0, 12.0, 1.0, 9.0, 12.0, 1.0, 0.0, 3.0,
      11.0, 65.0, 1.0, 1.0, 0.0, 66.0, -1.0, -1.0, 1.0, 67.0, -1.0, -1.0, 1.0, 36.0, -1.0,
      -1.0, 1.0, 57.0, -1.0, -1.0, 1.0, 59.0, -1.0, -1.0, 1.0, 60.0, -1.0, -1.0, 1.0, 61.0,
      -1.0, -1.0, 1.0, 62.0, -1.0, -1.0, 1.0, 63.0, -1.0, -1.0, 1.0, 64.0, -1.0, -1.0, 1.0,
      80.0, 59.0, 68.0, 4.0, 41.0, 42.0, 35.0, 34.0, 7.0, 9.0, 5.0, 7.0, 9.0, 1.0, 0.0,
      2.0, 8.0, 8.0, 1.0, 0.0, 2.0, 9.0, 9.0, 1.0, 0.0, 2.0, 7.0, 7.0, 1.0, 0.0,
      2.0, 9.0, 7.0, 1.0, 5.0, 3.0, 11.0, 65.0, 1.0, 1.0, 0.0, 66.0, -1.0, -1.0, 1.0,
      67.0, -1.0, -1.0, 1.0, 36.0, -1.0, -1.0, 1.0, 57.0, -1.0, -1.0, 1.0, 58.0, -1.0, -1.0,
      1.0, 60.0, -1.0, -1.0, 1.0, 61.0, -1.0, -1.0, 1.0, 62.0, -1.0, -1.0, 1.0, 63.0, -1.0,
      -1.0, 1.0, 64.0, -1.0, -1.0, 1.0, 80.0, 60.0, 68.0, 4.0, 10.0, 11.0, 4.0, 5.0, 17.0,
      14.0, 5.0, 17.0, 14.0, 2.0, 0.0, 2.0, 18.0, 13.0, 2.0, 0.0, 2.0, 19.0, 14.0, 2.0,
      0.0, 2.0, 19.0, 12.0, 2.0, 0.0, 2.0, 17.0, 12.0, 2.0, 0.0, 3.0, 11.0, 65.0, 1.0,
      1.0, 0.0, 66.0, -1.0, -1.0, 1.0, 67.0, -1.0, -1.0, 1.0, 36.0, -1.0, -1.0, 1.0, 57.0,
      -1.0, -1.0, 1.0, 58.0, -1.0, -1.0, 1.0, 59.0, -1.0, -1.0, 1.0, 61.0, -1.0, -1.0, 1.0,
      62.0, -1.0, -1.0, 1.0, 63.0, -1.0, -1.0, 1.0, 64.0, -1.0, -1.0, 1.0, 91.0, 61.0, 68.0,
      5.0, 3.0, 8.0, 9.0, 12.0, 13.0, 20.0, 2.0, 7.0, 20.0, 2.0, 1.0, 0.0, 2.0, 19.0,
      3.0, 1.0, 0.0, 2.0, 18.0, 4.0, 1.0, 0.0, 2.0, 18.0, 2.0, 1.0, 0.0, 2.0, 17.0,
      3.0, 1.0, 0.0, 2.0, 16.0, 4.0, 1.0, 0.0, 2.0, 16.0, 2.0, 1.0, 7.0, 3.0, 11.0,
      65.0, 3.0, 1.0, 0.0, 66.0, -1.0, -1.0, 1.0, 67.0, -1.0, -1.0, 1.0, 36.0, -1.0, -1.0,
      1.0, 57.0, -1.0, -1.0, 1.0, 58.0, -1.0, -1.0, 1.0, 59.0, -1.0, -1.0, 1.0, 60.0, -1.0,
      -1.0, 1.0, 62.0, -1.0, -1.0, 1.0, 63.0, -1.0, -1.0, 1.0, 64.0, -1.0, -1.0, 1.0, 80.0,
      62.0, 68.0, 4.0, 51.0, 52.0, 45.0, 46.0, 2.0, 14.0, 5.0, 2.0, 14.0, 1.0, 0.0, 2.0,
      3.0, 13.0, 1.0, 0.0, 2.0, 4.0, 14.0, 1.0, 0.0, 2.0, 2.0, 12.0, 1.0, 0.0, 2.0,
      4.0, 12.0, 1.0, 5.0, 3.0, 11.0, 65.0, 1.0, 1.0, 0.0, 66.0, -1.0, -1.0, 1.0, 67.0,
      -1.0, -1.0, 1.0, 36.0, -1.0, -1.0, 1.0, 57.0, -1.0, -1.0, 1.0, 58.0, -1.0, -1.0, 1.0,
      59.0, -1.0, -1.0, 1.0, 60.0, -1.0, -1.0, 1.0, 61.0, -1.0, -1.0, 1.0, 63.0, -1.0, -1.0,
      1.0, 64.0, -1.0, -1.0, 1.0, 80.0, 63.0, 68.0, 4.0, 53.0, 54.0, 47.0, 48.0, 2.0, 9.0,
      5.0, 2.0, 9.0, 1.0, 0.0, 2.0, 3.0, 8.0, 1.0, 0.0, 2.0, 4.0, 9.0, 1.0, 0.0,
      2.0, 2.0, 7.0, 1.0, 0.0, 2.0, 4.0, 7.0, 1.0, 5.0, 3.0, 11.0, 65.0, 1.0, 1.0,
      0.0, 66.0, -1.0, -1.0, 1.0, 67.0, -1.0, -1.0, 1.0, 36.0, -1.0, -1.0, 1.0, 57.0, -1.0,
      -1.0, 1.0, 58.0, -1.0, -1.0, 1.0, 59.0, -1.0, -1.0, 1.0, 60.0, -1.0, -1.0, 1.0, 61.0,
      -1.0, -1.0, 1.0, 62.0, -1.0, -1.0, 1.0, 64.0, -1.0, -1.0, 1.0, 80.0, 64.0, 68.0, 4.0,
      14.0, 22.0, 23.0, 15.0, 14.0, 14.0, 5.0, 14.0, 14.0, 2.0, 0.0, 2.0, 13.0, 13.0, 2.0,
      0.0, 2.0, 12.0, 14.0, 2.0, 0.0, 2.0, 14.0, 12.0, 2.0, 0.0, 2.0, 12.0, 12.0, 2.0,
      0.0, 3.0, 11.0, 65.0, 1.0, 1.0, 0.0, 66.0, -1.0, -1.0, 1.0, 67.0, -1.0, -1.0, 1.0,
      36.0, -1.0, -1.0, 1.0, 57.0, -1.0, -1.0, 1.0, 58.0, -1.0, -1.0, 1.0, 59.0, -1.0, -1.0,
      1.0, 60.0, -1.0, -1.0, 1.0, 61.0, -1.0, -1.0, 1.0, 62.0, -1.0, -1.0, 1.0, 63.0, -1.0,
      -1.0, 1.0, 165.0, 65.0, 68.0, 14.0, 37.0, 38.0, 43.0, 44.0, 49.0, 50.0, 19.0, 18.0, 55.0,
      56.0, 26.0, 27.0, 30.0, 31.0, 8.0, 4.0, 20.0, 8.0, 4.0, 1.0, 0.0, 2.0, 9.0, 3.0,
      1.0, 0.0, 2.0, 7.0, 3.0, 1.0, 0.0, 2.0, 8.0, 2.0, 1.0, 0.0, 2.0, 6.0, 4.0,
      1.0, 0.0, 2.0, 6.0, 2.0, 1.0, 0.0, 2.0, 10.0, 4.0, 1.0, 0.0, 2.0, 10.0, 2.0,
      1.0, 0.0, 2.0, 11.0, 3.0, 1.0, 0.0, 2.0, 5.0, 3.0, 1.0, 0.0, 2.0, 12.0, 4.0,
      1.0, 0.0, 2.0, 12.0, 2.0, 1.0, 0.0, 2.0, 4.0, 4.0, 1.0, 0.0, 2.0, 4.0, 2.0,
      1.0, 0.0, 2.0, 13.0, 3.0, 1.0, 0.0, 2.0, 3.0, 3.0, 1.0, 0.0, 2.0, 14.0, 4.0,
      1.0, 0.0, 2.0, 14.0, 2.0, 1.0, 0.0, 2.0, 2.0, 4.0, 1.0, 0.0, 2.0, 2.0, 2.0,
      1.0, 20.0, 3.0, 11.0, 66.0, -1.0, -1.0, 1.0, 67.0, -1.0, -1.0, 1.0, 36.0, -1.0, -1.0,
      1.0, 57.0, -1.0, -1.0, 1.0, 58.0, -1.0, -1.0, 1.0, 59.0, -1.0, -1.0, 1.0, 60.0, -1.0,
      -1.0, 1.0, 61.0, -1.0, -1.0, 1.0, 62.0, -1.0, -1.0, 1.0, 63.0, -1.0, -1.0, 1.0, 64.0,
      -1.0, -1.0, 1.0, 80.0, 66.0, 68.0, 4.0, 25.0, 17.0, 16.0, 24.0, 12.0, 7.0, 5.0, 12.0,
      7.0, 1.0, 0.0, 2.0, 13.0, 8.0, 1.0, 0.0, 2.0, 14.0, 9.0, 1.0, 0.0, 2.0, 14.0,
      7.0, 1.0, 0.0, 2.0, 12.0, 9.0, 1.0, 5.0, 3.0, 11.0, 65.0, 1.0, 1.0, 0.0, 67.0,
      -1.0, -1.0, 1.0, 36.0, -1.0, -1.0, 1.0, 57.0, -1.0, -1.0, 1.0, 58.0, -1.0, -1.0, 1.0,
      59.0, -1.0, -1.0, 1.0, 60.0, -1.0, -1.0, 1.0, 61.0, -1.0, -1.0, 1.0, 62.0, -1.0, -1.0,
      1.0, 63.0, -1.0, -1.0, 1.0, 64.0, -1.0, -1.0, 1.0, 80.0, 67.0, 68.0, 4.0, 20.0, 28.0,
      29.0, 21.0, 13.0, 19.0, 5.0, 13.0, 19.0, 1.0, 0.0, 2.0, 12.0, 18.0, 1.0, 0.0, 2.0,
      11.0, 19.0, 1.0, 0.0, 2.0, 11.0, 17.0, 1.0, 0.0, 2.0, 13.0, 17.0, 1.0, 5.0, 3.0,
      11.0, 65.0, 1.0, 1.0, 0.0, 66.0, -1.0, -1.0, 1.0, 36.0, -1.0, -1.0, 1.0, 57.0, -1.0,
      -1.0, 1.0, 58.0, -1.0, -1.0, 1.0, 59.0, -1.0, -1.0, 1.0, 60.0, -1.0, -1.0, 1.0, 61.0,
      -1.0, -1.0, 1.0, 62.0, -1.0, -1.0, 1.0, 63.0, -1.0, -1.0, 1.0, 64.0, -1.0, -1.0, 1.0,
      538.0, 68.0, -1.0, 12.0, 65.0, 66.0, 67.0, 36.0, 57.0, 58.0, 59.0, 60.0, 61.0, 62.0, 63.0,
      64.0, 8.0, 4.0, 103.0, 8.0, 4.0, 1.0, 0.0, 3.0, 9.0, 3.0, 1.0, 0.0, 3.0, 7.0,
      3.0, 1.0, 0.0, 3.0, 8.0, 2.0, 1.0, 0.0, 3.0, 6.0, 4.0, 1.0, 0.0, 3.0, 6.0,
      2.0, 1.0, 0.0, 3.0, 10.0, 4.0, 1.0, 0.0, 3.0, 10.0, 2.0, 1.0, 0.0, 3.0, 11.0,
      3.0, 1.0, 0.0, 3.0, 5.0, 3.0, 1.0, 0.0, 3.0, 12.0, 4.0, 1.0, 0.0, 3.0, 12.0,
      2.0, 1.0, 0.0, 3.0, 4.0, 4.0, 1.0, 0.0, 3.0, 4.0, 2.0, 1.0, 0.0, 3.0, 13.0,
      3.0, 1.0, 0.0, 3.0, 3.0, 5.0, 2.0, 0.0, 3.0, 3.0, 3.0, 1.0, 0.0, 3.0, 14.0,
      4.0, 1.0, 0.0, 3.0, 2.0, 2.0, 1.0, 0.0, 3.0, 15.0, 3.0, 1.0, 0.0, 3.0, 14.0,
      2.0, 1.0, 0.0, 3.0, 16.0, 4.0, 1.0, 0.0, 3.0, 16.0, 2.0, 1.0, 0.0, 3.0, 17.0,
      3.0, 1.0, 0.0, 3.0, 3.0, 6.0, 1.0, 0.0, 3.0, 2.0, 4.0, 1.0, 0.0, 3.0, 18.0,
      4.0, 1.0, 0.0, 3.0, 18.0, 2.0, 1.0, 0.0, 3.0, 4.0, 7.0, 1.0, 0.0, 3.0, 2.0,
      7.0, 1.0, 0.0, 3.0, 19.0, 3.0, 1.0, 0.0, 3.0, 5.0, 8.0, 1.0, 0.0, 3.0, 3.0,
      8.0, 1.0, 0.0, 3.0, 20.0, 2.0, 1.0, 0.0, 3.0, 4.0, 9.0, 1.0, 0.0, 3.0, 6.0,
      8.0, 1.0, 0.0, 3.0, 2.0, 9.0, 1.0, 0.0, 3.0, 3.0, 10.0, 1.0, 0.0, 3.0, 7.0,
      9.0, 1.0, 0.0, 3.0, 7.0, 7.0, 1.0, 0.0, 3.0, 8.0, 8.0, 1.0, 0.0, 3.0, 3.0,
      11.0, 2.0, 0.0, 3.0, 9.0, 9.0, 1.0, 0.0, 3.0, 9.0, 7.0, 1.0, 0.0, 3.0, 4.0,
      12.0, 1.0, 0.0, 3.0, 2.0, 12.0, 1.0, 0.0, 3.0, 10.0, 8.0, 1.0, 0.0, 3.0, 3.0,
      13.0, 1.0, 0.0, 3.0, 5.0, 13.0, 2.0, 0.0, 3.0, 11.0, 8.0, 1.0, 0.0, 3.0, 4.0,
      14.0, 1.0, 0.0, 3.0, 2.0, 14.0, 1.0, 0.0, 3.0, 6.0, 13.0, 2.0, 0.0, 3.0, 12.0,
      9.0, 1.0, 0.0, 3.0, 12.0, 7.0, 1.0, 0.0, 3.0, 3.0, 15.0, 2.0, 0.0, 3.0, 7.0,
      14.0, 1.0, 0.0, 3.0, 7.0, 12.0, 1.0, 0.0, 3.0, 13.0, 8.0, 1.0, 0.0, 3.0, 3.0,
      16.0, 2.0, 0.0, 3.0, 8.0, 13.0, 1.0, 0.0, 3.0, 14.0, 9.0, 1.0, 0.0, 3.0, 14.0,
      7.0, 1.0, 0.0, 3.0, 3.0, 17.0, 2.0, 0.0, 3.0, 15.0, 8.0, 1.0, 0.0, 3.0, 9.0,
      14.0, 1.0, 0.0, 3.0, 4.0, 18.0, 2.0, 0.0, 3.0, 3.0, 18.0, 2.0, 0.0, 3.0, 16.0,
      8.0, 1.0, 0.0, 3.0, 10.0, 13.0, 2.0, 0.0, 3.0, 5.0, 18.0, 1.0, 0.0, 3.0, 17.0,
      8.0, 1.0, 0.0, 3.0, 11.0, 13.0, 2.0, 0.0, 3.0, 6.0, 18.0, 1.0, 0.0, 3.0, 18.0,
      9.0, 1.0, 0.0, 3.0, 7.0, 17.0, 1.0, 0.0, 3.0, 19.0, 8.0, 1.0, 0.0, 3.0, 8.0,
      18.0, 1.0, 0.0, 3.0, 20.0, 9.0, 1.0, 0.0, 3.0, 20.0, 7.0, 1.0, 0.0, 3.0, 9.0,
      19.0, 1.0, 0.0, 3.0, 9.0, 17.0, 1.0, 0.0, 3.0, 10.0, 18.0, 1.0, 0.0, 3.0, 18.0,
      7.0, 1.0, 0.0, 3.0, 11.0, 19.0, 1.0, 0.0, 3.0, 11.0, 17.0, 1.0, 0.0, 3.0, 12.0,
      18.0, 1.0, 0.0, 3.0, 12.0, 14.0, 2.0, 0.0, 3.0, 13.0, 19.0, 1.0, 0.0, 3.0, 13.0,
      17.0, 1.0, 0.0, 3.0, 13.0, 13.0, 2.0, 0.0, 3.0, 12.0, 12.0, 2.0, 0.0, 3.0, 14.0,
      14.0, 2.0, 0.0, 3.0, 14.0, 12.0, 2.0, 0.0, 3.0, 15.0, 13.0, 2.0, 0.0, 3.0, 7.0,
      19.0, 1.0, 0.0, 3.0, 16.0, 13.0, 2.0, 0.0, 3.0, 9.0, 12.0, 1.0, 0.0, 3.0, 17.0,
      14.0, 2.0, 0.0, 3.0, 17.0, 12.0, 2.0, 0.0, 3.0, 18.0, 13.0, 2.0, 0.0, 3.0, 19.0,
      14.0, 2.0, 0.0, 3.0, 19.0, 12.0, 2.0, 80.0, 4.0, 1.0, -1.0, 4.0, 4.0, 0.0]
    self.assertEqual(output["number_of_lakes"],68)
    self.assertEqual(output["lakes_as_array"],expected_lakes_as_array)
    np.testing.assert_array_equal(output["lake_mask"],expected_lake_mask)

  def testEvaluateBasinsSeven(self):
    coarse_catchment_nums_in = np.array([[1,2,3,4],
                                         [5,6,7,8],
                                         [9,9,9,9],
                                         [9,9,9,0]],
                                         dtype=np.int32)
    corrected_orography_in = np.array([
      [9.0,9.0,9.0,9.0,9.0, 9.0,9.0,9.0,9.0,9.0, 9.0,9.0,9.0,9.0,9.0, 9.0,9.0,9.0,9.0,9.0],
      [9.0,9.0,9.0,9.0,9.0, 9.0,9.0,9.0,9.0,9.0, 9.0,9.0,9.0,3.0,4.0, 4.0,9.0,9.0,9.0,9.0],
      [9.0,7.0,8.0,6.0,7.0, 7.0,5.0,6.0,4.0,5.0, 5.0,4.0,4.5,9.0,9.0, 9.0,2.0,3.0,9.0,9.0],
      [9.0,9.0,9.0,9.0,9.0, 9.0,9.0,9.0,9.0,9.0, 9.0,9.0,9.0,3.0,4.0, 4.0,9.0,1.5,9.0,9.0],
      [9.0,9.0,9.0,9.0,9.0, 9.0,9.0,9.0,9.0,9.0, 9.0,9.0,9.0,9.0,9.0, 9.0,9.0,2.0,9.0,9.0],
      #
      [9.0,9.0,9.0,9.0,9.0, 9.0,9.0,9.0,9.0,9.0, 9.0,9.0,9.0,9.0,9.0, 9.0,9.0,2.0,9.0,9.0],
      [9.0,9.0,9.0,9.0,9.0, 9.0,9.0,9.0,9.0,9.0, 9.0,9.0,9.0,9.0,9.0, 9.0,9.0,1.0,9.0,9.0],
      [7.0,6.0,7.0,8.0,7.0, 6.0,7.0,7.0,7.5,5.0, 4.0,5.0,6.0,9.0,9.0, 9.0,9.0,1.5,9.0,9.0],
      [9.0,9.0,9.0,9.0,9.0, 9.0,9.0,9.0,9.0,9.0, 9.0,9.0,6.0,9.0,9.0, 9.0,9.0,1.5,9.0,9.0],
      [9.0,9.0,9.0,9.0,9.0, 9.0,9.0,9.0,9.0,9.0, 9.0,9.0,6.0,9.0,9.0, 9.0,9.0,1.5,9.0,9.0],
      #
      [9.0,9.0,4.0,9.0,9.0, 9.0,9.0,4.0,9.0,9.0, 9.0,9.0,4.0,9.0,9.0, 9.0,9.0,1.5,9.0,9.0],
      [9.0,9.0,4.0,9.0,9.0, 9.0,9.0,4.0,9.0,9.0, 9.0,9.0,4.0,9.0,9.0, 9.0,9.0,1.5,9.0,9.0],
      [9.0,9.0,4.0,9.0,9.0, 9.0,9.0,4.0,9.0,9.0, 9.0,9.0,4.0,9.0,9.0, 9.0,9.0,1.5,9.0,9.0],
      [9.0,9.0,4.0,9.0,9.0, 9.0,9.0,4.0,9.0,9.0, 9.0,9.0,4.0,9.0,9.0, 9.0,9.0,1.5,9.0,9.0],
      [9.0,9.0,4.0,9.0,9.0, 9.0,9.0,4.0,9.0,9.0, 9.0,9.0,4.0,9.0,7.0, 7.0,7.0,1.5,7.0,7.0],
      #
      [9.0,9.0,4.0,9.0,9.0, 9.0,9.0,4.0,9.0,9.0, 9.0,9.0,4.0,9.0,7.0, 0.0,0.0,0.0,0.0,0.0],
      [9.0,9.0,4.0,9.0,9.0, 9.0,9.0,4.0,9.0,9.0, 9.0,9.0,4.0,9.0,7.0, 0.0,0.0,0.0,0.0,0.0],
      [9.0,9.0,4.0,4.0,4.0, 9.0,9.0,4.0,4.0,4.0, 4.0,4.0,4.0,4.0,4.0, 0.0,0.0,0.0,0.0,0.0],
      [9.0,9.0,9.0,9.0,9.0, 9.0,9.0,9.0,9.0,9.0, 9.0,9.0,9.0,9.0,7.0, 0.0,0.0,0.0,0.0,0.0],
      [9.0,9.0,9.0,9.0,9.0, 9.0,9.0,9.0,9.0,9.0, 9.0,9.0,9.0,9.0,7.0, 0.0,0.0,0.0,0.0,0.0]],
      dtype=np.float64)
    raw_orography_in = np.array([
      [9.0,9.0,9.0,9.0,9.0, 9.0,9.0,9.0,9.0,9.0, 9.0,9.0,9.0,9.0,9.0, 9.0,9.0,9.0,9.0,9.0],
      [9.0,9.0,9.0,9.0,9.0, 9.0,9.0,9.0,9.0,9.0, 9.0,9.0,9.0,3.0,4.0, 4.0,9.0,9.0,9.0,9.0],
      [9.0,7.0,8.0,6.0,7.0, 7.0,5.0,6.0,4.0,5.0, 5.0,4.0,4.5,9.0,9.0, 9.0,2.0,3.0,9.0,9.0],
      [9.0,9.0,9.0,9.0,9.0, 9.0,9.0,9.0,9.0,9.0, 9.0,9.0,9.0,3.0,4.0, 4.0,9.0,1.5,9.0,9.0],
      [9.0,9.0,9.0,9.0,9.0, 9.0,9.0,9.0,9.0,9.0, 9.0,9.0,9.0,9.0,9.0, 9.0,9.0,2.0,9.0,9.0],
      #
      [9.0,9.0,9.0,9.0,9.0, 9.0,9.0,9.0,9.0,9.0, 9.0,9.0,9.0,9.0,9.0, 9.0,9.0,2.0,9.0,9.0],
      [9.0,9.0,9.0,9.0,9.0, 9.0,9.0,9.0,9.0,9.0, 9.0,9.0,9.0,9.0,9.0, 9.0,9.0,1.0,9.0,9.0],
      [7.0,6.0,7.0,8.0,7.0, 6.0,7.0,7.0,7.5,5.0, 4.0,5.0,6.0,9.0,9.0, 9.0,9.0,1.5,9.0,9.0],
      [9.0,9.0,9.0,9.0,9.0, 9.0,9.0,9.0,9.0,9.0, 9.0,9.0,6.0,9.0,9.0, 9.0,9.0,1.5,9.0,9.0],
      [9.0,9.0,9.0,9.0,9.0, 9.0,9.0,9.0,9.0,9.0, 9.0,9.0,6.0,9.0,9.0, 9.0,9.0,1.5,9.0,9.0],
      #
      [9.0,9.0,4.0,9.0,9.0, 9.0,9.0,4.0,9.0,9.0, 9.0,9.0,4.0,9.0,9.0, 9.0,9.0,1.5,9.0,9.0],
      [9.0,9.0,4.0,9.0,9.0, 9.0,9.0,4.0,9.0,9.0, 9.0,9.0,4.0,9.0,9.0, 9.0,9.0,1.5,9.0,9.0],
      [9.0,9.0,4.0,9.0,9.0, 9.0,9.0,4.0,9.0,9.0, 9.0,9.0,4.0,9.0,9.0, 9.0,9.0,1.5,9.0,9.0],
      [9.0,9.0,4.0,9.0,9.0, 9.0,9.0,4.0,9.0,9.0, 9.0,9.0,4.0,9.0,9.0, 9.0,9.0,1.5,9.0,9.0],
      [9.0,9.0,4.0,9.0,9.0, 9.0,9.0,4.0,9.0,9.0, 9.0,9.0,4.0,9.0,7.0, 7.0,7.0,1.5,7.0,7.0],
      #
      [9.0,9.0,4.0,9.0,9.0, 9.0,9.0,4.0,9.0,9.0, 9.0,9.0,4.0,9.0,7.0, 0.0,0.0,0.0,0.0,0.0],
      [9.0,9.0,4.0,9.0,9.0, 9.0,9.0,4.0,9.0,9.0, 9.0,9.0,4.0,9.0,7.0, 0.0,0.0,0.0,0.0,0.0],
      [9.0,9.0,4.0,4.0,4.0, 9.0,9.0,4.0,4.0,4.0, 4.0,4.0,4.0,4.0,4.0, 0.0,0.0,0.0,0.0,0.0],
      [9.0,9.0,9.0,9.0,9.0, 9.0,9.0,9.0,9.0,9.0, 9.0,9.0,9.0,9.0,7.0, 0.0,0.0,0.0,0.0,0.0],
      [9.0,9.0,9.0,9.0,9.0, 9.0,9.0,9.0,9.0,9.0, 9.0,9.0,9.0,9.0,7.0, 0.0,0.0,0.0,0.0,0.0]],
      dtype=np.float64)
    minima_in = np.array([
      [False, False, False, False, False, False, False, False, False,
      False, False, False, False, False, False, False, False, False,
      False, False],
      [False, False, False, False, False, False, False, False, False,
      False, False, False, False,  True, False, False, False, False,
      False, False],
      [False,  True, False,  True, False, False,  True, False,  True,
      False, False,  True, False, False, False, False, False, False,
      False, False],
      [False, False, False, False, False, False, False, False, False,
      False, False, False, False, True, False, False, False,  True,
      False, False],
      [False, False, False, False, False, False, False, False, False,
      False, False, False, False, False, False, False, False, False,
      False, False],
      [False, False, False, False, False, False, False, False, False,
      False, False, False, False, False, False, False, False, False,
      False, False],
      [False, False, False, False, False, False, False, False, False,
      False, False, False, False, False, False, False, False,  True,
      False, False],
      [False,  True, False, False, False,  True, False, False, False,
      False,  True, False, False, False, False, False, False, False,
      False, False],
      [False, False, False, False, False, False, False, False, False,
      False, False, False, False, False, False, False, False, False,
      False, False],
      [False, False, False, False, False, False, False, False, False,
      False, False, False, False, False, False, False, False, False,
      False, False],
      [False, False, False, False, False, False, False, False, False,
      False, False, False, False, False, False, False, False, False,
      False, False],
      [False, False, False, False, False, False, False, False, False,
      False, False, False, False, False, False, False, False, False,
      False, False],
      [False, False, False, False, False, False, False, False, False,
      False, False, False, False, False, False, False, False, False,
      False, False],
      [False, False, False, False, False, False, False, False, False,
      False, False, False, False, False, False, False, False, False,
      False, False],
      [False, False, False, False, False, False, False, False, False,
      False, False, False, False, False, False, False, False, False,
      False, False],
      [False, False, False, False, False, False, False, False, False,
      False, False, False, False, False, False, False, False, False,
      False, False],
      [False, False, False, False, False, False, False, False, False,
      False, False, False, False, False, False, False, False, False,
      False, False],
      [False, False, False, False, False, False, False, False, False,
      False, False, False, False, False, False, False, False, False,
      False, False],
      [False, False, False, False, False, False, False, False, False,
      False, False, False, False, False, False, False, False, False,
      False, False],
      [False, False, False, False, False, False, False, False, False,
      False, False, False, False, False, False, False, False, False,
      False, False]],
      dtype=np.int32)
    prior_fine_rdirs_in = np.array([
       [2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2],
       [3, 2, 1, 2, 1, 3, 2, 3, 2, 1, 3, 2, 1, 5, 6, 6, 2, 2, 2, 2],
       [6, 5, 4, 5, 4, 6, 5, 6, 5, 4, 4, 5, 4, 2, 6, 6, 6, 2, 1, 2],
       [9, 8, 7, 8, 7, 9, 8, 7, 8, 7, 9, 8, 7, 5, 6, 6, 8, 5, 4, 4],
       [8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 9, 2, 7, 8],
       [2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 6, 6, 2, 4, 4],
       [3, 2, 1, 2, 3, 2, 2, 2, 2, 3, 2, 1, 2, 2, 2, 6, 6, 5, 4, 4],
       [6, 5, 4, 6, 6, 5, 4, 4, 6, 6, 5, 2, 2, 2, 2, 6, 6, 2, 4, 4],
       [9, 8, 7, 8, 9, 8, 7, 8, 8, 9, 8, 2, 2, 2, 2, 6, 6, 2, 4, 4],
       [8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 2, 2, 2, 2, 6, 6, 2, 4, 4],
       [2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2],
       [2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2],
       [2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2],
       [2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2],
       [2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 2, 2, 2, 2, 2],
       [2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 6, 0, 0, 0, 0, 0],
       [2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 6, 0, 0, 0, 0, 0],
       [6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 0, 0, 0, 0, 0],
       [8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 6, 0, 0, 0, 0, 0],
       [8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 6, 0, 0, 0, 0, 0]],
      dtype=np.float64)
    prior_coarse_rdirs_in = np.array([[5,5,5,5],
                                      [5,5,5,5],
                                      [2,2,2,2],
                                      [6,6,6,0]],
                                      dtype=np.float64)
    prior_fine_catchments_in = np.array([
      [ 1, 1, 1, 2,  2,  3,  3, 4, 4,  4,  5,  5, 5, 6, 7, 7, 7, 7, 7, 7],
      [ 1, 1, 1, 2,  2,  3,  3, 4, 4,  4,  5,  5, 5, 6, 7, 7, 7, 7, 7, 7],
      [ 1, 1, 1, 2,  2,  3,  3, 4, 4,  4,  4,  5, 5,13, 7, 7, 7, 7, 7, 7],
      [ 1, 1, 1, 2,  2,  3,  3, 3, 4,  4,  5,  5, 5,13, 7, 7, 7, 7, 7, 7],
      [ 1, 1, 1, 2,  2,  3,  3, 3, 4,  4,  5,  5, 5,13, 7, 7, 7, 8, 7, 7],
      [ 9, 9, 9,10, 10, 10, 10,10,11, 11, 11, 11,12,12,12, 8, 8, 8, 8, 8],
      [ 9, 9, 9,10, 10, 10, 10,10,11, 11, 11, 11,12,12,12, 8, 8, 8, 8, 8],
      [ 9, 9, 9,10, 10, 10, 10,10,11, 11, 11, 12,12,12,12,12,12,12,12,12],
      [ 9, 9, 9,10, 10, 10, 10,10,11, 11, 11, 12,12,12,12,12,12,12,12,12],
      [ 9, 9, 9,10, 10, 10, 10,10,11, 11, 11, 12,12,12,12,12,12,12,12,12],
      [12,12,12,12, 12, 12, 12,12,12, 12, 12, 12,12,12,12,12,12,12,12,12],
      [12,12,12,12, 12, 12, 12,12,12, 12, 12, 12,12,12,12,12,12,12,12,12],
      [12,12,12,12, 12, 12, 12,12,12, 12, 12, 12,12,12,12,12,12,12,12,12],
      [12,12,12,12, 12, 12, 12,12,12, 12, 12, 12,12,12,12,12,12,12,12,12],
      [12,12,12,12, 12, 12, 12,12,12, 12, 12, 12,12,12,12,12,12,12,12,12],
      [12,12,12,12, 12, 12, 12,12,12, 12, 12, 12,12,12,12, 0, 0, 0, 0, 0],
      [12,12,12,12, 12, 12, 12,12,12, 12, 12, 12,12,12,12, 0, 0, 0, 0, 0],
      [12,12,12,12, 12, 12, 12,12,12, 12, 12, 12,12,12,12, 0, 0, 0, 0, 0],
      [12,12,12,12, 12, 12, 12,12,12, 12, 12, 12,12,12,12, 0, 0, 0, 0, 0],
      [12,12,12,12, 12, 12, 12,12,12, 12, 12, 12,12,12,12, 0, 0, 0, 0, 0]],
       dtype=np.int32)
    cell_areas_in = np.array([[1,1,1,1,1, 1,1,1,1,1, 1,1,1,1,1, 1,1,1,1,1],
                              [1,1,1,1,1, 1,1,1,1,1, 1,1,1,1,1, 1,1,1,1,1],
                              [1,1,1,1,1, 1,1,1,1,1, 1,1,1,1,1, 1,1,1,1,1],
                              [1,1,1,1,1, 1,1,1,1,1, 1,1,1,1,1, 1,1,1,1,1],
                              [1,1,1,1,1, 1,1,1,1,1, 1,1,1,1,1, 1,1,1,1,1],
                              [1,1,1,1,1, 1,1,1,1,1, 1,1,1,1,1, 1,1,1,1,1],
                              [1,1,1,1,1, 1,1,1,1,1, 1,1,1,1,1, 1,1,1,1,1],
                              [1,1,1,1,1, 1,1,1,1,1, 1,1,1,1,1, 1,1,1,1,1],
                              [1,1,1,1,1, 1,1,1,1,1, 1,1,1,1,1, 1,1,1,1,1],
                              [1,1,1,1,1, 1,1,1,1,1, 1,1,1,1,1, 1,1,1,1,1],
                              [1,1,1,1,1, 1,1,1,1,1, 1,1,1,1,1, 1,1,1,1,1],
                              [1,1,1,1,1, 1,1,1,1,1, 1,1,1,1,1, 1,1,1,1,1],
                              [1,1,1,1,1, 1,1,1,1,1, 1,1,1,1,1, 1,1,1,1,1],
                              [1,1,1,1,1, 1,1,1,1,1, 1,1,1,1,1, 1,1,1,1,1],
                              [1,1,1,1,1, 1,1,1,1,1, 1,1,1,1,1, 1,1,1,1,1],
                              [1,1,1,1,1, 1,1,1,1,1, 1,1,1,1,1, 1,1,1,1,1],
                              [1,1,1,1,1, 1,1,1,1,1, 1,1,1,1,1, 1,1,1,1,1],
                              [1,1,1,1,1, 1,1,1,1,1, 1,1,1,1,1, 1,1,1,1,1],
                              [1,1,1,1,1, 1,1,1,1,1, 1,1,1,1,1, 1,1,1,1,1],
                              [1,1,1,1,1, 1,1,1,1,1, 1,1,1,1,1, 1,1,1,1,1]],
                              dtype=np.float64)
    landsea_in = np.array([
      [False,False,False,False,False, False,False,False,False,False, False,False,False,False,False, False,False,False,False,False],
      [False,False,False,False,False, False,False,False,False,False, False,False,False,False,False, False,False,False,False,False],
      [False,False,False,False,False, False,False,False,False,False, False,False,False,False,False, False,False,False,False,False],
      [False,False,False,False,False, False,False,False,False,False, False,False,False,False,False, False,False,False,False,False],
      [False,False,False,False,False, False,False,False,False,False, False,False,False,False,False, False,False,False,False,False],
      [False,False,False,False,False, False,False,False,False,False, False,False,False,False,False, False,False,False,False,False],
      [False,False,False,False,False, False,False,False,False,False, False,False,False,False,False, False,False,False,False,False],
      [False,False,False,False,False, False,False,False,False,False, False,False,False,False,False, False,False,False,False,False],
      [False,False,False,False,False, False,False,False,False,False, False,False,False,False,False, False,False,False,False,False],
      [False,False,False,False,False, False,False,False,False,False, False,False,False,False,False, False,False,False,False,False],
      [False,False,False,False,False, False,False,False,False,False, False,False,False,False,False, False,False,False,False,False],
      [False,False,False,False,False, False,False,False,False,False, False,False,False,False,False, False,False,False,False,False],
      [False,False,False,False,False, False,False,False,False,False, False,False,False,False,False, False,False,False,False,False],
      [False,False,False,False,False, False,False,False,False,False, False,False,False,False,False, False,False,False,False,False],
      [False,False,False,False,False, False,False,False,False,False, False,False,False,False,False, False,False,False,False,False],
      [False,False,False,False,False, False,False,False,False,False, False,False,False,False,False, False,False,False,False,False],
      [False,False,False,False,False, False,False,False,False,False, False,False,False,False,False, False,False,False,False,False],
      [False,False,False,False,False, False,False,False,False,False, False,False,False,False,False, False,False,False,False,False],
      [False,False,False,False,False, False,False,False,False,False, False,False,False,False,False, False,False,False,False,False],
      [False,False,False,False,False, False,False,False,False,False, False,False,False,False,False, False,False,False,False,True]],
      dtype=np.int32)
    output,alg = \
      LatLonEvaluateBasin.evaluate_basins(landsea_in,
                                          minima_in,
                                          raw_orography_in,
                                          corrected_orography_in,
                                          cell_areas_in,
                                          prior_fine_rdirs_in,
                                          prior_fine_catchments_in,
                                          coarse_catchment_nums_in,
                                          return_algorithm_object=True)
    expected_lake_mask = np.array([
       [False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False,
        False, False],
       [False, False, False, False, False, False, False, False, False,
        False, False, False, False,  True, False, False, False, False,
        False, False],
       [False,  True, False,  True, False, False,  True, False,  True,
        False, False,  True, False, False, False, False, False, False,
        False, False],
       [False, False, False, False, False, False, False, False, False,
        False, False, False, False,  True, False, False, False,  True,
        False, False],
       [False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False,
        False, False],
       [False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False,
        False, False],
       [False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False,  True,
        False, False],
       [ True,  True,  True, False,  True,  True,  True,  True, False,
         True,  True,  True, False, False, False, False, False, False,
        False, False],
       [False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False,
        False, False],
       [False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False,
        False, False],
       [False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False,
        False, False],
       [False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False,
        False, False],
       [False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False,
        False, False],
       [False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False,
        False, False],
       [False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False,
        False, False],
       [False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False,
        False, False],
       [False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False,
        False, False],
       [False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False,
        False, False],
       [False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False,
        False, False],
       [False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False,
        False, False]])
    expected_lakes_as_array = \
     [12.0, 26.0, 1.0, -1.0, 0.0, 8.0, 11.0, 3.0, 8.0, 11.0, 1.0, 1.0, 5.0, 8.0, 12.0,
      1.0, 1.0, 5.0, 8.0, 10.0, 1.0, 4.0, 6.0, 1.0, -1.0, 3.0, 3.0, 0.0, 31.0, 2.0,
      -1.0, 0.0, 8.0, 6.0, 4.0, 8.0, 6.0, 1.0, 1.0, 7.0, 8.0, 7.0, 1.0, 1.0, 7.0,
      8.0, 5.0, 1.0, 1.0, 7.0, 8.0, 8.0, 1.0, 3.0, 7.5, 1.0, 1.0, -1.0, -1.0, 1.0,
      26.0, 3.0, -1.0, 0.0, 8.0, 2.0, 3.0, 8.0, 2.0, 1.0, 1.0, 7.0, 8.0, 3.0, 1.0,
      1.0, 7.0, 8.0, 1.0, 1.0, 4.0, 8.0, 1.0, 2.0, -1.0, -1.0, 1.0, 16.0, 4.0, -1.0,
      0.0, 7.0, 18.0, 1.0, 7.0, 18.0, 1.0, 0.5, 1.5, 1.0, -1.0, 4.0, 4.0, 0.0, 16.0,
      5.0, -1.0, 0.0, 4.0, 18.0, 1.0, 4.0, 18.0, 1.0, 0.5, 2.0, 1.0, 4.0, -1.0, -1.0,
      1.0, 16.0, 6.0, -1.0, 0.0, 4.0, 14.0, 1.0, 4.0, 14.0, 1.0, 1.0, 4.0, 1.0, -1.0,
      1.0, 4.0, 0.0, 16.0, 7.0, -1.0, 0.0, 3.0, 12.0, 1.0, 3.0, 12.0, 1.0, 0.5, 4.5,
      1.0, 6.0, -1.0, -1.0, 1.0, 16.0, 8.0, -1.0, 0.0, 3.0, 9.0, 1.0, 3.0, 9.0, 1.0,
      1.0, 5.0, 1.0, 7.0, -1.0, -1.0, 1.0, 16.0, 9.0, -1.0, 0.0, 3.0, 7.0, 1.0, 3.0,
      7.0, 1.0, 1.0, 6.0, 1.0, 8.0, -1.0, -1.0, 1.0, 16.0, 10.0, -1.0, 0.0, 3.0, 4.0,
      1.0, 3.0, 4.0, 1.0, 1.0, 7.0, 1.0, 9.0, -1.0, -1.0, 1.0, 16.0, 11.0, -1.0, 0.0,
      3.0, 2.0, 1.0, 3.0, 2.0, 1.0, 1.0, 8.0, 1.0, 10.0, -1.0, -1.0, 1.0, 16.0, 12.0,
      -1.0, 0.0, 2.0, 14.0, 1.0, 2.0, 14.0, 1.0, 1.0, 4.0, 1.0, -1.0, 1.0, 4.0, 0.0]
    self.assertEqual(output["number_of_lakes"],12)
    self.assertEqual(output["lakes_as_array"],expected_lakes_as_array)
    np.testing.assert_array_equal(output["lake_mask"],expected_lake_mask)

  def testEvaluateBasinsEight(self):
    coarse_catchment_nums_in = np.array([[3, 5, 1],
                                         [4, 2, 1],
                                         [4, 1, 1]])
    prior_coarse_rdirs_in = np.array([[-2,-2, 2],
                                      [ 2,-2, 2],
                                      [-2, 6, 0]])
    corrected_orography_in = np.array([
      [ 0., 1.,  0.,  10., 10., 10., 10.0, 10.0, 10.0],
      [ 2., 10., 10., 10., 10., 10., 10.0, 10.0, 10.0],
      [ 2., 10., 10., 10., 10., 10., 10.0, 10.0, 10.0],
      [10., 2.0, 10., 10., 10., 10., 10.0, 10.0, 10.0],
      [10., 1.0, 1.0, 1.0,  0., 10., 10.0, 10.0, 10.0],
      [10., 1.0, 10., 10., 10.,  8., 10.0, 10.0, 10.0],
      [10., 1.0, 10., 10., 10.,  8., 10.0, 10.0, 10.0],
      [10., 1.0, 10., 10., 10.,  8., 10.0, 10.0, 10.0],
      [10.,  0., 10., 10., 10.,  8.,  8.0,  8.0,  0.0]])

    raw_orography_in = np.array([
      [ 0., 1.,  0.,  10., 10., 10., 10.0, 10.0, 10.0],
      [ 2., 10., 10., 10., 10., 10., 10.0, 10.0, 10.0],
      [ 2., 10., 10., 10., 10., 10., 10.0, 10.0, 10.0],
      [10., 2.0, 10., 10., 10., 10., 10.0, 10.0, 10.0],
      [10., 1.0, 1.0, 1.0,  0., 10., 10.0, 10.0, 10.0],
      [10., 1.0, 10., 10., 10.,  8., 10.0, 10.0, 10.0],
      [10., 1.0, 10., 10., 10.,  8., 10.0, 10.0, 10.0],
      [10., 1.0, 10., 10., 10.,  8., 10.0, 10.0, 10.0],
      [10.,  0., 10., 10., 10.,  8.,  8.0,  8.0,  0.0]])

    minima_in = np.array([
      [ True, False, True,  False, False, False, False, False, False],
      [False, False, False, False, False, False, False, False, False],
      [False, False, False, False, False, False, False, False, False],
      [False, False, False, False, False, False, False, False, False],
      [False, False, False, False,  True, False, False, False, False],
      [False, False, False, False, False, False, False, False, False],
      [False, False, False, False, False, False, False, False, False],
      [False, False, False, False, False, False, False, False, False],
      [False,  True, False, False, False, False, False, False, False]])
    prior_fine_rdirs_in = np.array([
      [ 5, 4, 5, 6, 6, 6, 6, 6, 2],
      [ 8, 4, 8, 6, 6, 6, 6, 6, 2],
      [ 8, 4, 6, 6, 6, 6, 6, 6, 2],
      [ 6, 2, 4, 3, 2, 1, 6, 6, 2],
      [ 6, 2, 4, 6, 5, 4, 6, 6, 2],
      [ 6, 2, 4, 6, 6, 2, 6, 6, 2],
      [ 6, 2, 4, 6, 6, 2, 6, 6, 2],
      [ 6, 2, 4, 6, 6, 2, 6, 6, 2],
      [ 6, 5, 4, 6, 6, 6, 6, 6, 0]])
    prior_fine_catchments_in = np.array([
      [ 3, 3, 5, 1, 1, 1, 1, 1, 1],
      [ 3, 3, 5, 1, 1, 1, 1, 1, 1],
      [ 3, 3, 1, 1, 1, 1, 1, 1, 1],
      [ 4, 4, 4, 2, 2, 2, 1, 1, 1],
      [ 4, 4, 4, 2, 2, 2, 1, 1, 1],
      [ 4, 4, 4, 1, 1, 1, 1, 1, 1],
      [ 4, 4, 4, 1, 1, 1, 1, 1, 1],
      [ 4, 4, 4, 1, 1, 1, 1, 1, 1],
      [ 4, 4, 4, 1, 1, 1, 1, 1, 0]])
    cell_areas_in = np.full((9,9),1.0)
    landsea_in = np.full((9,9),0,dtype=np.int32)
    landsea_in[8,8] = 1
    output,alg = \
      LatLonEvaluateBasin.evaluate_basins(landsea_in,
                                          minima_in,
                                          raw_orography_in,
                                          corrected_orography_in,
                                          cell_areas_in,
                                          prior_fine_rdirs_in,
                                          prior_fine_catchments_in,
                                          coarse_catchment_nums_in,
                                          return_algorithm_object=True)
    expected_lake_mask = np.array([
       [ True,  True,  True, False, False, False, False, False, False],
       [ True, False, False, False, False, False, False, False, False],
       [ True, False, False, False, False, False, False, False, False],
       [False,  True, False, False, False, False, False, False, False],
       [False,  True,  True,  True,  True, False, False, False, False],
       [False,  True, False, False, False, False, False, False, False],
       [False,  True, False, False, False, False, False, False, False],
       [False,  True, False, False, False, False, False, False, False],
       [False,  True, False, False, False, False, False, False, False]])
    expected_lakes_as_array = \
     [7.0, 16.0, 1.0, 5.0, 0.0, 9.0, 2.0, 1.0, 9.0, 2.0, 1.0, 1.0, 1.0, 1.0, 2.0,
      -1.0, -1.0, 1.0, 16.0, 2.0, 5.0, 0.0, 5.0, 5.0, 1.0, 5.0, 5.0, 1.0, 1.0, 1.0,
      1.0, 1.0, -1.0, -1.0, 1.0, 16.0, 3.0, 6.0, 0.0, 1.0, 3.0, 1.0, 1.0, 3.0, 1.0,
      1.0, 1.0, 1.0, 4.0, -1.0, -1.0, 1.0, 16.0, 4.0, 6.0, 0.0, 1.0, 1.0, 1.0, 1.0,
      1.0, 1.0, 1.0, 1.0, 1.0, 3.0, -1.0, -1.0, 1.0, 53.0, 5.0, 7.0, 2.0, 1.0, 2.0,
      9.0, 2.0, 8.0, 9.0, 2.0, 1.0, 0.0, 1.0, 8.0, 2.0, 1.0, 0.0, 1.0, 7.0, 2.0,
      1.0, 0.0, 1.0, 6.0, 2.0, 1.0, 0.0, 1.0, 5.0, 3.0, 1.0, 0.0, 1.0, 5.0, 2.0,
      1.0, 0.0, 1.0, 5.0, 4.0, 1.0, 0.0, 1.0, 5.0, 5.0, 1.0, 8.0, 2.0, 1.0, 6.0,
      -1.0, -1.0, 1.0, 28.0, 6.0, 7.0, 2.0, 3.0, 4.0, 1.0, 3.0, 3.0, 1.0, 3.0, 1.0,
      0.0, 1.0, 1.0, 2.0, 1.0, 0.0, 1.0, 1.0, 1.0, 1.0, 3.0, 2.0, 1.0, 5.0, 2.0,
      1.0, 0.0, 83.0, 7.0, -1.0, 2.0, 5.0, 6.0, 9.0, 2.0, 14.0, 9.0, 2.0, 1.0, 0.0,
      2.0, 8.0, 2.0, 1.0, 0.0, 2.0, 7.0, 2.0, 1.0, 0.0, 2.0, 6.0, 2.0, 1.0, 0.0,
      2.0, 5.0, 3.0, 1.0, 0.0, 2.0, 5.0, 2.0, 1.0, 0.0, 2.0, 4.0, 2.0, 1.0, 0.0,
      2.0, 5.0, 4.0, 1.0, 0.0, 2.0, 3.0, 1.0, 1.0, 0.0, 2.0, 5.0, 5.0, 1.0, 0.0,
      2.0, 2.0, 1.0, 1.0, 0.0, 2.0, 1.0, 2.0, 1.0, 0.0, 2.0, 1.0, 1.0, 1.0, 0.0,
      2.0, 1.0, 3.0, 1.0, 84.0, 8.0, 1.0, -1.0, 3.0, 3.0, 0.0]
    self.assertEqual(output["number_of_lakes"],7)
    self.assertEqual(output["lakes_as_array"],expected_lakes_as_array)
    np.testing.assert_array_equal(output["lake_mask"],expected_lake_mask)

if __name__ == "__main__":
    unittest.main()
