module HDParameterGeneratorTests

using Test: @test, @testset
using HDParameterGenerator: generate_parameters, Grid, InputData
using HDParameterGenerator: Configuration, LatLonGrid
using HDParameterGenerator: RiverFlowFormula, OverlandFlowFormula
using HDParameterGenerator: BaseFlowFormula
using HDParameterGenerator: RiverFlowSausen, OverlandFlowSausen
using HDParameterGenerator: BaseFlowDistanceAndOrography

@testset "Parameter generation tests" begin
rdirs::Array{Int64} = Int64[ 6 3 3 2 9 6 6 6 3 4 6 6 6 6 9 6 9 9 9 8 8
                             2 2 6 1 4 4 9 9 8 6 8 6 9 8 3 3 2 6 6 6 8
                             4 4 4 8 7 7 3 9 7 4 9 9 8 3 3 6 6 6 8 8 8
                             7 6 6 6 6 3 2 1 1 7 4 3 2 6 6 6 8 9 8 7 9
                             3 3 2 1 1 6 1 4 4 3 2 3 3 3 9 8 7 7 7 6 6
                             6 6 2 4 2 1 4 7 2 2 3 2 6 6 8 7 7 7 9 8 6
                             8 9 6 6 2 3 2 3 3 2 6 6 8 8 7 9 2 2 9 8 9
                             7 9 9 8 6 6 6 6 6 9 8 8 7 7 6 6 3 2 4 1 1
                             9 9 8 7 2 7 2 1 4 6 9 4 7 6 9 9 6 6 6 3 3
                             9 9 8 7 7 4 4 4 2 8 8 6 9 8 8 8 9 8 8 6 6
                             9 9 6 7 8 4 3 6 3 2 6 9 8 7 9 8 9 8 2 3 2
                             7 4 6 3 7 9 9 6 8 6 9 8 7 8 4 4 1 6 3 3 3
                             8 7 4 6 6 6 9 8 8 2 8 4 6 8 8 7 3 3 3 2 6
                             8 8 7 9 9 9 9 9 8 7 4 6 9 8 6 8 3 6 6 3 6
                             2 7 3 9 9 8 7 9 9 3 3 9 8 7 6 8 6 8 8 6 3
                             2 3 6 2 1 9 9 6 6 6 6 8 7 7 9 3 2 3 9 3 6
                             6 6 6 6 3 2 3 3 8 7 4 8 7 6 3 2 3 3 6 6 6
                             6 6 6 9 6 6 6 6 9 8 4 9 8 3 3 2 1 3 2 1 6
                             9 8 9 8 6 9 8 4 8 8 8 2 1 3 6 2 4 6 3 2 6
                             8 4 4 6 6 9 8 8 3 2 2 2 4 3 6 6 3 3 6 3 3
                             8 7 2 1 6 6 6 8 6 6 6 3 2 3 2 2 6 3 6 6 6 ]

orography::Array{Float64} = Float64[
  2.136e+02  2.431e+02  2.925e+02  3.194e+02  3.052e+02  2.836e+02  2.241e+02  1.558e+02  1.558e+02  1.558e+02  1.672e+02  3.647e+02  3.938e+02  1.558e+02  2.483e+02  4.384e+02  5.540e+02  5.207e+02  5.553e+02  3.797e+02  1.230e+02
  2.439e+02  2.495e+02  2.866e+02  2.482e+02  1.871e+02  1.558e+02  1.558e+02  1.558e+02  1.558e+02  2.427e+02  4.780e+02  5.675e+02  5.793e+02  1.558e+02  4.911e+02  4.651e+02  3.712e+02  6.823e+02  2.360e+02  1.368e+02  7.648e+01
  2.898e+02  1.558e+02  1.558e+02  1.558e+02  1.558e+02  1.558e+02  1.558e+02  1.558e+02  3.581e+02  3.904e+02  6.312e+02  7.032e+02  4.448e+02  2.307e+02  4.397e+02  3.627e+02  4.281e+02  3.277e+02  1.671e+02  5.170e+01 -1.975e+01
  1.579e+02  1.558e+02  1.558e+02  1.558e+02  1.558e+02  1.558e+02  1.558e+02  1.558e+02  1.814e+02  2.591e+02  4.384e+02  4.424e+02  3.010e+02  2.295e+02  4.568e+02  3.456e+02  2.712e+02  1.892e+02  7.247e+01 -7.106e+01 -1.364e+02
  1.563e+02  1.596e+02  2.635e+02  4.054e+02  3.509e+02  3.377e+02  2.313e+02  3.698e+02  4.827e+02  4.324e+02  4.762e+02  3.063e+02  1.562e+02  3.795e+02  4.707e+02  2.672e+02  2.513e+02  7.222e+01  4.555e+00 -9.278e+01 -2.020e+02
  2.672e+02  4.121e+02  5.281e+02  5.458e+02  5.785e+02  4.500e+02  4.137e+02  3.593e+02  3.777e+02  4.918e+02  5.586e+02  5.684e+02  1.562e+02  3.976e+02  2.882e+02  1.936e+02  1.871e+02  6.981e+01  8.612e-01 -5.095e+01 -1.888e+02
  4.609e+02  4.928e+02  5.903e+02  6.003e+02  6.272e+02  5.162e+02  5.343e+02  3.481e+02  3.983e+02  4.601e+02  4.500e+02  3.289e+02  1.562e+02  2.609e+02  1.214e+02  1.446e+02  1.348e+02  4.208e+01  1.731e+01 -7.555e+00 -4.789e+01
  4.094e+02  4.652e+02  5.213e+02  5.380e+02  4.828e+02  4.403e+02  3.117e+02  4.130e+02  2.866e+02  4.707e+02  2.676e+02  1.980e+02  1.497e+02  1.156e+02  3.361e+01  2.053e+01  7.767e-01 -2.792e+01 -2.203e+01 -1.956e+01 -1.364e+01
  3.607e+02  3.900e+02  4.948e+02  5.074e+02  4.216e+02  3.190e+02  2.358e+02  3.422e+02  3.311e+02  1.787e+02  1.639e+02  6.347e+01  1.261e+01  4.641e+00 -4.833e+00 -3.011e+01 -5.239e+01 -5.978e+01 -5.997e+01 -4.825e+01 -4.344e+01
  3.391e+02  4.803e+02  5.799e+02  4.316e+02  3.483e+02  2.579e+02  1.796e+02  1.515e+02  1.977e+02  1.119e+02  3.959e+01  3.111e+01 -1.944e+01 -3.742e+01 -4.717e+01 -6.042e+01 -7.578e+01 -9.825e+01 -1.186e+02 -1.097e+02 -9.183e+01
  4.167e+02  6.947e+02  5.108e+02  3.165e+02  2.008e+02  2.515e+02  2.110e+02  1.487e+02  9.419e+01  3.125e+01  2.828e+01  1.503e+01 -2.494e+01 -4.342e+01 -6.294e+01 -9.378e+01 -4.730e+02 -1.271e+03 -1.560e+03 -1.620e+03 -1.499e+03
  5.766e+02  8.083e+02  3.752e+02  3.241e+02  1.639e+02  1.379e+02  1.146e+02  1.486e+01  1.664e+01  3.416e+00  1.008e+01 -1.592e+01 -3.350e+01 -5.347e+01 -1.453e+02 -7.601e+02 -1.854e+03 -2.589e+03 -2.661e+03 -2.670e+03 -2.636e+03
  9.361e+02  8.261e+02  4.767e+02  4.007e+02  1.678e+02  8.336e+01  3.711e+01 -1.278e+00  1.092e+01  6.361e+00 -1.675e+01 -3.661e+01 -4.833e+01 -1.367e+02 -1.413e+03 -2.441e+03 -2.660e+03 -2.816e+03 -2.939e+03 -2.953e+03 -3.139e+03
  8.636e+02  6.862e+02  4.406e+02  2.795e+02  1.114e+02  4.972e+01  1.955e+01 -3.335e-01  2.278e+00  7.028e+00 -2.461e+01 -5.008e+01 -2.639e+02 -1.595e+03 -2.608e+03 -2.918e+03 -2.928e+03 -2.992e+03 -3.245e+03 -3.418e+03 -3.638e+03
  5.368e+02  5.010e+02  2.625e+02  1.258e+02  8.892e+01  5.028e+01  2.358e+01  2.167e+00  8.313e-02 -1.211e+01 -3.697e+01 -2.244e+02 -1.521e+03 -2.316e+03 -2.771e+03 -3.098e+03 -3.152e+03 -3.484e+03 -3.799e+03 -3.983e+03 -4.064e+03
  4.115e+02  2.433e+02  1.940e+02  1.419e+02  8.636e+01  4.194e+01  1.892e+01  1.251e+00 -4.972e+00 -2.628e+01 -9.500e+01 -1.194e+03 -2.187e+03 -2.749e+03 -3.007e+03 -3.236e+03 -3.525e+03 -3.980e+03 -4.147e+03 -4.231e+03 -4.291e+03
  2.882e+02  1.887e+02  1.409e+02  1.164e+02  8.781e+01  3.355e+01  2.419e+01  8.083e+00 -9.167e+00 -2.619e+01 -1.453e+02 -1.906e+03 -2.647e+03 -3.071e+03 -3.289e+03 -3.491e+03 -3.929e+03 -4.163e+03 -4.302e+03 -4.367e+03 -4.404e+03
  2.358e+02  1.931e+02  1.532e+02  1.190e+02  6.492e+01  2.906e+01  1.575e+01  5.250e+00 -5.361e+00 -2.919e+01 -4.502e+02 -2.101e+03 -2.890e+03 -3.360e+03 -3.638e+03 -3.819e+03 -4.080e+03 -4.256e+03 -4.368e+03 -4.449e+03 -4.499e+03
  2.053e+02  1.662e+02  1.064e+02  7.383e+01  3.661e+01  1.769e+01  1.178e+01  5.972e+00  5.834e-01 -2.194e+01 -6.063e+02 -2.338e+03 -3.092e+03 -3.679e+03 -3.939e+03 -4.079e+03 -4.209e+03 -4.331e+03 -4.426e+03 -4.475e+03 -4.568e+03
  1.356e+02  1.136e+02  6.217e+01  4.925e+01  3.117e+01  1.275e+01  6.833e+00 -1.139e+00 -7.972e+00 -4.667e+01 -1.653e+03 -2.885e+03 -3.401e+03 -3.876e+03 -4.210e+03 -4.317e+03 -4.333e+03 -4.337e+03 -4.475e+03 -4.680e+03 -4.928e+03
  7.383e+01  6.328e+01  3.808e+01  2.967e+01  1.767e+01  9.278e+00 -1.083e+00 -1.431e+01 -5.892e+01 -1.487e+03 -3.022e+03 -3.361e+03 -3.693e+03 -4.179e+03 -4.412e+03 -4.480e+03 -4.427e+03 -4.533e+03 -4.811e+03 -5.014e+03 -5.229e+03 ]

glacier_mask::Array{Int64} = Int64[ 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
                                    0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
                                    0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
                                    0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
                                    0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
                                    0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
                                    0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
                                    0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
                                    0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
                                    0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
                                    0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
                                    0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
                                    0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
                                    0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
                                    0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
                                    0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
                                    0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
                                    0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
                                    0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
                                    0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
                                    0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 ]

lsmask::Array{Int64} = Int64[ 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
                              1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
                              1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
                              1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
                              1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0
                              1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0
                              1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0
                              1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0
                              1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0
                              1 1 1 1 1 1 1 1 1 1 0 1 1 1 0 0 0 0 0 0 0
                              1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0
                              1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0
                              1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0
                              1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0
                              1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0
                              1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0
                              1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0
                              1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0
                              1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0
                              1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0
                              1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 ]

innerslope::Array{Float64} = Float64[
 0.003 0.002 0.002 0.003 0.002 0.002 0.002 0.001 0.001 0.002 0.007 0.008 0.01  0.004 0.013 0.009 0.013 0.011 0.013 0.008 0.003
 0.002 0.002 0.004 0.002 0.003 0.002 0.002 0.001 0.002 0.006 0.003 0.01  0.018 0.008 0.011 0.009 0.015 0.021 0.006 0.003 0.002
 0.004 0.004 0.003 0.002 0.002 0.002 0.002 0.004 0.008 0.005 0.005 0.007 0.009 0.01  0.009 0.01  0.011 0.01  0.003 0.002 0.
 0.004 0.003 0.003 0.003 0.003 0.004 0.002 0.002 0.006 0.007 0.009 0.01  0.006 0.013 0.009 0.008 0.005 0.004 0.002 0.    0.
 0.001 0.001 0.005 0.006 0.007 0.006 0.007 0.005 0.006 0.004 0.008 0.007 0.006 0.012 0.009 0.006 0.005 0.002 0.    0.    0.
 0.006 0.006 0.005 0.005 0.005 0.005 0.006 0.005 0.006 0.006 0.009 0.015 0.007 0.007 0.007 0.004 0.003 0.002 0.    0.    0.
 0.003 0.004 0.003 0.005 0.005 0.005 0.007 0.006 0.005 0.005 0.008 0.01  0.006 0.005 0.004 0.004 0.003 0.001 0.002 0.    0.
 0.003 0.003 0.006 0.007 0.008 0.008 0.006 0.008 0.008 0.007 0.008 0.007 0.004 0.003 0.002 0.002 0.001 0.    0.    0.    0.
 0.003 0.003 0.005 0.008 0.008 0.007 0.005 0.007 0.005 0.005 0.005 0.003 0.002 0.002 0.    0.    0.    0.    0.    0.    0.
 0.004 0.01  0.01  0.007 0.009 0.005 0.003 0.003 0.004 0.002 0.001 0.001 0.    0.    0.    0.    0.    0.    0.    0.    0.
 0.009 0.007 0.008 0.007 0.006 0.004 0.003 0.003 0.002 0.001 0.001 0.001 0.    0.    0.    0.    0.    0.    0.    0.    0.
 0.008 0.012 0.007 0.005 0.004 0.003 0.003 0.001 0.001 0.001 0.001 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
 0.012 0.014 0.012 0.012 0.003 0.003 0.002 0.001 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
 0.012 0.009 0.015 0.004 0.001 0.002 0.002 0.    0.    0.001 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
 0.012 0.013 0.005 0.002 0.001 0.    0.002 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
 0.006 0.003 0.002 0.001 0.001 0.001 0.002 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
 0.003 0.002 0.001 0.002 0.001 0.001 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
 0.001 0.002 0.002 0.001 0.001 0.001 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
 0.002 0.002 0.001 0.001 0.001 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
 0.002 0.001 0.001 0.001 0.001 0.    0.001 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
 0.001 0.001 0.001 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.   ]

variance::Array{Float64} = Float64[
  36.79  29.31  32.25  49.67  50.12  52.2   35.03  15.36  11.51  36.09 148.91 148.13 168.28  76.89 132.42  89.15 100.65 111.83 142.2  123.38  34.81
  19.82  31.42  40.27  19.45  36.93  34.51  35.93  17.21  47.79 113.6   52.2  128.84 230.81 176.3  100.66 104.08 197.29 230.6   76.16  36.81  22.52
  71.24  88.    69.46  51.48  41.58  53.7   45.1   81.89 115.19 106.88  72.86  73.59 104.68 169.69 118.76  96.07 149.7  105.28  47.51  39.5    0.
  69.34  69.62  73.9   80.66  78.61  92.09  50.59  27.68  95.68  98.18 133.91 115.15  92.66 175.55 128.73  79.81  64.3   69.58  43.79   0.     0.
  16.27  22.22  98.    92.85 109.03 101.83  82.21  66.68  54.76  33.26 133.11 112.64 112.22 150.99 154.72  62.69  97.22  24.71   0.     0.     0.
 144.54  73.86  60.36  48.71  62.52  42.56  58.83  43.33  46.62  59.04  95.23 211.47 119.57  81.87 108.92  42.05  56.37  25.03   0.     0.     0.
  26.    34.41  30.07  53.76  56.95  49.43  86.32  65.38  74.04  63.39 126.73 150.44  68.61  75.52  51.48  56.76  46.36  17.94  17.8    0.     0.
  25.38  30.87  47.58  57.65  89.85  93.56 129.97 132.93 101.53 101.67  65.36  80.07  62.76  65.43  44.16  35.84  25.68   0.     0.     0.     0.
  27.79  43.6   57.7  102.35  78.39 103.7   59.77  89.89 100.85  47.85  85.59  45.13  25.99  16.92   0.     0.     0.     0.     0.     0.     0.
  58.98 119.68 118.92  66.32  68.48  62.58  45.43  32.56  49.67  37.9   20.3   21.21   0.     0.     0.     0.     0.     0.     0.     0.     0.
 129.66  75.43 135.83  83.39  97.98  57.47  36.76  41.59  50.21  15.33   8.03  13.47   0.     0.     0.     0.     0.     0.     0.     0.     0.
 140.72 233.61 103.2   67.05  45.69  37.09  57.03  16.53   9.41  12.31  10.59   0.     0.     0.     0.     0.     0.     0.     0.     0.     0.
 138.01 145.04 119.38 154.09  41.14  35.08  23.43   8.65   3.39   6.83   0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.
 154.02 162.89 160.69  75.59  20.55  21.3   17.38   0.     5.53   8.68   0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.
 122.4  185.27  77.1   18.6   15.92   6.18  14.07   0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.
  91.    40.88  29.64  18.26  17.72   8.53  13.18   0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.
  47.17  31.03  15.76  19.79  19.67   6.98   7.67   4.77   0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.
  22.96  21.47  24.41  16.91  21.85   6.17   5.39   5.29   0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.
  30.49  39.98  16.75  18.71   9.37   3.92   5.83   4.01   0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.
  30.62  17.03  13.95   7.48   7.76   4.76   6.46   0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.
  23.85  12.22   7.01   6.88   6.32   4.72   0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.  ]

expected_rdirs::Array{Int64} = Int64[ 7 4 3 2 2 2 3  3  6  8  9  8  8  8  7  8  2  1  3  6  2
                                      7 8 3 3 2 1 6  9  8  8  7  7  9  8  7  7  1  6  2  6  3
                                      3 6 6 6 3 4 9  8  4  7  7  7  3  2  7  2  6  6  3  3  3
                                      6 9 8 8 6 9 8  7  4  4  3  2  2  1  4  2  3  2  3  3  2
                                      6 8 4 7 9 9 8  8  8  8  6  6  2  4  6  1  6  3  6  6  0
                                      8 8 7 9 8 9 3  2  1  4  2  3  2  4  2  1  9  6  9  8  0
                                      8 1 7 7 2 3 6  3  2  1  2  2  1  3  3  4  2  2  2  8  0
                                      2 4 1 1 2 6 1  4  4  3  1  3  6  6  6  0  0  0  0  0 -1
                                      2 4 4 2 6 3 2  3  2  3  6  3  9  3  0  0 -1 -1  0  0 -1
                                      7 4 7 3 9 6 3  6  3  2  0  6  2  1  0 -1 -1 -1 -1 -1 -1
                                      8 7 2 3 2 2 8  2  1  0 -1  0  0  0  0 -1 -1 -1 -1 -1 -1
                                      8 6 6 6 3 2 6  2  4  0 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1
                                      7 9 9 9 3 3 4  2  0 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1
                                      3 9 3 3 9 8 6  3  0 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1
                                      3 3 6 6 3 2 8  6  0 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1
                                      3 2 2 9 6 6 6  0 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1
                                      2 6 6 6 6 3 3  8 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1
                                      9 8 2 3 3 3 6  0 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1
                                      2 6 2 6 3 2 6  0 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1
                                      2 3 2 9 6 3 2 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1
                                      3 6 3 3 3 3 0 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 ]

expected_flag::Array{Int64} = Int64[ 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
                                     1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
                                     1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
                                     1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
                                     1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0
                                     1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0
                                     1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0
                                     1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0
                                     1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0
                                     1 1 1 1 1 1 1 1 1 1 0 1 1 1 0 0 0 0 0 0 0
                                     1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0
                                     1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0
                                     1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0
                                     1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0
                                     1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0
                                     1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0
                                     1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0
                                     1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0
                                     1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0
                                     1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0
                                     1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 ]

expected_alf_k::Array{Float64} = Float64[
  19.926 20.972 20.517 19.964 20.108 20.083 20.77  21.711 22.395 20.763 18.139 17.765 17.405 19.143 16.898 17.66  16.895 17.249 16.878 17.752 19.73
  20.55  20.517 19.362 20.399 20.029 20.696 20.846 21.253 20.131 18.465 19.513 17.522 16.477 17.801 17.213 17.701 16.7   16.199 18.349 19.975 20.84
  19.264 19.108 19.712 20.42  20.669 20.121 20.332 19.105 17.846 18.742 18.595 18.019 17.627 17.411 17.662 17.486 17.329 17.486 19.624 20.266 33.957
  19.176 19.872 19.756 19.536 19.514 19.48  20.15  20.468 18.413 18.178 17.789 17.574 18.341 17.138 17.716 17.958 18.689 19.152 20.168 34.054 27.527
  23.037 21.755 18.967 18.597 18.175 18.423 18.351 18.881 18.667 19.243 18.042 18.108 18.455 17.342 17.69  18.484 18.988 21.147 12.017 20.213  0.
  18.479 18.424 18.768 18.838 18.743 18.776 18.615 19.039 18.628 18.705 17.905 16.943 18.244 18.349 18.309 19.303 19.753 21.001 21.546 18.365  0.
  20.305 19.436 19.85  18.945 19.085 18.99  18.292 18.77  18.853 18.878 18.147 17.638 18.696 18.782 19.251 19.456 19.716 21.386 21.025 18.298  0.
  20.242 20.169 18.763 18.473 18.059 18.124 18.599 18.249 18.157 18.325 18.186 18.279 19.258 19.853 20.878  0.     0.     0.     0.     0.     0.
  20.388 19.998 18.892 18.188 18.219 18.455 19.191 18.478 18.941 19.243 19.106 19.868 20.644 21.39   0.     0.     0.     0.     0.     0.     0.
  19.804 17.803 17.888 18.619 18.094 19.043 19.855 20.135 19.386 20.515  0.    21.713 27.527 34.628  0.     0.     0.     0.     0.     0.     0.
  18.16  18.446 18.195 18.559 18.884 19.737 20.113 20.24  20.611  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.
  18.302 17.613 18.489 19.408 19.651 20.559 20.156 22.316 23.597  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.
  17.662 17.396 17.617 17.668 20.451 20.433 21.717 23.954  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.
  17.756 18.13  17.327 19.643 21.825 21.125 21.193 35.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.
  17.76  17.628 19.54  21.611 22.305 24.398 21.715 19.071  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.
  19.169 20.499 21.202 22.143 22.683 23.409 21.681  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.
  20.5   21.319 22.386 21.818 22.463 24.02  24.671 25.736  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.
  22.032 21.725 21.896 22.553 22.627 24.399 24.783  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.
  21.372 21.03  22.124 22.889 24.449 25.983 25.438  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.
  21.135 22.354 23.318 23.99  24.581 25.334 23.723  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.
  22.383 24.435 24.203 25.326 25.326 26.127  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.    ]

expected_alf_n::Array{Float64} = Float64[
  1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111
  1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111
  1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111
  1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111
  1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 0.
  1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 0.
  1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 0.
  1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 0.    0.    0.    0.    0.    0.
  1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 0.    0.    0.    0.    0.    0.    0.
  1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 0.    1.111 1.111 1.111 0.    0.    0.    0.    0.    0.    0.
  1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
  1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
  1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
  1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
  1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
  1.111 1.111 1.111 1.111 1.111 1.111 1.111 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
  1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
  1.111 1.111 1.111 1.111 1.111 1.111 1.111 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
  1.111 1.111 1.111 1.111 1.111 1.111 1.111 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
  1.111 1.111 1.111 1.111 1.111 1.111 1.111 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
  1.111 1.111 1.111 1.111 1.111 1.111 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.   ]

expected_arf_k::Array{Float64} = Float64[
  0.136 0.073 0.129 0.098 0.093 0.092 0.123 0.19  0.11  0.155 0.147 0.088 0.087 0.155 0.119 0.091 0.089 0.114 0.103 0.059 0.102
  0.126 0.125 0.116 0.12  0.106 0.19  0.111 0.19  0.155 0.096 0.106 0.104 0.103 0.155 0.105 0.11  0.152 0.056 0.098 0.069 0.122
  0.116 0.112 0.112 0.112 0.191 0.112 0.191 0.155 0.062 0.11  0.104 0.11  0.11  0.146 0.107 0.113 0.066 0.063 0.109 0.112 0.191
  0.099 0.192 0.155 0.155 0.113 0.192 0.155 0.192 0.077 0.069 0.116 0.092 0.091 0.123 0.062 0.097 0.112 0.093 0.114 0.192 0.155
  0.114 0.131 0.067 0.11  0.112 0.113 0.097 0.088 0.085 0.09  0.064 0.065 0.155 0.062 0.063 0.192 0.064 0.124 0.068 0.114 0.
  0.094 0.086 0.106 0.113 0.087 0.111 0.126 0.118 0.136 0.067 0.094 0.105 0.155 0.062 0.09  0.124 0.119 0.071 0.121 0.103 0.
  0.089 0.123 0.114 0.125 0.091 0.112 0.064 0.127 0.094 0.114 0.089 0.092 0.193 0.111 0.118 0.079 0.092 0.103 0.113 0.103 0.
  0.102 0.073 0.118 0.132 0.099 0.067 0.194 0.069 0.116 0.108 0.123 0.114 0.077 0.071 0.077 0.    0.    0.    0.    0.    0.
  0.11  0.079 0.069 0.097 0.07  0.118 0.1   0.117 0.092 0.115 0.07  0.124 0.194 0.165 0.    0.    0.    0.    0.    0.    0.
  0.195 0.068 0.114 0.112 0.138 0.072 0.137 0.118 0.114 0.094 0.    0.075 0.155 0.195 0.    0.    0.    0.    0.    0.    0.
  0.097 0.108 0.092 0.117 0.105 0.093 0.106 0.092 0.125 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
  0.09  0.062 0.076 0.068 0.125 0.101 0.071 0.114 0.107 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
  0.104 0.106 0.118 0.113 0.121 0.129 0.121 0.155 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
  0.108 0.115 0.11  0.116 0.14  0.155 0.085 0.197 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
  0.111 0.111 0.071 0.081 0.133 0.121 0.131 0.107 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
  0.114 0.101 0.101 0.132 0.08  0.085 0.087 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
  0.101 0.08  0.085 0.084 0.079 0.148 0.143 0.122 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
  0.135 0.129 0.102 0.127 0.134 0.149 0.09  0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
  0.098 0.079 0.103 0.083 0.144 0.128 0.093 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
  0.099 0.129 0.109 0.154 0.09  0.154 0.124 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
  0.135 0.088 0.146 0.142 0.138 0.16  0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    ]

expected_arf_n::Array{Float64} = Float64[
  5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479
  5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479
  5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479
  5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479
  5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 0.
  5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 0.
  5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 0.
  5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 0.    0.    0.    0.    0.    0.
  5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 0.    0.    0.    0.    0.    0.    0.
  5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 0.    5.479 5.479 5.479 0.    0.    0.    0.    0.    0.    0.
  5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
  5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
  5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
  5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
  5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
  5.479 5.479 5.479 5.479 5.479 5.479 5.479 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
  5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
  5.479 5.479 5.479 5.479 5.479 5.479 5.479 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
  5.479 5.479 5.479 5.479 5.479 5.479 5.479 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
  5.479 5.479 5.479 5.479 5.479 5.479 5.479 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
  5.479 5.479 5.479 5.479 5.479 5.479 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.   ]

expected_agf_k::Array{Float64} = Float64[
  409.153 236.909 409.153 333.587 333.587 333.587 409.153 409.153 236.909 333.587 422.928 344.586 350.57  333.587 416.919 333.587 333.587 409.415 420.483 239.498 333.587
 410.337 333.587 410.337 410.337 333.587 410.337 238.949 410.337 333.587 334.327 410.337 416.818 454.053 352.951 410.337 410.337 441.821 264.361 333.587 238.949 410.337
 411.518 240.971 240.971 240.971 411.518 240.971 411.518 333.587 241.847 411.518 411.518 411.518 411.518 350.989 414.323 333.587 249.254 240.971 411.518 411.518 411.518
 242.975 412.695 333.587 333.587 242.975 412.695 333.587 412.695 242.975 242.975 421.076 334.787 333.587 436.376 246.789 333.587 412.695 333.587 412.695 412.695 333.587
 244.96  333.587 244.96  413.867 413.867 413.867 333.587 333.587 333.587 333.587 249.761 245.294 333.916 253.661 254.475 413.867 244.96  413.867 244.96  244.96    0.
 343.52  333.587 415.034 415.034 333.587 415.034 415.034 333.587 415.034 246.927 333.587 452.113 336.101 246.927 333.587 415.034 415.034 246.927 415.034 333.587   0.
 333.587 416.196 416.196 416.196 333.587 416.196 248.875 416.196 333.587 416.196 338.228 345.272 416.196 416.196 416.196 248.875 333.587 333.587 333.587 333.587   0.
 333.587 250.804 417.352 417.352 333.587 250.804 424.364 255.678 250.804 417.352 417.352 417.352 250.804 250.804 250.804   0.      0.      0.      0.      0.      0.
 333.587 252.714 252.714 333.587 252.714 418.503 333.587 418.503 333.587 418.503 252.714 418.503 418.503 418.503   0.      0.      0.      0.      0.      0.      0.
 419.647 256.548 422.567 419.647 419.647 254.605 419.647 254.605 419.647 333.587   0.    254.605 333.587 419.647   0.      0.      0.      0.      0.      0.      0.
 339.099 420.785 340.932 420.785 333.587 333.587 333.587 333.587 420.785   0.      0.      0.      0.      0.      0.      0.      0.      0.      0.      0.      0.
 342.385 286.491 258.327 258.327 421.916 333.587 258.327 333.587 258.327   0.      0.      0.      0.      0.      0.      0.      0.      0.      0.      0.      0.
 433.177 435.825 426.157 439.234 423.04  423.04  260.159 333.587   0.      0.      0.      0.      0.      0.      0.      0.      0.      0.      0.      0.      0.
 440.367 443.716 442.886 424.157 424.157 333.587 261.971 424.157   0.      0.      0.      0.      0.      0.      0.      0.      0.      0.      0.      0.      0.
 429.543 453.347 263.764 263.764 425.266 333.587 333.587 263.764   0.      0.      0.      0.      0.      0.      0.      0.      0.      0.      0.      0.      0.
 426.368 333.587 333.587 426.368 265.536 265.536 265.536   0.      0.      0.      0.      0.      0.      0.      0.      0.      0.      0.      0.      0.      0.
 333.587 267.288 267.288 267.288 267.288 427.461 427.461 333.587   0.      0.      0.      0.      0.      0.      0.      0.      0.      0.      0.      0.      0.
 428.546 333.587 333.587 428.546 428.546 428.546 269.02    0.      0.      0.      0.      0.      0.      0.      0.      0.      0.      0.      0.      0.      0.
 333.587 270.73  333.587 270.73  429.622 333.587 270.73    0.      0.      0.      0.      0.      0.      0.      0.      0.      0.      0.      0.      0.      0.
 333.587 430.689 333.587 430.689 272.421 430.689 333.587   0.      0.      0.      0.      0.      0.      0.      0.      0.      0.      0.      0.      0.      0.
 431.748 274.091 431.748 431.748 431.748 431.748   0.      0.      0.      0.      0.      0.      0.      0.      0.      0.      0.      0.      0.      0.      0.    ]

cell_areas::Array{Float64} = Float64[ 2.195e+09
                                      2.214e+09
                                      2.233e+09
                                      2.251e+09
                                      2.270e+09
                                      2.288e+09
                                      2.306e+09
                                      2.324e+09
                                      2.342e+09
                                      2.359e+09
                                      2.377e+09
                                      2.394e+09
                                      2.411e+09
                                      2.427e+09
                                      2.444e+09
                                      2.461e+09
                                      2.477e+09
                                      2.493e+09
                                      2.509e+09
                                      2.524e+09
                                      2.540e+09 ]
cell_areas_expanded = repeat(cell_areas,1,20)
riverflow_formula::RiverFlowFormula = RiverFlowSausen()
overlandflow_formula::OverlandFlowFormula = OverlandFlowSausen()
baseflow_formula::BaseFlowFormula = BaseFlowDistanceAndOrography()
configuration::Configuration = Configuration(riverflow_formula,
                                             overlandflow_formula,
                                             baseflow_formula)
lats = collect(range(9.5;stop=-9.5,length=20))
lons = collect(range(9.5;stop=-9.5,length=20))
grid::Grid =  LatLonGrid(20,20,lats,lons)
input_data::InputData = InputData(collect(isone.(lsmask)),
                                  collect(isone.(glacier_mask)),
                                  orography,
                                  innerslope,
                                  variance,
                                  rdirs,
                                  cell_areas_expanded,
                                  grid)
generate_parameters(configuration,
                    input_data,
                    grid)

end
end
