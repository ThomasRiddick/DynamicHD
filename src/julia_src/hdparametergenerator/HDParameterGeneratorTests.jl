module HDParameterGeneratorTests
using Test: @test, @testset
using HDParameterGenerator: generate_parameters, Grid, InputData
using HDParameterGenerator: Configuration, LatLonGrid
using HDParameterGenerator: RiverFlowFormula, OverlandFlowFormula
using HDParameterGenerator: BaseFlowFormula
using HDParameterGenerator: RiverFlowSausen, OverlandFlowSausen
using HDParameterGenerator: BaseFlowDistanceAndOrography

@testset "Parameter generation tests" begin
rdirs::Array{Int64} = Int64[ 6 3 2 2 8 6 6 6 6 6 6 6 6 6 9 6 9 9 9 9 8
                             2 2 6 1 4 4 9 9 8 9 8 6 9 8 6 3 2 6 6 6 8
                             4 4 4 8 8 7 3 9 7 4 9 9 8 3 3 6 6 6 8 8 8
                             7 9 8 7 4 3 2 1 1 7 4 3 2 6 6 6 8 9 8 7 7
                             3 3 2 1 1 6 1 4 4 3 2 3 3 3 9 8 7 7 7 6 6
                             6 6 3 4 2 1 4 4 2 2 3 2 6 6 8 8 7 7 9 6 9
                             9 9 6 6 2 3 2 3 3 2 6 6 9 8 7 8 8 2 9 9 9
                             9 9 9 8 6 6 6 6 6 9 8 8 7 7 6 6 6 2 1 1 2
                             9 9 8 4 7 7 2 1 4 6 9 4 7 6 6 8 8 6 3 3 2
                             9 9 8 7 7 4 4 4 2 8 8 6 6 9 8 8 9 8 8 6 9
                             8 6 8 7 7 4 3 2 6 6 6 9 8 8 9 8 9 7 2 3 2
                             7 4 3 3 8 9 9 9 9 6 9 8 7 8 4 4 1 6 3 3 3
                             8 7 4 6 6 6 9 8 4 4 9 4 9 8 7 7 3 3 3 2 3
                             8 8 7 9 6 9 9 9 8 7 8 6 9 8 3 2 6 6 3 3 6
                             2 7 3 9 9 8 7 9 9 6 6 9 8 7 6 6 6 8 8 6 9
                             3 3 3 2 4 8 9 8 6 6 9 8 7 7 9 3 8 2 9 3 6
                             6 6 6 3 3 3 3 9 8 7 8 8 7 6 3 2 6 3 6 6 6
                             6 6 6 6 6 6 6 6 9 8 4 9 8 3 6 2 1 3 2 1 3
                             9 8 8 8 8 6 8 9 8 8 8 2 6 6 6 2 1 6 3 2 6
                             8 4 4 9 8 9 8 8 3 3 3 2 4 3 6 6 3 1 3 3 3
                             8 4 2 3 2 6 6 8 6 6 6 3 2 6 3 2 3 3 6 6 8 ]

orography::Array{Float64} = Float64[
 1904.667 1884.444 1759.778 1939.778 1622.889 1443.889 1253.222 1253.222 1253.222 1253.222 1253.222 1227.778 1227.778 1168.778 1133.111 1133.111 1134.111 1138.556 1101.778 1042.444 1042.444
 1681.333 1513.444 1390.556 1390.556 1397.333 1528.667 1253.222 1253.222 1253.222 1314.667 1321.444 1352.667 1288.667 1285.333 1219.778 1157.556 1183.889 1042.444 1042.444 1042.444 1042.444
 1136.222 1390.556 1390.556 1390.556 1506.778 1788.111 1787.556 1839.444 1545.222 1513.    1518.556 1495.333 1483.444 1347.333 1181.111 1042.444 1042.444 1042.444 1042.444 1042.444 1042.444
 1676.222 1834.667 1586.222 1703.556 1630.667 1520.222 1592.556 1615.444 1882.778 1569.778 1524.333 1501.667 1350.667 1263.778 1092.889 1042.444 1042.444 1042.444 1082.667 1179.111 1144.444
 1124.778 1136.667 1200.444 1318.667 1358.444 1282.222 1206.333 1289.333 1489.667 1505.    1424.333 1348.222 1098.    1093.778 1042.444 1042.444 1048.444 1109.111 1181.222 1124.778 1145.
 1062.556 1062.556 1062.556 1062.556 1100.778 1172.556 1234.667 1299.667 1395.222 1365.    1182.222 1118.556 1042.444 1042.444 1058.444 1218.222 1216.667 1239.111 1267.444 1229.778 1209.222
 1062.556 1062.556 1062.556 1062.556 1062.556 1062.556 1062.556 1044.444 1042.444 1042.444 1042.444 1042.444 1116.111 1272.111 1457.111 1550.556 1447.333 1515.778 1619.667 1579.333 1481.556
 1062.556 1062.556 1062.556 1062.556 1062.556 1097.556 1107.333 1062.    1042.444 1042.444 1069.778 1069.778 1407.444 1880.    1422.444 1229.778 1229.778 1229.778 1396.778 1557.444 1561.222
 1092.556 1062.556 1062.556 1119.778 1231.889 1389.111 1393.667 1336.222 1378.222 1322.889 1270.222 1371.667 1523.    1229.778 1229.778 1229.778 1229.778 1229.778 1229.778 1285.444 1352.444
 1240.222 1257.222 1177.778 1216.667 1266.222 1343.556 1416.778 1546.889 1487.778 1390.333 1516.333 1312.556 1229.778 1229.778 1229.778 1229.778 1236.889 1272.222 1254.889 1179.444 1179.444
 1468.444 1405.    1315.667 1311.    1289.    1475.222 1468.333 1403.111 1328.222 1377.778 1345.    1229.778 1229.778 1229.778 1507.889 1383.667 1346.333 1394.    1457.111 1418.    1372.667
 1463.111 1746.778 1639.    1489.222 1553.667 1383.556 1362.556 1324.667 1324.667 1302.556 1229.778 1283.333 1550.889 1317.444 1306.444 1353.444 1449.    1384.333 1333.111 1343.667 1257.778
 2261.    1783.333 2049.333 2030.778 1471.333 1365.    1334.444 1325.    1330.889 1340.111 1334.556 1751.    1428.222 1306.444 1306.444 1325.333 1403.444 1338.    1312.333 1278.    1188.667
 3443.778 3400.333 2908.889 2603.333 1877.667 1485.556 1453.778 1429.778 1402.222 1349.667 1371.556 1458.667 1306.444 1306.444 1452.333 1366.556 1360.667 1274.778 1192.667 1142.556 1136.556
 3801.222 3798.778 3533.778 3452.444 3256.667 1951.889 1698.889 1629.111 1578.444 1492.889 1366.222 1331.444 1306.444 1392.556 1459.556 1371.667 1356.    1299.889 1265.111 1156.667 1011.556
 3345.778 3621.111 3543.889 3110.222 3556.667 3064.444 2702.111 2379.    1571.333 1613.889 1639.222 1425.778 1586.444 1549.333 1604.333 1591.556 1596.    1548.222 1345.222 1195.222  996.556
 3267.556 3267.556 3267.556 2895.111 3001.778 2783.667 2424.444 2213.889 1775.222 1571.333 2040.    1647.444 1609.222 1761.333 1498.    1510.667 1464.    1425.111 1277.222 1132.778  977.222
 3267.556 3267.556 3340.556 2895.111 2910.111 2407.    1930.667 1792.111 1805.556 1785.333 1930.778 2099.444 1767.556 1686.    1490.556 1375.667 1440.333 1346.    1183.778 1219.111  977.222
 3328.222 3267.556 3360.889 3550.889 2839.444 2848.222 2040.444 2201.    2172.889 2012.889 1938.444 1930.556 2177.556 1614.444 1368.889 1265.111 1247.667 1474.    1077.    1245.444 1341.333
 3504.333 3616.889 3699.667 3814.444 3636.556 3313.556 2949.222 2311.556 2265.333 2010.111 2010.    1701.889 2072.667 1700.444 1354.444 1103.667 1104.778 1408.889 1133.889  783.111  690.889
 3940.444 3763.444 3799.556 3688.778 3651.111 3335.778 3159.667 2905.222 2779.222 2050.    1672.889 1522.444 1736.556 1653.333 1105.444 1322.889  997.889  755.111  588.889  588.889  588.889 ]

glacier_mask::Array{Int64} = Int64[ 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
                                    0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
                                    0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
                                    0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
                                    0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
                                    0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
                                    0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
                                    0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
                                    0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
                                    0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
                                    0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
                                    0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
                                    0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
                                    0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
                                    0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
                                    0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
                                    0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
                                    0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
                                    0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
                                    0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
                                    0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 ]

lsmask::Array{Int64} = Int64[ 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
                              1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
                              1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0
                              1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0
                              1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0
                              1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0
                              1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0
                              1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 1 0 0 1 0
                              1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0
                              1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0
                              1 1 1 1 1 1 1 1 0 0 1 0 0 0 0 0 0 0 0 0 0
                              1 1 1 1 1 1 1 0 0 0 1 0 0 0 0 0 0 0 0 0 0
                              1 1 1 1 1 1 1 0 1 0 0 0 0 0 0 0 0 0 0 0 0
                              1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
                              1 1 1 1 1 1 1 0 1 0 0 0 0 0 0 0 0 0 0 0 0
                              1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
                              1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0
                              1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0
                              1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0
                              1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
                              1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 ]

innerslope::Array{Float64} = Float64[
 0.003 0.002 0.002 0.003 0.002 0.002 0.002 0.001 0.001 0.002 0.007 0.008 0.01  0.004 0.013 0.009 0.013 0.011 0.013 0.008 0.003
 0.002 0.002 0.004 0.002 0.003 0.002 0.002 0.001 0.002 0.006 0.003 0.01  0.018 0.008 0.011 0.009 0.015 0.021 0.006 0.003 0.002
 0.004 0.004 0.003 0.002 0.002 0.002 0.002 0.004 0.008 0.005 0.005 0.007 0.009 0.01  0.009 0.01  0.011 0.01  0.003 0.002 0.
 0.004 0.003 0.003 0.003 0.003 0.004 0.002 0.002 0.006 0.007 0.009 0.01  0.006 0.013 0.009 0.008 0.005 0.004 0.002 0.    0.
 0.001 0.001 0.005 0.006 0.007 0.006 0.007 0.005 0.006 0.004 0.008 0.007 0.006 0.012 0.009 0.006 0.005 0.002 0.    0.    0.
 0.006 0.006 0.005 0.005 0.005 0.005 0.006 0.005 0.006 0.006 0.009 0.015 0.007 0.007 0.007 0.004 0.003 0.002 0.    0.    0.
 0.003 0.004 0.003 0.005 0.005 0.005 0.007 0.006 0.005 0.005 0.008 0.01  0.006 0.005 0.004 0.004 0.003 0.001 0.002 0.    0.
 0.003 0.003 0.006 0.007 0.008 0.008 0.006 0.008 0.008 0.007 0.008 0.007 0.004 0.003 0.002 0.002 0.001 0.    0.    0.    0.
 0.003 0.003 0.005 0.008 0.008 0.007 0.005 0.007 0.005 0.005 0.005 0.003 0.002 0.002 0.    0.    0.    0.    0.    0.    0.
 0.004 0.01  0.01  0.007 0.009 0.005 0.003 0.003 0.004 0.002 0.001 0.001 0.    0.    0.    0.    0.    0.    0.    0.    0.
 0.009 0.007 0.008 0.007 0.006 0.004 0.003 0.003 0.002 0.001 0.001 0.001 0.    0.    0.    0.    0.    0.    0.    0.    0.
 0.008 0.012 0.007 0.005 0.004 0.003 0.003 0.001 0.001 0.001 0.001 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
 0.012 0.014 0.012 0.012 0.003 0.003 0.002 0.001 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
 0.012 0.009 0.015 0.004 0.001 0.002 0.002 0.    0.    0.001 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
 0.012 0.013 0.005 0.002 0.001 0.    0.002 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
 0.006 0.003 0.002 0.001 0.001 0.001 0.002 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
 0.003 0.002 0.001 0.002 0.001 0.001 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
 0.001 0.002 0.002 0.001 0.001 0.001 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
 0.002 0.002 0.001 0.001 0.001 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
 0.002 0.001 0.001 0.001 0.001 0.    0.001 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
 0.001 0.001 0.001 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.   ]

variance::Array{Float64} = Float64[
  36.79  29.31  32.25  49.67  50.12  52.2   35.03  15.36  11.51  36.09 148.91 148.13 168.28  76.89 132.42  89.15 100.65 111.83 142.2  123.38  34.81
  19.82  31.42  40.27  19.45  36.93  34.51  35.93  17.21  47.79 113.6   52.2  128.84 230.81 176.3  100.66 104.08 197.29 230.6   76.16  36.81  22.52
  71.24  88.    69.46  51.48  41.58  53.7   45.1   81.89 115.19 106.88  72.86  73.59 104.68 169.69 118.76  96.07 149.7  105.28  47.51  39.5    0.
  69.34  69.62  73.9   80.66  78.61  92.09  50.59  27.68  95.68  98.18 133.91 115.15  92.66 175.55 128.73  79.81  64.3   69.58  43.79   0.     0.
  16.27  22.22  98.    92.85 109.03 101.83  82.21  66.68  54.76  33.26 133.11 112.64 112.22 150.99 154.72  62.69  97.22  24.71   0.     0.     0.
 144.54  73.86  60.36  48.71  62.52  42.56  58.83  43.33  46.62  59.04  95.23 211.47 119.57  81.87 108.92  42.05  56.37  25.03   0.     0.     0.
  26.    34.41  30.07  53.76  56.95  49.43  86.32  65.38  74.04  63.39 126.73 150.44  68.61  75.52  51.48  56.76  46.36  17.94  17.8    0.     0.
  25.38  30.87  47.58  57.65  89.85  93.56 129.97 132.93 101.53 101.67  65.36  80.07  62.76  65.43  44.16  35.84  25.68   0.     0.     0.     0.
  27.79  43.6   57.7  102.35  78.39 103.7   59.77  89.89 100.85  47.85  85.59  45.13  25.99  16.92   0.     0.     0.     0.     0.     0.     0.
  58.98 119.68 118.92  66.32  68.48  62.58  45.43  32.56  49.67  37.9   20.3   21.21   0.     0.     0.     0.     0.     0.     0.     0.     0.
 129.66  75.43 135.83  83.39  97.98  57.47  36.76  41.59  50.21  15.33   8.03  13.47   0.     0.     0.     0.     0.     0.     0.     0.     0.
 140.72 233.61 103.2   67.05  45.69  37.09  57.03  16.53   9.41  12.31  10.59   0.     0.     0.     0.     0.     0.     0.     0.     0.     0.
 138.01 145.04 119.38 154.09  41.14  35.08  23.43   8.65   3.39   6.83   0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.
 154.02 162.89 160.69  75.59  20.55  21.3   17.38   0.     5.53   8.68   0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.
 122.4  185.27  77.1   18.6   15.92   6.18  14.07   0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.
  91.    40.88  29.64  18.26  17.72   8.53  13.18   0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.
  47.17  31.03  15.76  19.79  19.67   6.98   7.67   4.77   0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.
  22.96  21.47  24.41  16.91  21.85   6.17   5.39   5.29   0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.
  30.49  39.98  16.75  18.71   9.37   3.92   5.83   4.01   0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.
  30.62  17.03  13.95   7.48   7.76   4.76   6.46   0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.
  23.85  12.22   7.01   6.88   6.32   4.72   0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.  ]

expected_rdirs::Array{Int64} = Int64[ 7 4 3 2 2 2 3  3  6  8  9  8  8  8  7  8  2  1  3  6  2
                                      7 8 3 3 2 1 6  9  8  8  7  7  9  8  7  7  1  6  2  6  3
                                      3 6 6 6 3 4 9  8  4  7  7  7  3  2  7  2  6  6  3  3  3
                                      6 9 8 8 6 9 8  7  4  4  3  2  2  1  4  2  3  2  3  3  2
                                      6 8 4 7 9 9 8  8  8  8  6  6  2  4  6  1  6  3  6  6  0
                                      8 8 7 9 8 9 3  2  1  4  2  3  2  4  2  1  9  6  9  8  0
                                      8 1 7 7 2 3 6  3  2  1  2  2  1  3  3  4  2  2  2  8  0
                                      2 4 1 1 2 6 1  4  4  3  1  3  6  6  6  0  0  0  0  0 -1
                                      2 4 4 2 6 3 2  3  2  3  6  3  9  3  0  0 -1 -1  0  0 -1
                                      7 4 7 3 9 6 3  6  3  2  0  6  2  1  0 -1 -1 -1 -1 -1 -1
                                      8 7 2 3 2 2 8  2  1  0 -1  0  0  0  0 -1 -1 -1 -1 -1 -1
                                      8 6 6 6 3 2 6  2  4  0 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1
                                      7 9 9 9 3 3 4  2  0 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1
                                      3 9 3 3 9 8 6  3  0 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1
                                      3 3 6 6 3 2 8  6  0 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1
                                      3 2 2 9 6 6 6  0 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1
                                      2 6 6 6 6 3 3  8 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1
                                      9 8 2 3 3 3 6  0 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1
                                      2 6 2 6 3 2 6  0 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1
                                      2 3 2 9 6 3 2 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1
                                      3 6 3 3 3 3 0 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 ]

expected_flag::Array{Int64} = Int64[ 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
                                     1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
                                     1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
                                     1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
                                     1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0
                                     1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0
                                     1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0
                                     1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0
                                     1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0
                                     1 1 1 1 1 1 1 1 1 1 0 1 1 1 0 0 0 0 0 0 0
                                     1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0
                                     1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0
                                     1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0
                                     1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0
                                     1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0
                                     1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0
                                     1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0
                                     1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0
                                     1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0
                                     1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0
                                     1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 ]

expected_alf_k::Array{Float64} = Float64[
  19.926 20.972 20.517 19.964 20.108 20.083 20.77  21.711 22.395 20.763 18.139 17.765 17.405 19.143 16.898 17.66  16.895 17.249 16.878 17.752 19.73
  20.55  20.517 19.362 20.399 20.029 20.696 20.846 21.253 20.131 18.465 19.513 17.522 16.477 17.801 17.213 17.701 16.7   16.199 18.349 19.975 20.84
  19.264 19.108 19.712 20.42  20.669 20.121 20.332 19.105 17.846 18.742 18.595 18.019 17.627 17.411 17.662 17.486 17.329 17.486 19.624 20.266 33.957
  19.176 19.872 19.756 19.536 19.514 19.48  20.15  20.468 18.413 18.178 17.789 17.574 18.341 17.138 17.716 17.958 18.689 19.152 20.168 34.054 27.527
  23.037 21.755 18.967 18.597 18.175 18.423 18.351 18.881 18.667 19.243 18.042 18.108 18.455 17.342 17.69  18.484 18.988 21.147 12.017 20.213  0.
  18.479 18.424 18.768 18.838 18.743 18.776 18.615 19.039 18.628 18.705 17.905 16.943 18.244 18.349 18.309 19.303 19.753 21.001 21.546 18.365  0.
  20.305 19.436 19.85  18.945 19.085 18.99  18.292 18.77  18.853 18.878 18.147 17.638 18.696 18.782 19.251 19.456 19.716 21.386 21.025 18.298  0.
  20.242 20.169 18.763 18.473 18.059 18.124 18.599 18.249 18.157 18.325 18.186 18.279 19.258 19.853 20.878  0.     0.     0.     0.     0.     0.
  20.388 19.998 18.892 18.188 18.219 18.455 19.191 18.478 18.941 19.243 19.106 19.868 20.644 21.39   0.     0.     0.     0.     0.     0.     0.
  19.804 17.803 17.888 18.619 18.094 19.043 19.855 20.135 19.386 20.515  0.    21.713 27.527 34.628  0.     0.     0.     0.     0.     0.     0.
  18.16  18.446 18.195 18.559 18.884 19.737 20.113 20.24  20.611  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.
  18.302 17.613 18.489 19.408 19.651 20.559 20.156 22.316 23.597  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.
  17.662 17.396 17.617 17.668 20.451 20.433 21.717 23.954  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.
  17.756 18.13  17.327 19.643 21.825 21.125 21.193 35.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.
  17.76  17.628 19.54  21.611 22.305 24.398 21.715 19.071  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.
  19.169 20.499 21.202 22.143 22.683 23.409 21.681  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.
  20.5   21.319 22.386 21.818 22.463 24.02  24.671 25.736  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.
  22.032 21.725 21.896 22.553 22.627 24.399 24.783  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.
  21.372 21.03  22.124 22.889 24.449 25.983 25.438  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.
  21.135 22.354 23.318 23.99  24.581 25.334 23.723  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.
  22.383 24.435 24.203 25.326 25.326 26.127  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.    ]

expected_alf_n::Array{Float64} = Float64[
  1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111
  1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111
  1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111
  1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111
  1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 0.
  1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 0.
  1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 0.
  1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 0.    0.    0.    0.    0.    0.
  1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 0.    0.    0.    0.    0.    0.    0.
  1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 0.    1.111 1.111 1.111 0.    0.    0.    0.    0.    0.    0.
  1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
  1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
  1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
  1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
  1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
  1.111 1.111 1.111 1.111 1.111 1.111 1.111 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
  1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
  1.111 1.111 1.111 1.111 1.111 1.111 1.111 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
  1.111 1.111 1.111 1.111 1.111 1.111 1.111 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
  1.111 1.111 1.111 1.111 1.111 1.111 1.111 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
  1.111 1.111 1.111 1.111 1.111 1.111 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.   ]

expected_arf_k::Array{Float64} = Float64[
  0.136 0.073 0.129 0.098 0.093 0.092 0.123 0.19  0.11  0.155 0.147 0.088 0.087 0.155 0.119 0.091 0.089 0.114 0.103 0.059 0.102
  0.126 0.125 0.116 0.12  0.106 0.19  0.111 0.19  0.155 0.096 0.106 0.104 0.103 0.155 0.105 0.11  0.152 0.056 0.098 0.069 0.122
  0.116 0.112 0.112 0.112 0.191 0.112 0.191 0.155 0.062 0.11  0.104 0.11  0.11  0.146 0.107 0.113 0.066 0.063 0.109 0.112 0.191
  0.099 0.192 0.155 0.155 0.113 0.192 0.155 0.192 0.077 0.069 0.116 0.092 0.091 0.123 0.062 0.097 0.112 0.093 0.114 0.192 0.155
  0.114 0.131 0.067 0.11  0.112 0.113 0.097 0.088 0.085 0.09  0.064 0.065 0.155 0.062 0.063 0.192 0.064 0.124 0.068 0.114 0.
  0.094 0.086 0.106 0.113 0.087 0.111 0.126 0.118 0.136 0.067 0.094 0.105 0.155 0.062 0.09  0.124 0.119 0.071 0.121 0.103 0.
  0.089 0.123 0.114 0.125 0.091 0.112 0.064 0.127 0.094 0.114 0.089 0.092 0.193 0.111 0.118 0.079 0.092 0.103 0.113 0.103 0.
  0.102 0.073 0.118 0.132 0.099 0.067 0.194 0.069 0.116 0.108 0.123 0.114 0.077 0.071 0.077 0.    0.    0.    0.    0.    0.
  0.11  0.079 0.069 0.097 0.07  0.118 0.1   0.117 0.092 0.115 0.07  0.124 0.194 0.165 0.    0.    0.    0.    0.    0.    0.
  0.195 0.068 0.114 0.112 0.138 0.072 0.137 0.118 0.114 0.094 0.    0.075 0.155 0.195 0.    0.    0.    0.    0.    0.    0.
  0.097 0.108 0.092 0.117 0.105 0.093 0.106 0.092 0.125 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
  0.09  0.062 0.076 0.068 0.125 0.101 0.071 0.114 0.107 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
  0.104 0.106 0.118 0.113 0.121 0.129 0.121 0.155 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
  0.108 0.115 0.11  0.116 0.14  0.155 0.085 0.197 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
  0.111 0.111 0.071 0.081 0.133 0.121 0.131 0.107 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
  0.114 0.101 0.101 0.132 0.08  0.085 0.087 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
  0.101 0.08  0.085 0.084 0.079 0.148 0.143 0.122 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
  0.135 0.129 0.102 0.127 0.134 0.149 0.09  0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
  0.098 0.079 0.103 0.083 0.144 0.128 0.093 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
  0.099 0.129 0.109 0.154 0.09  0.154 0.124 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
  0.135 0.088 0.146 0.142 0.138 0.16  0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    ]

expected_arf_n::Array{Float64} = Float64[
  5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479
  5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479
  5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479
  5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479
  5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 0.
  5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 0.
  5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 0.
  5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 0.    0.    0.    0.    0.    0.
  5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 0.    0.    0.    0.    0.    0.    0.
  5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 0.    5.479 5.479 5.479 0.    0.    0.    0.    0.    0.    0.
  5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
  5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
  5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
  5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
  5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
  5.479 5.479 5.479 5.479 5.479 5.479 5.479 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
  5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
  5.479 5.479 5.479 5.479 5.479 5.479 5.479 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
  5.479 5.479 5.479 5.479 5.479 5.479 5.479 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
  5.479 5.479 5.479 5.479 5.479 5.479 5.479 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
  5.479 5.479 5.479 5.479 5.479 5.479 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.   ]

expected_agf_k::Array{Float64} = Float64[
  409.153 236.909 409.153 333.587 333.587 333.587 409.153 409.153 236.909 333.587 422.928 344.586 350.57  333.587 416.919 333.587 333.587 409.415 420.483 239.498 333.587
 410.337 333.587 410.337 410.337 333.587 410.337 238.949 410.337 333.587 334.327 410.337 416.818 454.053 352.951 410.337 410.337 441.821 264.361 333.587 238.949 410.337
 411.518 240.971 240.971 240.971 411.518 240.971 411.518 333.587 241.847 411.518 411.518 411.518 411.518 350.989 414.323 333.587 249.254 240.971 411.518 411.518 411.518
 242.975 412.695 333.587 333.587 242.975 412.695 333.587 412.695 242.975 242.975 421.076 334.787 333.587 436.376 246.789 333.587 412.695 333.587 412.695 412.695 333.587
 244.96  333.587 244.96  413.867 413.867 413.867 333.587 333.587 333.587 333.587 249.761 245.294 333.916 253.661 254.475 413.867 244.96  413.867 244.96  244.96    0.
 343.52  333.587 415.034 415.034 333.587 415.034 415.034 333.587 415.034 246.927 333.587 452.113 336.101 246.927 333.587 415.034 415.034 246.927 415.034 333.587   0.
 333.587 416.196 416.196 416.196 333.587 416.196 248.875 416.196 333.587 416.196 338.228 345.272 416.196 416.196 416.196 248.875 333.587 333.587 333.587 333.587   0.
 333.587 250.804 417.352 417.352 333.587 250.804 424.364 255.678 250.804 417.352 417.352 417.352 250.804 250.804 250.804   0.      0.      0.      0.      0.      0.
 333.587 252.714 252.714 333.587 252.714 418.503 333.587 418.503 333.587 418.503 252.714 418.503 418.503 418.503   0.      0.      0.      0.      0.      0.      0.
 419.647 256.548 422.567 419.647 419.647 254.605 419.647 254.605 419.647 333.587   0.    254.605 333.587 419.647   0.      0.      0.      0.      0.      0.      0.
 339.099 420.785 340.932 420.785 333.587 333.587 333.587 333.587 420.785   0.      0.      0.      0.      0.      0.      0.      0.      0.      0.      0.      0.
 342.385 286.491 258.327 258.327 421.916 333.587 258.327 333.587 258.327   0.      0.      0.      0.      0.      0.      0.      0.      0.      0.      0.      0.
 433.177 435.825 426.157 439.234 423.04  423.04  260.159 333.587   0.      0.      0.      0.      0.      0.      0.      0.      0.      0.      0.      0.      0.
 440.367 443.716 442.886 424.157 424.157 333.587 261.971 424.157   0.      0.      0.      0.      0.      0.      0.      0.      0.      0.      0.      0.      0.
 429.543 453.347 263.764 263.764 425.266 333.587 333.587 263.764   0.      0.      0.      0.      0.      0.      0.      0.      0.      0.      0.      0.      0.
 426.368 333.587 333.587 426.368 265.536 265.536 265.536   0.      0.      0.      0.      0.      0.      0.      0.      0.      0.      0.      0.      0.      0.
 333.587 267.288 267.288 267.288 267.288 427.461 427.461 333.587   0.      0.      0.      0.      0.      0.      0.      0.      0.      0.      0.      0.      0.
 428.546 333.587 333.587 428.546 428.546 428.546 269.02    0.      0.      0.      0.      0.      0.      0.      0.      0.      0.      0.      0.      0.      0.
 333.587 270.73  333.587 270.73  429.622 333.587 270.73    0.      0.      0.      0.      0.      0.      0.      0.      0.      0.      0.      0.      0.      0.
 333.587 430.689 333.587 430.689 272.421 430.689 333.587   0.      0.      0.      0.      0.      0.      0.      0.      0.      0.      0.      0.      0.      0.
 431.748 274.091 431.748 431.748 431.748 431.748   0.      0.      0.      0.      0.      0.      0.      0.      0.      0.      0.      0.      0.      0.      0.    ]

cell_areas::Array{Float64} = Float64[ 2.195e+09
                                      2.214e+09
                                      2.233e+09
                                      2.251e+09
                                      2.270e+09
                                      2.288e+09
                                      2.306e+09
                                      2.324e+09
                                      2.342e+09
                                      2.359e+09
                                      2.377e+09
                                      2.394e+09
                                      2.411e+09
                                      2.427e+09
                                      2.444e+09
                                      2.461e+09
                                      2.477e+09
                                      2.493e+09
                                      2.509e+09
                                      2.524e+09
                                      2.540e+09 ]
cell_areas_expanded = repeat(cell_areas,1,21)
riverflow_formula::RiverFlowFormula = RiverFlowSausen()
overlandflow_formula::OverlandFlowFormula = OverlandFlowSausen()
baseflow_formula::BaseFlowFormula = BaseFlowDistanceAndOrography()
configuration::Configuration = Configuration(riverflow_formula,
                                             overlandflow_formula,
                                             baseflow_formula)
lats = Float64[ 44.75 44.25 43.75 43.25 42.75 42.25 41.75 41.25 40.75 40.25 39.75 39.25 38.75 38.25 37.75 37.25 36.75 36.25 35.75 35.25 34.75 ]
lons = Float64[ -79.75 -79.25 -78.75 -78.25 -77.75 -77.25 -76.75 -76.25 -75.75 -75.25 -74.75 -74.25 -73.75 -73.25 -72.75 -72.25 -71.75 -71.25 -70.75 -70.25 -69.75 ]
dlon = Float64[ 39484.8 39824.8 40161.9 40495.8 40826.7 41154.5 41479.2 41800.6 41154.5 41479.2 41800.6 42119.0 42434.1 42745.9 43054.5 43359.9 43359.9 43960.6 44256.0 44548.0 44836.6 44836.6 44836.6 45681.8 ]
grid::Grid =  LatLonGrid(21,21,vec(lats),vec(lons),55597.8008,vec(dlon))
input_data::InputData = InputData(collect(isone.(lsmask)),
                                  collect(isone.(glacier_mask)),
                                  orography,
                                  innerslope,
                                  variance,
                                  rdirs,
                                  cell_areas_expanded,
                                  grid)
results = generate_parameters(configuration,
                              input_data,
                              grid)
display(round.(results[1];digits=2))
println()
display(round.(results[2];digits=2))
end
end
