module HDParameterGeneratorTests
using Test: @test, @testset
using HDParameterGenerator: generate_parameters, Grid, InputData
using HDParameterGenerator: Configuration, LatLonGrid
using HDParameterGenerator: RiverFlowFormula, OverlandFlowFormula
using HDParameterGenerator: BaseFlowFormula
using HDParameterGenerator: RiverFlowSausen, OverlandFlowSausen
using HDParameterGenerator: BaseFlowDistanceAndOrography

@testset "Parameter generation tests" begin
rdirs::Array{Int64} = Int64[ 6 3 2 2 8 6 6 6 6 6 6 6 6 6 9 6 9 9 9 9 8
                             2 2 6 1 4 4 9 9 8 9 8 6 9 8 6 3 2 6 6 6 8
                             4 4 4 8 8 7 3 9 7 4 9 9 8 3 3 6 6 6 8 8 8
                             7 9 8 7 4 3 2 1 1 7 4 3 2 6 6 6 8 9 8 7 7
                             3 3 2 1 1 6 1 4 4 3 2 3 3 3 9 8 7 7 7 6 6
                             6 6 3 4 2 1 4 4 2 2 3 2 6 6 8 8 7 7 9 6 9
                             9 9 6 6 2 3 2 3 3 2 6 6 9 8 7 8 8 2 9 9 9
                             9 9 9 8 6 6 6 6 6 9 8 8 7 7 6 6 6 2 1 1 2
                             9 9 8 4 7 7 2 1 4 6 9 4 7 6 6 8 8 6 3 3 2
                             9 9 8 7 7 4 4 4 2 8 8 6 6 9 8 8 9 8 8 6 9
                             8 6 8 7 7 4 3 2 6 6 6 9 8 8 9 8 9 7 2 3 2
                             7 4 3 3 8 9 9 9 9 6 9 8 7 8 4 4 1 6 3 3 3
                             8 7 4 6 6 6 9 8 4 4 9 4 9 8 7 7 3 3 3 2 3
                             8 8 7 9 6 9 9 9 8 7 8 6 9 8 3 2 6 6 3 3 6
                             2 7 3 9 9 8 7 9 9 6 6 9 8 7 6 6 6 8 8 6 9
                             3 3 3 2 4 8 9 8 6 6 9 8 7 7 9 3 8 2 9 3 6
                             6 6 6 3 3 3 3 9 8 7 8 8 7 6 3 2 6 3 6 6 6
                             6 6 6 6 6 6 6 6 9 8 4 9 8 3 6 2 1 3 2 1 3
                             9 8 8 8 8 6 8 9 8 8 8 2 6 6 6 2 1 6 3 2 6
                             8 4 4 9 8 9 8 8 3 3 3 2 4 3 6 6 3 1 3 3 3
                             8 4 2 3 2 6 6 8 6 6 6 3 2 6 3 2 3 3 6 6 8 ]

orography::Array{Float64} = Float64[
 1904.667 1884.444 1759.778 1939.778 1622.889 1443.889 1253.222 1253.222 1253.222 1253.222 1253.222 1227.778 1227.778 1168.778 1133.111 1133.111 1134.111 1138.556 1101.778 1042.444 1042.444
 1681.333 1513.444 1390.556 1390.556 1397.333 1528.667 1253.222 1253.222 1253.222 1314.667 1321.444 1352.667 1288.667 1285.333 1219.778 1157.556 1183.889 1042.444 1042.444 1042.444 1042.444
 1136.222 1390.556 1390.556 1390.556 1506.778 1788.111 1787.556 1839.444 1545.222 1513.    1518.556 1495.333 1483.444 1347.333 1181.111 1042.444 1042.444 1042.444 1042.444 1042.444 1042.444
 1676.222 1834.667 1586.222 1703.556 1630.667 1520.222 1592.556 1615.444 1882.778 1569.778 1524.333 1501.667 1350.667 1263.778 1092.889 1042.444 1042.444 1042.444 1082.667 1179.111 1144.444
 1124.778 1136.667 1200.444 1318.667 1358.444 1282.222 1206.333 1289.333 1489.667 1505.    1424.333 1348.222 1098.    1093.778 1042.444 1042.444 1048.444 1109.111 1181.222 1124.778 1145.
 1062.556 1062.556 1062.556 1062.556 1100.778 1172.556 1234.667 1299.667 1395.222 1365.    1182.222 1118.556 1042.444 1042.444 1058.444 1218.222 1216.667 1239.111 1267.444 1229.778 1209.222
 1062.556 1062.556 1062.556 1062.556 1062.556 1062.556 1062.556 1044.444 1042.444 1042.444 1042.444 1042.444 1116.111 1272.111 1457.111 1550.556 1447.333 1515.778 1619.667 1579.333 1481.556
 1062.556 1062.556 1062.556 1062.556 1062.556 1097.556 1107.333 1062.    1042.444 1042.444 1069.778 1069.778 1407.444 1880.    1422.444 1229.778 1229.778 1229.778 1396.778 1557.444 1561.222
 1092.556 1062.556 1062.556 1119.778 1231.889 1389.111 1393.667 1336.222 1378.222 1322.889 1270.222 1371.667 1523.    1229.778 1229.778 1229.778 1229.778 1229.778 1229.778 1285.444 1352.444
 1240.222 1257.222 1177.778 1216.667 1266.222 1343.556 1416.778 1546.889 1487.778 1390.333 1516.333 1312.556 1229.778 1229.778 1229.778 1229.778 1236.889 1272.222 1254.889 1179.444 1179.444
 1468.444 1405.    1315.667 1311.    1289.    1475.222 1468.333 1403.111 1328.222 1377.778 1345.    1229.778 1229.778 1229.778 1507.889 1383.667 1346.333 1394.    1457.111 1418.    1372.667
 1463.111 1746.778 1639.    1489.222 1553.667 1383.556 1362.556 1324.667 1324.667 1302.556 1229.778 1283.333 1550.889 1317.444 1306.444 1353.444 1449.    1384.333 1333.111 1343.667 1257.778
 2261.    1783.333 2049.333 2030.778 1471.333 1365.    1334.444 1325.    1330.889 1340.111 1334.556 1751.    1428.222 1306.444 1306.444 1325.333 1403.444 1338.    1312.333 1278.    1188.667
 3443.778 3400.333 2908.889 2603.333 1877.667 1485.556 1453.778 1429.778 1402.222 1349.667 1371.556 1458.667 1306.444 1306.444 1452.333 1366.556 1360.667 1274.778 1192.667 1142.556 1136.556
 3801.222 3798.778 3533.778 3452.444 3256.667 1951.889 1698.889 1629.111 1578.444 1492.889 1366.222 1331.444 1306.444 1392.556 1459.556 1371.667 1356.    1299.889 1265.111 1156.667 1011.556
 3345.778 3621.111 3543.889 3110.222 3556.667 3064.444 2702.111 2379.    1571.333 1613.889 1639.222 1425.778 1586.444 1549.333 1604.333 1591.556 1596.    1548.222 1345.222 1195.222  996.556
 3267.556 3267.556 3267.556 2895.111 3001.778 2783.667 2424.444 2213.889 1775.222 1571.333 2040.    1647.444 1609.222 1761.333 1498.    1510.667 1464.    1425.111 1277.222 1132.778  977.222
 3267.556 3267.556 3340.556 2895.111 2910.111 2407.    1930.667 1792.111 1805.556 1785.333 1930.778 2099.444 1767.556 1686.    1490.556 1375.667 1440.333 1346.    1183.778 1219.111  977.222
 3328.222 3267.556 3360.889 3550.889 2839.444 2848.222 2040.444 2201.    2172.889 2012.889 1938.444 1930.556 2177.556 1614.444 1368.889 1265.111 1247.667 1474.    1077.    1245.444 1341.333
 3504.333 3616.889 3699.667 3814.444 3636.556 3313.556 2949.222 2311.556 2265.333 2010.111 2010.    1701.889 2072.667 1700.444 1354.444 1103.667 1104.778 1408.889 1133.889  783.111  690.889
 3940.444 3763.444 3799.556 3688.778 3651.111 3335.778 3159.667 2905.222 2779.222 2050.    1672.889 1522.444 1736.556 1653.333 1105.444 1322.889  997.889  755.111  588.889  588.889  588.889 ]

glacier_mask::Array{Int64} = Int64[ 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
                                    0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
                                    0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
                                    0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
                                    0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
                                    0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
                                    0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
                                    0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
                                    0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
                                    0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
                                    0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
                                    0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
                                    0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
                                    0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
                                    0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
                                    0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
                                    0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
                                    0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
                                    0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
                                    0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
                                    0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 ]

lsmask::Array{Int64} = Int64[ 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
                              1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
                              1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
                              1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
                              1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
                              1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
                              1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
                              1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
                              1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
                              1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
                              1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
                              1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
                              1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
                              1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
                              1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
                              1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
                              1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
                              1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
                              1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
                              1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
                              1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 ]

innerslope::Array{Float64} = Float64[
 0.003 0.002 0.002 0.003 0.002 0.002 0.002 0.001 0.001 0.002 0.007 0.008 0.01  0.004 0.013 0.009 0.013 0.011 0.013 0.008 0.003
 0.002 0.002 0.004 0.002 0.003 0.002 0.002 0.001 0.002 0.006 0.003 0.01  0.018 0.008 0.011 0.009 0.015 0.021 0.006 0.003 0.002
 0.004 0.004 0.003 0.002 0.002 0.002 0.002 0.004 0.008 0.005 0.005 0.007 0.009 0.01  0.009 0.01  0.011 0.01  0.003 0.002 0.
 0.004 0.003 0.003 0.003 0.003 0.004 0.002 0.002 0.006 0.007 0.009 0.01  0.006 0.013 0.009 0.008 0.005 0.004 0.002 0.    0.
 0.001 0.001 0.005 0.006 0.007 0.006 0.007 0.005 0.006 0.004 0.008 0.007 0.006 0.012 0.009 0.006 0.005 0.002 0.    0.    0.
 0.006 0.006 0.005 0.005 0.005 0.005 0.006 0.005 0.006 0.006 0.009 0.015 0.007 0.007 0.007 0.004 0.003 0.002 0.    0.    0.
 0.003 0.004 0.003 0.005 0.005 0.005 0.007 0.006 0.005 0.005 0.008 0.01  0.006 0.005 0.004 0.004 0.003 0.001 0.002 0.    0.
 0.003 0.003 0.006 0.007 0.008 0.008 0.006 0.008 0.008 0.007 0.008 0.007 0.004 0.003 0.002 0.002 0.001 0.    0.    0.    0.
 0.003 0.003 0.005 0.008 0.008 0.007 0.005 0.007 0.005 0.005 0.005 0.003 0.002 0.002 0.    0.    0.    0.    0.    0.    0.
 0.004 0.01  0.01  0.007 0.009 0.005 0.003 0.003 0.004 0.002 0.001 0.001 0.    0.    0.    0.    0.    0.    0.    0.    0.
 0.009 0.007 0.008 0.007 0.006 0.004 0.003 0.003 0.002 0.001 0.001 0.001 0.    0.    0.    0.    0.    0.    0.    0.    0.
 0.008 0.012 0.007 0.005 0.004 0.003 0.003 0.001 0.001 0.001 0.001 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
 0.012 0.014 0.012 0.012 0.003 0.003 0.002 0.001 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
 0.012 0.009 0.015 0.004 0.001 0.002 0.002 0.    0.    0.001 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
 0.012 0.013 0.005 0.002 0.001 0.    0.002 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
 0.006 0.003 0.002 0.001 0.001 0.001 0.002 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
 0.003 0.002 0.001 0.002 0.001 0.001 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
 0.001 0.002 0.002 0.001 0.001 0.001 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
 0.002 0.002 0.001 0.001 0.001 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
 0.002 0.001 0.001 0.001 0.001 0.    0.001 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.
 0.001 0.001 0.001 0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.    0.   ]

variance::Array{Float64} = Float64[
  36.79  29.31  32.25  49.67  50.12  52.2   35.03  15.36  11.51  36.09 148.91 148.13 168.28  76.89 132.42  89.15 100.65 111.83 142.2  123.38  34.81
  19.82  31.42  40.27  19.45  36.93  34.51  35.93  17.21  47.79 113.6   52.2  128.84 230.81 176.3  100.66 104.08 197.29 230.6   76.16  36.81  22.52
  71.24  88.    69.46  51.48  41.58  53.7   45.1   81.89 115.19 106.88  72.86  73.59 104.68 169.69 118.76  96.07 149.7  105.28  47.51  39.5    0.
  69.34  69.62  73.9   80.66  78.61  92.09  50.59  27.68  95.68  98.18 133.91 115.15  92.66 175.55 128.73  79.81  64.3   69.58  43.79   0.     0.
  16.27  22.22  98.    92.85 109.03 101.83  82.21  66.68  54.76  33.26 133.11 112.64 112.22 150.99 154.72  62.69  97.22  24.71   0.     0.     0.
 144.54  73.86  60.36  48.71  62.52  42.56  58.83  43.33  46.62  59.04  95.23 211.47 119.57  81.87 108.92  42.05  56.37  25.03   0.     0.     0.
  26.    34.41  30.07  53.76  56.95  49.43  86.32  65.38  74.04  63.39 126.73 150.44  68.61  75.52  51.48  56.76  46.36  17.94  17.8    0.     0.
  25.38  30.87  47.58  57.65  89.85  93.56 129.97 132.93 101.53 101.67  65.36  80.07  62.76  65.43  44.16  35.84  25.68   0.     0.     0.     0.
  27.79  43.6   57.7  102.35  78.39 103.7   59.77  89.89 100.85  47.85  85.59  45.13  25.99  16.92   0.     0.     0.     0.     0.     0.     0.
  58.98 119.68 118.92  66.32  68.48  62.58  45.43  32.56  49.67  37.9   20.3   21.21   0.     0.     0.     0.     0.     0.     0.     0.     0.
 129.66  75.43 135.83  83.39  97.98  57.47  36.76  41.59  50.21  15.33   8.03  13.47   0.     0.     0.     0.     0.     0.     0.     0.     0.
 140.72 233.61 103.2   67.05  45.69  37.09  57.03  16.53   9.41  12.31  10.59   0.     0.     0.     0.     0.     0.     0.     0.     0.     0.
 138.01 145.04 119.38 154.09  41.14  35.08  23.43   8.65   3.39   6.83   0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.
 154.02 162.89 160.69  75.59  20.55  21.3   17.38   0.     5.53   8.68   0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.
 122.4  185.27  77.1   18.6   15.92   6.18  14.07   0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.
  91.    40.88  29.64  18.26  17.72   8.53  13.18   0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.
  47.17  31.03  15.76  19.79  19.67   6.98   7.67   4.77   0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.
  22.96  21.47  24.41  16.91  21.85   6.17   5.39   5.29   0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.
  30.49  39.98  16.75  18.71   9.37   3.92   5.83   4.01   0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.
  30.62  17.03  13.95   7.48   7.76   4.76   6.46   0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.
  23.85  12.22   7.01   6.88   6.32   4.72   0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.  ]

expected_rdirs::Array{Int64} = Int64[ 6 3 2 2 8 6 6 6 6 6 6 6 6 6 9 6 9 9 9 9 8
                                      2 2 6 1 4 4 9 9 8 9 8 6 9 8 6 3 2 6 6 6 8
                                      4 4 4 8 8 7 3 9 7 4 9 9 8 3 3 6 6 6 8 8 8
                                      7 9 8 7 4 3 2 1 1 7 4 3 2 6 6 6 8 9 8 7 7
                                      3 3 2 1 1 6 1 4 4 3 2 3 3 3 9 8 7 7 7 6 6
                                      6 6 3 4 2 1 4 4 2 2 3 2 6 6 8 8 7 7 9 6 9
                                      9 9 6 6 2 3 2 3 3 2 6 6 9 8 7 8 8 2 9 9 9
                                      9 9 9 8 6 6 6 6 6 9 8 8 7 7 6 6 6 2 1 1 2
                                      9 9 8 4 7 7 2 1 4 6 9 4 7 6 6 8 8 6 3 3 2
                                      9 9 8 7 7 4 4 4 2 8 8 6 6 9 8 8 9 8 8 6 9
                                      8 6 8 7 7 4 3 2 6 6 6 9 8 8 9 8 9 7 2 3 2
                                      7 4 3 3 8 9 9 9 9 6 9 8 7 8 4 4 1 6 3 3 3
                                      8 7 4 6 6 6 9 8 4 4 9 4 9 8 7 7 3 3 3 2 3
                                      8 8 7 9 6 9 9 9 8 7 8 6 9 8 3 2 6 6 3 3 6
                                      2 7 3 9 9 8 7 9 9 6 6 9 8 7 6 6 6 8 8 6 9
                                      3 3 3 2 4 8 9 8 6 6 9 8 7 7 9 3 8 2 9 3 6
                                      6 6 6 3 3 3 3 9 8 7 8 8 7 6 3 2 6 3 6 6 6
                                      6 6 6 6 6 6 6 6 9 8 4 9 8 3 6 2 1 3 2 1 3
                                      9 8 8 8 8 6 8 9 8 8 8 2 6 6 6 2 1 6 3 2 6
                                      8 4 4 9 8 9 8 8 3 3 3 2 4 3 6 6 3 1 3 3 3
                                      8 4 2 3 2 6 6 8 6 6 6 3 2 6 3 2 3 3 6 6 8 ]

expected_flag::Array{Int64} = Int64[ 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
                                     1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
                                     1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
                                     1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
                                     1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
                                     1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
                                     1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
                                     1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
                                     1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
                                     1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
                                     1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
                                     1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
                                     1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
                                     1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
                                     1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
                                     1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
                                     1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
                                     1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
                                     1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
                                     1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
                                     1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 ]

expected_alf_k::Array{Float64} = Float64[
  18.331 19.928 20.507 17.508 16.727 16.809 17.683 18.168 18.815 18.51  19.062 19.454 20.252 22.615 33.762 24.095 26.343 18.847 21.769 20.268 20.237
  19.766 16.115 17.759 16.984 16.972 17.254 17.33  16.761 18.944 26.394 17.488 12.194 20.758 19.76  12.228 20.843 16.259 18.869 20.103 18.787 19.45
  17.44  17.329 18.554 16.548 17.76  18.279 17.646 16.514 17.621 19.311 19.311 20.64  20.64  19.665 21.022 20.944 19.884 19.819 19.318 20.653 27.527
  19.339 19.423 19.273 20.153 20.287 20.863 19.123 20.037 17.803 19.095 20.393 21.446 15.342 19.711 17.719 19.146 27.527 22.675 25.719 23.125 21.23
  20.586 20.785 19.685 20.987 21.151 21.367 20.554 20.126 19.345 20.184 19.7   24.315 22.63  21.538 20.93  21.606 26.648 21.151 24.191 24.277 19.551
  20.376 20.467 34.248 20.376 18.532 21.201 12.68  12.623 14.839 14.972 20.7   17.298 20.835 19.566 18.02  17.592 20.647 20.083 20.148 18.369 24.392
  20.073 25.515 27.8   20.537 27.527 34.343 27.527 31.75  34.343 27.527 20.537 20.537 19.723 20.657 19.349 14.927 25.415 20.813 20.655 17.847 19.43
  34.439 26.362 20.13  27.527 20.696 24.506 23.706 14.48  25.033 27.543 19.163 20.965 17.858 24.544 11.519 20.696 20.696 21.35  19.562 19.924 17.743
  19.57  21.877 25.438 23.709 19.994 18.583 19.028 21.438 22.527 19.571 18.73  21.133 22.17  19.115 18.979 22.07  22.527 22.732 22.689 21.698 24.398
  18.221 17.817 17.887 18.896 20.097 19.54  20.605 20.153 19.923 24.788 20.769 20.283 20.668 18.127 18.69  17.584 20.615 21.094 19.753 19.784 20.52
  17.386 16.703 17.294 18.588 18.481 20.139 21.44  19.775 20.189 21.298 20.712 17.484 20.98  18.769 18.676 17.842 20.031 21.485 19.804 20.572 21.123
  15.932 16.631 17.066 17.344 18.185 19.31  19.271 18.903 18.208 20.073 19.85  16.293 19.132 18.303 19.636 19.967 20.978 20.045 19.77  19.719 19.732
  17.212 16.205 16.771 17.13  17.18  17.542 17.99  18.346 18.789 21.126 18.465 17.892 19.069 18.869 18.888 20.527 21.492 19.047 18.889 18.832 19.057
  18.529 17.733 16.489 16.131 16.619 16.643 17.113 18.016 17.811 19.733 22.299 20.122 19.554 19.166 19.04  19.826 20.191 19.298 19.554 17.65  17.945
  18.63  17.625 17.167 16.373 17.621 17.344 17.141 16.645 16.072 18.184 19.847 17.851 18.351 17.998 18.567 18.674 18.456 21.566 17.954 18.61  17.567
  19.317 20.389 17.485 17.924 17.022 17.923 18.346 17.966 17.474 17.788 17.965 18.185 18.392 18.495 20.167 21.39  24.277 18.93  19.948 18.702 18.34
  17.303 17.575 17.669 16.869 17.345 18.95  18.499 17.7   18.096 20.    17.041 17.787 17.972 18.892 21.137 18.901 18.825 18.235 20.17  19.609 18.135
  17.161 17.604 16.85  18.288 17.826 17.126 17.916 16.411 22.503 25.239 19.702 22.021 18.63  18.557 21.998 16.664 20.988 19.834 22.36  20.503 18.844
  17.814 18.474 18.136 18.408 18.247 17.254 18.34  18.322 20.227 20.522 19.158 20.593 17.768 18.242 21.031 20.338 20.212 18.666 18.707 19.66  19.664
  17.688 17.63  19.907 19.177 17.843 18.468 18.767 18.25  19.653 17.65  17.896 17.975 17.665 17.095 17.359 18.639 18.196 20.498 20.838 19.133 17.767
  19.363 19.752 18.235 18.268 17.693 17.76  18.742 18.507 17.637 17.009 17.774 18.162 18.056 17.576 16.623 16.537 18.606 18.754 18.183 17.587 18.626 ]

expected_alf_n::Array{Float64} = Float64[
  1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111
  1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111
  1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111
  1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111
  1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111
  1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111
  1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111
  1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111
  1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111
  1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111
  1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111
  1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111
  1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111
  1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111
  1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111
  1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111
  1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111
  1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111
  1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111
  1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 1.111 ]

expected_arf_k::Array{Float64} = Float64[
  0.076 0.101 0.083 0.08  0.093 0.061 0.11  0.11  0.11  0.11  0.075 0.11  0.069 0.072 0.19  0.11  0.13  0.119 0.125 0.19  0.155
  0.08  0.093 0.111 0.19  0.086 0.064 0.19  0.19  0.155 0.125 0.098 0.069 0.117 0.093 0.069 0.117 0.091 0.111 0.111 0.111 0.155
  0.112 0.06  0.112 0.155 0.094 0.104 0.113 0.1   0.107 0.112 0.113 0.111 0.089 0.109 0.115 0.112 0.112 0.112 0.155 0.155 0.155
  0.101 0.103 0.089 0.107 0.113 0.107 0.083 0.104 0.1   0.138 0.113 0.104 0.086 0.063 0.072 0.113 0.155 0.192 0.104 0.116 0.119
  0.126 0.124 0.092 0.109 0.108 0.069 0.134 0.069 0.063 0.107 0.087 0.107 0.127 0.133 0.192 0.155 0.159 0.125 0.116 0.114 0.067
  0.115 0.115 0.193 0.115 0.104 0.119 0.071 0.071 0.083 0.084 0.116 0.097 0.115 0.115 0.114 0.09  0.114 0.113 0.116 0.08  0.114
  0.193 0.193 0.116 0.116 0.155 0.193 0.155 0.179 0.193 0.155 0.116 0.116 0.125 0.087 0.105 0.084 0.087 0.085 0.105 0.106 0.108
  0.194 0.194 0.194 0.155 0.116 0.116 0.075 0.081 0.116 0.194 0.108 0.108 0.106 0.099 0.065 0.116 0.116 0.155 0.115 0.108 0.088
  0.137 0.194 0.155 0.074 0.115 0.108 0.155 0.194 0.076 0.074 0.113 0.07  0.104 0.117 0.117 0.155 0.155 0.117 0.13  0.121 0.09
  0.115 0.114 0.093 0.117 0.117 0.072 0.073 0.069 0.09  0.099 0.087 0.072 0.118 0.195 0.155 0.155 0.159 0.103 0.109 0.118 0.195
  0.087 0.072 0.092 0.119 0.126 0.067 0.118 0.097 0.119 0.079 0.07  0.195 0.155 0.155 0.11  0.091 0.126 0.117 0.093 0.117 0.093
  0.134 0.064 0.196 0.146 0.086 0.196 0.196 0.196 0.196 0.074 0.196 0.101 0.109 0.096 0.12  0.077 0.12  0.076 0.13  0.117 0.119
  0.077 0.109 0.065 0.061 0.072 0.081 0.155 0.168 0.096 0.091 0.131 0.062 0.122 0.155 0.196 0.145 0.12  0.118 0.117 0.092 0.118
  0.074 0.072 0.097 0.097 0.063 0.118 0.12  0.123 0.098 0.146 0.105 0.07  0.197 0.155 0.126 0.155 0.074 0.074 0.137 0.12  0.073
  0.081 0.109 0.107 0.094 0.093 0.081 0.115 0.114 0.114 0.071 0.081 0.142 0.155 0.126 0.074 0.088 0.077 0.109 0.098 0.07  0.197
  0.127 0.109 0.103 0.088 0.063 0.074 0.098 0.077 0.123 0.123 0.111 0.095 0.113 0.114 0.114 0.121 0.087 0.093 0.116 0.115 0.087
  0.124 0.124 0.065 0.198 0.104 0.1   0.103 0.103 0.088 0.198 0.082 0.087 0.117 0.067 0.122 0.092 0.082 0.114 0.072 0.071 0.124
  0.125 0.125 0.064 0.125 0.064 0.064 0.072 0.125 0.115 0.088 0.072 0.106 0.09  0.111 0.074 0.094 0.118 0.113 0.094 0.12  0.116
  0.131 0.155 0.111 0.078 0.155 0.061 0.094 0.109 0.083 0.087 0.122 0.087 0.063 0.069 0.075 0.09  0.121 0.066 0.112 0.081 0.063
  0.089 0.075 0.077 0.1   0.077 0.097 0.076 0.094 0.116 0.111 0.107 0.089 0.066 0.105 0.069 0.126 0.111 0.109 0.106 0.117 0.125
  0.082 0.127 0.155 0.2   0.155 0.072 0.069 0.079 0.063 0.067 0.073 0.132 0.086 0.064 0.124 0.084 0.109 0.12  0.127 0.127 0.155 ]

expected_arf_n::Array{Float64} = Float64[
  5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479
  5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479
  5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479
  5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479
  5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479
  5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479
  5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479
  5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479
  5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479
  5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479
  5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479
  5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479
  5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479
  5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479
  5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479
  5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479
  5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479
  5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479
  5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479
  5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479
  5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 5.479 ]

expected_agf_k::Array{Float64} = Float64[
 313.753 465.132 393.736 375.614 341.007 272.572 236.909 236.909 236.909 236.909 236.909 236.909 236.909 236.909 409.153 236.909 409.153 409.153 409.153 409.153 333.587
 336.547 333.587 238.949 429.727 267.603 264.042 426.089 410.337 333.587 410.337 333.587 238.949 410.337 333.587 238.949 410.337 333.587 242.555 238.949 238.949 333.587
 240.971 288.859 254.308 361.309 351.262 423.823 425.926 463.693 411.518 240.971 411.518 411.518 333.587 411.518 411.518 240.971 240.971 245.722 333.587 333.587 333.587
 431.134 419.768 333.587 468.69  248.223 420.169 333.587 486.793 423.381 412.695 242.975 412.695 333.587 242.975 242.975 242.975 333.587 412.695 333.587 412.695 412.695
 413.867 413.867 333.587 413.867 413.867 244.96  413.867 244.96  257.536 413.867 333.587 413.867 413.867 413.867 417.063 333.587 413.867 413.867 413.867 244.96  244.96
 246.927 246.927 415.034 246.927 333.587 415.034 246.927 246.927 333.587 333.587 415.034 333.587 246.927 246.927 333.587 333.587 415.034 415.034 415.034 246.927 415.034
 416.196 416.196 248.875 248.875 333.587 416.196 333.587 416.196 416.196 333.587 248.875 248.875 416.196 333.587 424.234 336.267 333.587 333.587 416.196 416.196 416.196
 417.352 417.352 417.352 333.587 250.804 250.804 250.804 250.804 250.804 417.352 333.587 333.587 417.352 417.352 250.804 250.804 250.804 333.587 417.352 424.698 333.587
 418.503 418.503 333.587 252.714 418.503 418.503 333.587 418.503 252.714 252.714 418.503 252.714 426.406 252.714 252.714 333.587 333.587 252.714 418.503 418.503 362.532
 419.647 419.647 333.587 419.647 419.647 254.605 254.605 254.605 333.587 333.587 333.587 254.605 254.605 425.408 340.243 333.587 419.647 333.587 333.587 254.605 419.647
 337.917 283.104 363.098 424.454 420.785 256.475 420.785 333.587 256.475 256.475 256.475 420.785 333.587 351.939 420.785 358.063 420.785 420.785 333.587 420.785 333.587
 457.118 297.68  477.381 445.454 347.687 421.916 421.916 421.916 421.916 258.327 421.916 347.55  421.916 334.957 258.327 258.327 421.916 258.327 421.916 421.916 421.916
 468.986 476.213 293.452 290.6   264.139 264.104 423.04  335.94  274.148 260.159 423.04  327.696 423.04  350.736 423.04  423.04  423.04  423.04  423.04  333.587 423.04
 354.124 436.125 526.321 471.702 288.765 468.998 432.666 424.157 333.587 424.157 333.587 287.636 427.611 333.83  424.157 333.587 261.971 262.254 424.157 424.157 261.971
 333.587 444.975 492.283 550.588 535.924 416.601 493.658 439.247 483.987 265.039 263.764 425.266 333.587 425.266 263.764 263.764 263.764 333.587 333.587 303.327 441.261
 455.254 487.302 470.878 418.212 281.936 358.196 485.593 392.22  346.508 268.665 426.368 348.851 446.025 437.48  439.77  438.091 335.393 333.587 446.306 442.222 277.563
 270.417 267.288 304.193 458.034 495.777 468.125 437.578 471.85  370.802 486.747 351.407 344.53  432.152 279.    427.461 333.587 267.288 427.461 267.288 267.288 268.205
 279.591 308.073 311.488 306.971 295.424 269.02  269.02  293.568 455.589 333.587 296.898 446.923 357.941 437.662 269.02  334.594 431.573 442.974 333.587 428.546 433.635
 459.856 370.41  420.255 350.517 381.065 338.032 354.715 511.992 333.587 333.587 338.612 333.587 273.12  278.382 270.73  333.587 429.622 270.73  429.622 333.587 279.777
 347.458 288.635 282.75  451.6   358.446 512.389 359.342 343.16  430.689 430.689 438.988 333.587 290.174 462.723 272.421 272.421 430.689 432.911 444.342 430.689 430.689
 365.223 288.748 333.587 431.748 354.59  287.569 278.661 347.096 274.091 310.695 290.765 447.909 353.37  324.603 504.747 349.374 440.758 431.748 274.091 276.083 352.292]


cell_areas::Array{Float64} = Float64[ 2.195e+09
                                      2.214e+09
                                      2.233e+09
                                      2.251e+09
                                      2.270e+09
                                      2.288e+09
                                      2.306e+09
                                      2.324e+09
                                      2.342e+09
                                      2.359e+09
                                      2.377e+09
                                      2.394e+09
                                      2.411e+09
                                      2.427e+09
                                      2.444e+09
                                      2.461e+09
                                      2.477e+09
                                      2.493e+09
                                      2.509e+09
                                      2.524e+09
                                      2.540e+09 ]
cell_areas_expanded = repeat(cell_areas,1,21)
riverflow_formula::RiverFlowFormula = RiverFlowSausen()
overlandflow_formula::OverlandFlowFormula = OverlandFlowSausen()
baseflow_formula::BaseFlowFormula = BaseFlowDistanceAndOrography()
configuration::Configuration = Configuration(riverflow_formula,
                                             overlandflow_formula,
                                             baseflow_formula)
lats = Float64[ 44.75 44.25 43.75 43.25 42.75 42.25 41.75 41.25 40.75 40.25 39.75 39.25 38.75 38.25 37.75 37.25 36.75 36.25 35.75 35.25 34.75 ]
lons = Float64[ -79.75 -79.25 -78.75 -78.25 -77.75 -77.25 -76.75 -76.25 -75.75 -75.25 -74.75 -74.25 -73.75 -73.25 -72.75 -72.25 -71.75 -71.25 -70.75 -70.25 -69.75 ]
dlon = Float64[ 39484.8 39824.8 40161.9 40495.8 40826.7 41154.5 41479.2 41800.6 41154.5 41479.2 41800.6 42119.0 42434.1 42745.9 43054.5 43359.9 43359.9 43960.6 44256.0 44548.0 44836.6 44836.6 44836.6 45681.8 ]
grid::Grid =  LatLonGrid(21,21,vec(lats),vec(lons),55597.8008,vec(dlon))
input_data::InputData = InputData(collect(isone.(lsmask)),
                                  collect(isone.(glacier_mask)),
                                  orography,
                                  innerslope,
                                  variance,
                                  rdirs,
                                  cell_areas_expanded,
                                  grid)
results = generate_parameters(configuration,
                              input_data,
                              grid)
display(round.(results[1];digits=2))
println()
display(round.(results[2];digits=2))
end
end
